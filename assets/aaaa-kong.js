function(V,m){var Na=Modernizr.prefixed("transform"),Oa=Modernizr.prefixed("transition"),t=t||{};t.register=t.register||{};t.namespace=t.namespace||{};t.namespace.__namespace__=[];t.args=t.args||[];t.utils=function(){var a=this,c=function(){};c.prototype={slice:function(a,d){return d&&Array.prototype.slice.call(a,d)[0]||Array.prototype.slice.call(a)},objToString:function(a){return Object.prototype.toString.call(a)},hasClassName:function(a,d){return(new RegExp("(?:^|\\s+)"+d+"(?:\\s+|$)")).test(a.className)},
delayFire:function(){var a=setTimeout(function(){});return function(b,c){clearTimeout(a);a=setTimeout(b,c)}}(),delay:function(){var a=t.args,d,c,f,g;return function(){d=arguments;g=function(){for(var a in d)this[a]=d[a];this.populate()};c=Object.create(g.prototype={populate:function(){f=Object.create(this);if(0<a.length)for(var b=0,d=0;b<a.length;b++){if(a[b]["0"]===this["0"]&&d++,!d&&b===a.length-1){a.push(f);break}}else a.push(f)},fire:function(){if(0<a.length){for(var b in a)setTimeout(function(a,
b){a.call(null)}.bind(this,a[b]["0"]),a[b]["1"]);a.length=0}}});(new g,this.delayFire)&&this.delayFire(function(){c.fire()},100)}}(),attachListener:function(a,d,c){function b(a,b,d){function g(a,b){a!==window?a.addEventListener(b,d,!1):a.attachEvent&&a.attachEvent("on"+b,d)||a.addEventListener(b,d,!1);"mousedown"===b?a.addEventListener("touchstart",d,!1):"mousemove"===b?a.addEventListener("touchmove",d,!1):"mouseup"===b?a.addEventListener("touchend",d,!1):"mouseout"===b&&a.addEventListener("touchleave",
d,!1)}b=-1===b.indexOf(" ")?b:b.split(" ");b=1>=b.length?b.join(""):b;if(b instanceof Array)for(;b.length;)g(a,b.pop());else g(a,b)}if(this.objToString&&"[object Array]"===this.objToString(a))for(;a.length;)b(a.pop(),d,c);else b(a,d,c)},inArray:function(a,d){for(;d.length;)if(d.pop()===a)return!0;return!1},removeClassFn:function(a,d){if(-1!==d.indexOf(" ")&&1<d.split(" ").length){for(var b=a.className.toLowerCase().split(" "),c=b.length-1;0<=c;c--)this.inArray(b[c],d.split(" "))&&delete b[c];a.className=
b.join(" ")}else this.hasClassName(a,d)&&(a.className=a.className.replace(new RegExp("(?:^|\\s+)"+d+"(?:\\s+|$)","g")," "))},addClassFn:function(a,d){this.hasClassName(a,d)||(a.className=[a.className,d].join(" "))},isTwoDimensional:function(a){return/([object Array])/i.test(this.objToString(a))&&this.slice(a,0).length?!0:!1}};for(var f in new c)this[f]=(new c)[f];this.isMobile=function(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)};this.encodeStr=
function(a){return encodedStr=a.replace(/[\u00A0-\u9999<>&]/gim,function(a){return"&#"+a.charCodeAt(0)+";"})};this.normalizingMousewheel=function(a){a||(a=event);var b=a.wheelDelta;return(a=a.detail)?b?0<b/a/40*a?1:-1:-a/3:b/120};this.random=function(a,d){return Math.floor(Math.random()*(a-d+1)+d)};this.randomFloat=function(a,d){return Math.random()*(a-d)+d};this.randomArray=function(a){for(var b=a.length-1;0<b;b--){var c=Math.floor(Math.random()*(b+1)),f=a[b];a[b]=a[c];a[c]=f}return a};this.uniqueString=
function(){return Math.random().toString(36).slice(-8)};this.uniqueId=function(){return this.random(999,100)+"-"+Math.random().toString(36).slice(-8)};this.uniqueArray=function(a){a.slice().sort(function(a,b){return a>b}).reduce(function(a,b){a.slice(-1)[0]!==b&&a.push(b);return a},[]);return a};this.detectLeftButton=function(a){return"buttons"in a?1===a.buttons:"which"in a?1===a.which:1===a.button};this.detectRightButton=function(a){a=a||window.event;if("which"in a)return 3==a.which;if("button"in
e)return 2==a.button};this.cancelBubble=function(a){a=this?a:window.event;a.stopPropagation&&a.stopPropagation();null!=a.cancelBubble&&(a.cancelBubble=!0);a.preventDefault()};this.nthParent=function(a,d){for(;d--&&a;)a=a.parentNode;return a};this.runFirst=function(){var a=!0;return function(b,c){this.delay(function(){a=!0},100);a&&(setTimeout(b.bind(this),c),a=!1)}}();this.parentLastchild=function(a){var b=[];do a=a.nextSibling,1==a.nodeType&&b.push(a);while(a.nextSibling);return b[b.length-1]};this.parentFirstchild=
function(a){var b=[];do a=a.previousSibling,1==a.nodeType&&b.push(a);while(a.previousSibling);return b[b.length-1]};this.getLastChild=function(b){var d=[];b=a.getFirstChild(b);do b=b.nextSibling,1==b.nodeType&&d.push(b);while(b.nextSibling);return d[d.length-1]};this.getFirstChild=function(a){for(a=a.firstChild;a&&3==a.nodeType;)a=a.nextSibling;return null===a?!1:a};this.sibling=function(a,d){do a="previous"==d?a.previousSibling:a.nextSibling;while(a&&1!=a.nodeType);return null===a?!1:a};this.qsAll=
function(a,d){a=-1===a.indexOf(".")?"."+a:a;return!!d&&d.querySelectorAll(a)||document.querySelectorAll(a)};this.qs=function(a,d){a=-1===a.indexOf(".")?"."+a:a;return!!d&&d.querySelector(a)||document.querySelector(a)};this.id=function(a){return document.getElementById(a)};this.addClass=function(a,d){if(this.isTwoDimensional(a))for(var b=a.length-1;0<=b;b--)this.addClassFn(a[b][0],a[b][1]);else this.addClassFn(a,d)};this.removeClass=function(a,d){if(this.isTwoDimensional(a))for(var b=a.length-1;0<=
b;b--)this.removeClassFn(a[b][0],a[b][1]);else this.removeClassFn(a,d)};this.css=function(a,d,c){function b(a){for(var b in d)if(b in d)switch(g=d[b],b){case "transform":g=d[b].split(",");x=g[0];y=g[1];z=g[2];f="translate3d("+x+","+y+","+z+")";a.style[Na]=f;break;case "transition":f=g=d[b];a.style[Oa]=f;break;default:a.style[b]=g}}var g,f;if(a.nodeName)b(a);else for(c=a.length;0<c;c--)b(a[c-1])};this.text=function(a,d){a.innerText=d};this.ucFirst=function(a){return a.charAt(0).toUpperCase()+a.slice(1)};
this.intersectsCircle=function(a,d,c,f,g){a-=c;d-=f;return a*a+d*d<=g*g};this.extend=function(a,d,c){if(!0===c)for(var b in d)b in d&&(a[b]=d[b]);else a:for(b in d)if(b in d){for(var g in a)if(g in a&&b.toLowerCase()===g.toLowerCase()&&-1!==b.toLowerCase().indexOf("strict"))continue a;"function"===typeof d[b]?(a[b]=d[b],a[b]()):a[b]=d[b]}return a};this.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||
window.msRequestAnimationFrame||function(a){window.setTimeout(a,1E3/60)}}();this.objCount=function(a){var d=0,b;for(b in a)d++;return d};this.CursorStartEvent=(c=!!("createTouch"in document))?"touchstart":"mousedown";this.CursorMoveEvent=c?"touchmove":"mousemove";this.CursorEndEvent=c?"touchend":"mouseup";this.CursorLeaveEvent=c?"touchleave":"mouseout";this.accessor=function(b){var d=b.namespace,c=d.__namespace__,f=b.global,g=b.accessorName;O=Object.create(new function(){return Object.defineProperty(b,
g,{set:function(){a.slice(arguments).forEach(function(a){d["_initialize"+g]?d["_initialize"+g].push(a):d["_initialize"+g]=[a];for(var b=0;b<c.length;b++)for(var h in f)h in f&&(c[b][h]=Object.defineProperty({invoke:h},"value",{get:function(){return f[this.invoke]},set:function(d){for(var b in this)if(b in this&&"value"!==b){f[this[b]]=d;for(var g=c,h=g.length;h--;)g[h]!==a&&this[b]in g[h]&&(g[h][this[b]]=this)}},enumerable:!0}))})}})});O[g]=this;d["_revoke"+g]=O};this.cloneImg=function(a){var d=document.createElement("img");
d.src=a;return d.cloneNode(!0)};this.createTexture=function(b){var d=a.context,c=d.createTexture();d.bindTexture(d.TEXTURE_2D,c);d.texImage2D(d.TEXTURE_2D,0,d.RGBA,1,1,0,d.RGBA,d.UNSIGNED_BYTE,new Uint8Array([0,0,255,255]));d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,d.CLAMP_TO_EDGE);d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,d.CLAMP_TO_EDGE);d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,d.LINEAR);urlFilter=b.split("//").join("/");var f={width:1,height:1,texture:c,complete:!1,url:urlFilter},
g=a.globalImage.get(urlFilter);g?g.complete&&(f.width=g.width,f.height=g.height,d.bindTexture(d.TEXTURE_2D,f.texture),d.texImage2D(d.TEXTURE_2D,0,d.RGBA,d.RGBA,d.UNSIGNED_BYTE,g)):urlFilter&&!/undefined/i.test(urlFilter)&&(g=new Image,g.src=urlFilter,a.globalImage.set(urlFilter,g),g.addEventListener("load",function(){f.width=g.width;f.height=g.height;d.bindTexture(d.TEXTURE_2D,f.texture);d.texImage2D(d.TEXTURE_2D,0,d.RGBA,d.RGBA,d.UNSIGNED_BYTE,g);f.complete=!0}));return f};this.setTextureNpc=function(b,
d){a.globalImagePair.set(b,d);return d};this.removeTextureNpc=function(b,d){var c=a.monsterControl,f=a.globalImagePair.storage,g=d.initialName.toLowerCase(),l=function(a){for(var d in a)for(var g in a[d]){var c=a[d][g],f;for(f in c)b.deleteTexture(c[f].texture)}},p=!0,n=0;for(c=c.objSpawnMonster;n<c.length;n++)c[n].forEach(function(a){a.monsters.forEach(function(a){a.object.initialName.toLowerCase()!==g||a.object.rigBody.remove||(p=!1)})});p&&(f.forEach(function(a){g.toLowerCase()===a.name&&(l(a.status),
l(d.render.textures))}),a.globalImagePair.remove(g))};this.setTextureNonNpc=function(b,d,c){var f=a.glTest[d.uniqueString];if(!f||f.deleted){var g=a.glTest,k=!0,p;for(p in g){var n=g[p];if(n.initialName===b){n.deleted&&(n.texture=this.createTexture(c),n.deleted=!1);d.uniqueString=g[p].uniqueString;f=g[p];k=!1;break}}k&&(g=a.uniqueString(),f={deleted:!1,initialName:b,uniqueString:g,texture:this.createTexture(c)},d.uniqueString=g,a.glTest[g]=f)}return f.texture};this.registerTextureNonNpc=function(b,
d,c){var f=a.intervalList[c.uniqueString];f?f.tick=10:a.intervalList[c.uniqueString]={tick:10,always:!0,alreadyExecuted:!1,fn:function(){this.alreadyExecuted||(b.deleteTexture(d.texture),b.deleteTexture(c.textures.texture),this.alreadyExecuted=a.glTest[c.uniqueString].deleted=!0,this.always=!1)}}};this.getTexture=function(b,d,c,f){var g=b.textures,h;if(!g&&(-1!==d.indexOf("left")||-1!==d.indexOf("right"))){if(h=a.globalImagePair.get(f))b.textures=h;else{c=d.split(f)[0].split("//").join("/");g={};
h={};for(var k=0,n=b.behave;k<n.length;k++)g[n[k]]=this.createTexture(c+f+"-"+n[k]+"-right.png"),h[n[k]]=this.createTexture(c+f+"-"+n[k]+"-left.png");b.textures=this.setTextureNpc(f,{pairTextures:{left:h,right:g}})}b.latest=/left/i.test(d)?"left":"right";b.initialName=f;return/left/i.test(d)?b.textures.pairTextures.left:b.textures.pairTextures.right}if(c&&/textureNeedChange/i.test(c))return f=c.split("|")[1],b.latest=/left/i.test(f)?"left":"right",/left/i.test(f)?g.pairTextures.left:g.pairTextures.right;
if(g){if(g.pairTextures)return b=-1!==b.latest.indexOf("left")?g.pairTextures.left:g.pairTextures.right,a.globalImagePair.get(f),b;-1!==d.indexOf("ornaments")&&(h=a.setTextureNonNpc(d,b,d),a.registerTextureNonNpc(a.context,h,b),g=b.textures=h);return g}c=d;h=a.setTextureNonNpc(c,b,c);g=b.textures=h;b.initialName=c;-1!==d.indexOf("ornaments")&&a.registerTextureNonNpc(a.context,h,b);return g};this.drawPropByVer=function(b){return{glProp:"v3"===b.ver?a.glDrawV3.value:a.glDrawV1nV2.value,drawProp:function(d){return/v1/i.test(d.ver)?
{update:function(a){return{ver:a.ver,tex:a.img.texture,texWidth:a.img.width,texHeight:a.img.height,dstX:a.posX,dstY:a.posY}}}:/v2/i.test(d.ver)?{update:function(a){return{ver:a.ver,tex:a.img.texture,texWidth:a.img.width,texHeight:a.img.height,dstX:a.posX,dstY:a.posY,scaleX:a.scaleX,scaleY:a.scaleY}}}:{update:function(d){return{ver:d.ver,tex:d.img.texture,texWidth:d.img.width,texHeight:d.img.height,srcX:d.posX,srcY:d.posY,srcWidth:d.srcWidth,srcHeight:d.srcHeight,dstX:d.dstX,dstY:d.dstY,dstWidth:d.dstWidth,
dstHeight:d.dstHeight,angleInRadians:d.angleInRadians,zRotate:function(d,b){var g=a.webglM4;var c=g.scaling(1/b.texWidth,1/b.texHeight,1);c=g.translate(c,.5*b.texWidth,.5*b.texHeight,0);c=g.zRotate(c,b.angleInRadians);c=g.translate(c,-.5*b.texWidth,-.5*b.texHeight,0);c=g.translate(c,b.srcX,b.srcY,0);return c=g.scale(c,b.srcWidth,b.srcHeight,1)}}}}}(b)}};this.drawImage=function(b,d,c){var f=a.webglM4,g=a.orthographic;b.bindTexture(b.TEXTURE_2D,c.tex);b.useProgram(d.program);b.bindBuffer(b.ARRAY_BUFFER,
d.positionBuffer);"v3"===c.ver&&(g=f.translate(g,c.dstX,c.dstY,0),g=f.scale(g,c.dstWidth,c.dstHeight,1));b.enableVertexAttribArray(d.positionLocation);b.vertexAttribPointer(d.positionLocation,2,b.FLOAT,!1,0,0);b.bindBuffer(b.ARRAY_BUFFER,d.texcoordBuffer);b.enableVertexAttribArray(d.texcoordLocation);b.vertexAttribPointer(d.texcoordLocation,2,b.FLOAT,!1,0,0);b.uniformMatrix4fv(d.matrixLocation,!1,g);"v1"===c.ver?(g=f.translate(g,c.dstX,c.dstY,0),g=f.scale(g,c.texWidth,c.texHeight,1),b.uniformMatrix4fv(d.matrixLocation,
!1,g)):"v2"===c.ver?(g=f.translate(g,c.dstX,c.dstY,0),g=f.scale(g,c.scaleX,c.scaleY,1),b.uniformMatrix4fv(d.matrixLocation,!1,g)):"v3"===c.ver&&(0<c.angleInRadians?g=c.zRotate(g,c):(g=f.translation(c.srcX/c.texWidth,c.srcY/c.texHeight,0),g=f.scale(g,c.srcWidth/c.texWidth,c.srcHeight/c.texHeight,1)),b.uniformMatrix4fv(d.textureMatrixLocation,!1,g));b.uniform1i(d.textureLocation,0);b.drawArrays(b.TRIANGLES,0,6)};this.distanceAndAngleBetweenTwoPoints=function(a,d,c,f){a=c-a;d=f-d;return{distance:Math.sqrt(a*
a+d*d),angle:180*Math.atan2(d,a)/Math.PI}};this.angleToRadian=function(a){return a*Math.PI/180};this.vector=function(a,d){var b=d*Math.PI/180;this.x=a*Math.cos(b);this.y=a*Math.sin(b)};this.getRelativeMousePosition=function(a,d,c){d=d.getBoundingClientRect();var b=document.documentElement||document.body.parentNode||document.body;c=void 0!==window.pageXOffset?window.pageXOffset:b.scrollLeft;b=void 0!==window.pageYOffset?window.pageYOffset:b.scrollTop;var g=a.changedTouches;g?(c=g[0].pageX-d.left-c,
a=g[0].pageY-d.top-b):(c=a.pageX-d.left-c,a=a.pageY-d.top-b);return{x:c,y:a}};this.showImageHHandWW=function(a,d){a.name=d;a.onload=function(){return!0};a.src=d;return a};this.rgbRandom=function(a){this.r=255;this.g=Math.round(255*Math.random());this.b=Math.round(255*Math.random());return"rgba( "+this.r+","+this.g+","+this.b+","+a+")"};this.JSONstringfy=function(a){var d=[];return JSON.stringify(a,function(a,b){if("object"===typeof b&&null!==b){if(-1!==d.indexOf(b))return;d.push(b)}return b})};this.playAudio=
function(b){if(a.objTranslate.value.volume){var d={createAudio:function(){return new Audio},audioSrc:function(d,b){src=a.path+"audio/"+b;d.src=Modernizr.audio.ogg?src+".ogg":Modernizr.audio.mp3?src+".mp3":src+".wav";return b},audioEndEvent:function(a){},previousAudio:""};b=b instanceof Array?b[a.random(b.length,1)-1]:b;audio=d.createAudio();d.audioSrc(audio,b);d.audioEndEvent(audio);audio.play()}};this.fullscreenToogle=function(a){if(/off/i.test(a.className)){a.className="fullscreen-on";var d=document,
b=d.exitFullScreen||d.mozCancelFullScreen||d.webkitExitFullScreen||d.mozExitFullScreen||d.msExitFullScreen||d.webkitCancelFullScreen;"undefined"!=typeof b&&b?b.call(d):"undefined"!==typeof window.ActiveXObject&&(d=new ActiveXObject("WScript.Shell"),null!==d&&d.SendKeys("{F11}"))}else d=document.documentElement,b=d.requestFullScreen||d.webkitRequestFullScreen||d.mozRequestFullScreen||d.msRequestFullscreen,"undefined"!=typeof b&&b?b.call(d):"undefined"!=typeof window.ActiveXObject&&(d=new ActiveXObject("WScript.Shell"),
null!=d&&d.SendKeys("{F11}")),a.className="fullscreen-off"};this.objGlobalTranslate=function(){this.translate=a.objTranslate.value;this.reverse=function(a){var d=this.translate;"left"===d.staticObjStateX?a.x-=d.staticObjMoveX:"right"===d.staticObjStateX&&(a.x+=d.staticObjMoveX);var b=d.staticObjStateY;a.y+="up"===b?-d.staticObjMoveY:"down"===b?d.staticObjMoveY:0};this.update=function(a){var d=this.translate;"left"===d.staticObjStateX?a.x+=d.staticObjMoveX:"right"===d.staticObjStateX&&(a.x-=d.staticObjMoveX);
var b=d.staticObjStateY;a.y+="up"===b?d.staticObjMoveY:"down"===b?-d.staticObjMoveY:0}}};t.bridge=function(){t.namespace.__namespace__.push(this);var a=this,c=t.namespace,f=t.register,b=new a.utils;var d=function(d,b){return self={windowResize:function(a){for(var d in f)if(f[d].register===a){f[d].fn();break}},globalOwlBirdrProperty:function(g){for(var c in f)if(f[c].register===g){a.extend(self,f[c].obj);break}d.accessor.call(this,{global:self,accessorName:g,namespace:b})}}}(b,c);this.that=function(c){var h=
{};return{callback:function(a){return function(d){d(a)}}(h||{}),invokeWith:function(a){for(var b in f)if(f[b].register===a){d[b].apply(c,arguments);break}return this},use:function(a,d){var g,f;for(f in b)f in b&&"function"===typeof b[f]&&f.toLowerCase()===a.toLowerCase()&&(/(attachlistener|addclass|removeclass|css)/i.test(f.toLowerCase())&&d.unshift(c),(g=b[f].apply(b,d))&&(h[a]=g));return this},findTarget:function(d){if(/([object NodeList]|[object Array])/i.test(a.objToString(c))){for(var b=c.length-
1;0<=b;b--)c[b].contains(d.target||d.srcElement)?(this.target=c[b],h.self=this):h.self&&delete h.self;return this}},fireTarget:function(a,d){this.findTarget(a).callback(function(a){"self"in a&&a.self.use("delay",[function(){d.call(null,a.self.target)},100])})}}}};t.deligate=function(a,c,f){var b=this;b.extend(t.register,{windowResize:{register:"_windowResize",fn:function(){var a=b.qs("screen").getElementsByTagName("canvas")[0];b.browserWidthUpdate=b.browserWidth();b.browserHeightUpdate=b.browserHeight();
b.controlGUICheck&&b.controlGUICheck.value();a.width=b.browserWidthUpdate;a.height=b.browserHeightUpdate+1;b.css(a,{width:b.browserWidthUpdate+"px",height:b.browserHeightUpdate+1+"px"})}},globalOwlBirdrProperty:{register:"_globalOwlBirdrProperty",obj:{glDrawTest:"",glDrawV1nV2:"",glDrawV3:"",glLine:"",intervalListGlobal:"",activeMap:"mapA",staticWorld:"",isScroll:!0,mousePosition:{pos:""},objTranslate:{staticObjMoveX:"",staticObjMoveY:5,staticObjStateX:"",staticObjStateY:"",staticObjAllX:!0,staticObjAllY:!0,
moveLeft:!1,moveRight:!1,moveUp:!1,moveDown:!1,firstLoadLeft:!0,firstLoadRight:!0,staticsWallOuterIsStopX:!0,charaIsCentered:!1,charaTranslate:!0,staticsWallOuterIsStopY:!0,objPhysCollide:!1,isCenter:{init:!1,state:!0},objectMarker:{state:"",monster:"",registerMonster:[]},isShake:{shakeCnt:[],createShake:function(a){for(;a--;)this.shakeCnt.push(new this.constructor)},constructor:function(){this.state=!1;this.strength=3;this.tick=0;this.install=!1;this.initShake=0;this.stateShake=!0;this.posY=this.posX=
this.pairShake=0;this.inOrDec=!0;this.translate=b.objTranslate.value;this.amplitude={up:0,center:2,down:0,strength:1};this.randomnessFn=function(a){if(1===this.stateShake||3===this.stateShake)switch(a){case 1:this.posX=this.initShake;break;case 2:this.posX=this.initShake;this.posY=-this.initShake;break;case 3:this.posY=this.initShake;break;case 4:this.posY=this.posX=this.initShake}else if(2===this.stateShake)switch(a){case 1:this.posX=2*-this.initShake;break;case 2:this.posX=2*-this.initShake;this.posY=
2*this.initShake;break;case 3:this.posY=2*-this.initShake;break;case 4:this.posX=2*-this.initShake,this.posY=2*-this.initShake}};this.update=function(){this.install||(this.randomness=b.random(1,0)?2:4,this.initShake=this.strength,this.inOrDec=b.random(1,0)?!0:!1,this.amplitude.up=this.inOrDec?1:3,this.amplitude.down=this.inOrDec?3:1,this.install=!0);this.tick++;this.tick===this.amplitude.strength?(this.stateShake=this.amplitude.up,this.randomnessFn(this.randomness,this.stateShake)):this.tick===2*
this.amplitude.strength?(this.stateShake=this.amplitude.center,this.randomnessFn(this.randomness,this.stateShake)):this.tick===3*this.amplitude.strength&&(this.stateShake=this.amplitude.down,this.randomnessFn(this.randomness,this.stateShake));if(this.tick>3*this.amplitude.strength)return!0}}},effect:!0,volume:!0,totHitNum:0},staticAllMap:function(){for(var a="mapA mapB mapAADungeonA mapAADungeonB mapC mapDDungeonA mapDungeonA mapDungeonB mapDungeonC mapDungeonD mapDungeonE mapDungeonF mapDungeonG mapDungeonH".split(" "),
b={},c=0,g=a.length;c<g;c++)b[a[c]]={content:"",textures:""};return b}(),storageState:function(){this.storage=[];this.remove=function(a){var d=this.storage;if(d.length)for(var b=0;b<d.length;b++)d[b].name===a.toLowerCase()&&this.storage.splice(b,1)};this.get=function(a){var d=this.storage;if(d.length)for(var b=0;b<d.length;b++)if(d[b].name===a.toLowerCase())return d[b].status};this.set=function(a,b){var d=this.storage;if(d.length)for(var g=0;g<d.length;g++){if(d[g].name===a.toLowerCase()){d[g].status=
b;break}if(g===d.length-1){d.push({name:a.toLowerCase(),status:b});break}}else d.push({name:a.toLowerCase(),status:b})}}}}});b.that(b).invokeWith("_globalOwlBirdrProperty")};t.transport=function(a){var c=this,f=function(a){({charset:a.charset||"application/json;charset=UTF-8",http:window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),callback:a.callback,onerror:a.error||"ops, request time out",timeout:a.setTimeout||1123E3,url:a.url,type:a.type,dataset:a.dataset||{},requestHeader:function(){var d=
{"Content-Type":this.charset};c.extend(d,a.requestHeader);return d},setRequest:function(){var d=this,b=d.http,c;for(c in d)if(c in d)for(var g in b)g in b&&g.toLowerCase()===c.toLowerCase()&&(b[c]=d[c]);b.open(d.type,d.url,!0);for(var f in d.requestHeader())b.setRequestHeader(f,d.requestHeader()[f]);b.send(JSON.stringify(d.dataset));b.ontimeout="function"===typeof d.onerror&&d.onerror||function(){a.timeoutFn&&a.timeoutFn.call(this,b.status)};b.onerror=function(d){a.errorFn&&a.errorFn.call(this,b.status)};
b.onload=function(a){4===b.readyState&&(200===b.status||206===b.status?d.callback.call(this,b.responseText):404===b.status?d.callback.call(this,b.status):403===b.status?console.log("Forbidden"):500===b.status?console.log("Error 500"):300===b.status?console.log("Page Redirect"):console.log("Unknown"))}}}).setRequest()};c.slice(a?[a]:[]).forEach(function(a){f(a)})};t.mouse=function(){var a=this;this.mouseCreate=function(c){var f={};f.element=c||document.body;f.absolute={x:0,y:0};f.position={x:0,y:0};
f.mousedownPosition={x:0,y:0};f.mouseupPosition={x:0,y:0};f.offset={x:0,y:0};f.scale={x:1,y:1};f.wheelDelta=0;f.button=-1;f.pixelRatio=f.element.getAttribute("data-pixel-ratio")||1;f.sourceEvents={mousemove:{x:0,y:0},mousedown:{x:0,y:0},mouseup:{x:0,y:0}};f.mousemove=function(b){var d=a.getRelativeMousePosition(b,f.element,f.pixelRatio);b.changedTouches&&(f.button=0);f.absolute.x=d.x;f.absolute.y=d.y;f.position.x=f.absolute.x*f.scale.x+f.offset.x;f.position.y=f.absolute.y*f.scale.y+f.offset.y;f.sourceEvents.mousemove=
f.position;a.mousePosition.value.pos=f.sourceEvents};f.mousedown=function(b){var d=a.getRelativeMousePosition(b,f.element,f.pixelRatio);f.button=b.changedTouches?0:b.button;f.absolute.x=d.x;f.absolute.y=d.y;f.position.x=f.absolute.x*f.scale.x+f.offset.x;f.position.y=f.absolute.y*f.scale.y+f.offset.y;f.sourceEvents.mousedown=f.position;a.mousePosition.value.pos=f.sourceEvents};f.mouseup=function(b){b=a.getRelativeMousePosition(b,f.element,f.pixelRatio);f.button=-1;f.absolute.x=b.x;f.absolute.y=b.y;
f.position.x=f.absolute.x*f.scale.x+f.offset.x;f.position.y=f.absolute.y*f.scale.y+f.offset.y;f.sourceEvents.mouseup=f.position;a.mousePosition.value.pos=f.sourceEvents};c.addEventListener("mousemove",f.mousemove);c.addEventListener("mousedown",f.mousedown);c.addEventListener("mouseup",f.mouseup);c.addEventListener("mousewheel",f.mousewheel);c.addEventListener("DOMMouseScroll",f.mousewheel);c.addEventListener("touchmove",f.mousemove);c.addEventListener("touchstart",f.mousedown);c.addEventListener("touchend",
f.mouseup)};this.getRelativeMousePositionToRegisterObject=function(c){if(a.mousePosition.value.pos)for(var f=a.mousePosition.value.pos.mouseup.x,b=a.mousePosition.value.pos.mouseup.y,d=0;d<c.length;d++){var k=c[d].getBoundingClientRect();if(k.right>f&&k.left<f&&k.top<b&&k.bottom>b)return c[d].id}}};t.physics=function(){var a=this;this.physicsComponent={};this.physicsComponent.objectTrajectory=function(c,f,b){this.install=!1;this.target=c;this.targetLabel=c.label;this.targetRig=c.rigBody;this.targetTranslate=
{x:0,y:0};this.targetEnd="";b?(this.targetTranslate.x=b.x,this.targetTranslate.y=b.y):c.statParameters.mainCharacter?(this.vy=8,this.vx=12):(this.vy=9,this.vx=13);var d=this.target.rigBody;this.duration=f;this.halfDuration=f/2;this.globalTranslate=a.objTranslate.value;this.translateOvalOnly=function(a){this.targetRig.characterState&&(this.globalTranslate.staticObjMoveX=b?Math.abs(this.targetTranslate.x):Math.abs(this.vx),!a&&(this.globalTranslate.staticObjMoveX=0),this.globalTranslate.objPhysCollide&&
(this.duration=0,this.globalTranslate.objPhysCollide=!1))};this.install=!1;this.updatePhysic=function(b,c){if(0<this.duration){if(!this.install){var g=(d.turn?"right"===d.turn:"right"===d.monsterDir())?"right":"left";"right"===g?d.changeRightFn(!0):d.changeLeftFn(!0);this.vx="left"===g?-this.vx:this.vx;this.targetEnd={x:this.target.position.x,y:this.target.position.y};this.enemyParams=d.characterState?d.monsterParameters:d.character.statParameters;this.install=!0}this.duration--;g=this.globalTranslate.staticObjStateX;
var f=this.globalTranslate.staticObjMoveX,h=this.globalTranslate.staticObjStateY,k=this.globalTranslate.staticObjMoveY,q=this.target;this.vy=this.duration<this.halfDuration?Math.abs(this.vy):-Math.abs(this.vy);"left"===g?this.targetEnd.x+=f:"right"===g&&(this.targetEnd.x-=f);this.targetEnd.y+="up"===h?k:"down"===h?-k:0;b&&(this.targetTranslate.x+=this.vx);c&&(this.targetTranslate.y+=this.vy);this.translateOvalOnly(this.duration);a.Body.setPosition(q,{x:this.targetEnd.x+this.targetTranslate.x,y:this.targetEnd.y+
this.targetTranslate.y});if(this.enemyParams&&!this.enemyParams.health||this.targetLabel!==q.label)this.duration=0,this.translateOvalOnly(0)}}};this.physicsComponent.itemTrajectoryComponent=function(){this.itemTrajectory=function(c,f,b,d,k){this.name=c;this.parent=d;this.install=!1;this.x=0;this.y=-2;this.turn="";this.deltaX=this.deltaY=this.vx=this.vy=0;this.gravity=.03;this.deg=0;this.characterGetHit=!1;this.posHit=0;this.isTrajectory=!0;this.angle=0;this.speed=12;this.item=a.createItem.value(c,
f,b,"itemWithAngle");this.life=100;this.pass=0;this.angleSpeed=.03;this.acceleration=function(){this.vy+=this.gravity;this.x=this.speed;this.y+=this.vy};this.update=function(d,b,c,f,n,q,r){if(!this.install){this.isBoom=/boom/i.test(this.name);if("undefined"===typeof n.position)return a.World.remove(a.engine.world,this.item),!0;a.Body.setPosition(this.item,{x:d,y:b});a.Composite.addBody(a.engine.world,this.item);a.orderObjectFn.value();var g=n.position.y-b,h;100>=g?h=18:100<g&&130>=g?h=19:130<g&&180>
g?h=15.5:180<g&&(h=12.5);this.isBoom&&(h-=a.randomFloat(6.5,3.5));this.item.isStatic=!0;this.deltaX=d;this.deltaY=b;this.angle=c;this.speed=(n.position.x-d)/(this.parent.object.statParameters.range-100)*h;this.turn=f;this.angleSpeed=r?r:this.angleSpeed;this.install=!0}this.life--;if(0>this.life||q)return a.World.remove(a.engine.world,this.item),a.orderObjectFn.value(),!0;if(this.item.bounds.max.y<n.bounds.max.y&&this.isTrajectory||this.isBoom){d=n.position;c=Math.abs(d.x-this.item.position.x);b=this.item.position;
f=n.bounds.min.y-n.additionalBoundsValue-n.additionalBoundsHeightValue-this.item.bounds.min.y;this.isBoom?15>Math.abs(n.bounds.max.y-this.item.bounds.max.y)&&(this.characterGetHit=!0):60>c&&40>f&&(this.characterGetHit=!0);if(this.characterGetHit){if(this.isBoom)if(k)k(this.item);else{if(this.parent.object.visible)for(a.explosiveA({object:this.item,parent:"",alpha:!1}),a.playAudio("explosion"),n=this.parent.createAreaDamagePool({target:this.item,width:300,height:300,caster:this.parent.object.label}),
c=0;c<n.length;c++)this.parent.characterDamagePool({objectAttacker:this.parent.object,objectTarget:n[c].object})}else this.parent.character.statParameters&&this.parent.characterDamagePool({objectAttacker:this.parent.object,objectTarget:this.parent.character});this.life=0}this.characterGetHit||(this.acceleration(),n=b.x+this.x,c=b.y+this.y,this.characterGetHit&&this.pass?(this.x=this.posHit,this.y=d.y+100,this.item.force.x=this.x,this.item.force.y=this.y):(a.Body.setPosition(this.item,{x:n,y:c}),this.item.angleInRadians=
a.angleToRadian(this.angle),this.posHit=b.x,this.angle+="right"===this.turn?-this.angleSpeed:this.angleSpeed,this.item.angle=this.angle,this.prevX=n,this.prevY=c),this.pass++)}else this.isTrajectory=!1;return!1}};this.trajectoriesUpdate=[];this.trajectoryInit={pushTrajectoryItem:function(a){var c=a.parent;trajectoryProp=c.object.statParameters.trajectoryProp;c.trajectoriesUpdate.push(new c.itemTrajectory(a.weaponName,a.weaponWidth,a.weaponHeight,c,a.callback));trajectoryProp.angleSpeed&&(c.trajectoriesUpdate[c.trajectoriesUpdate.length-
1].angleSpeed=trajectoryProp.angleSpeed)},createSkillTrajectory:function(a){var c=a.parent.object.statParameters.trajectoryProp;c&&this.pushTrajectoryItem({parent:a.parent,weaponName:a&&a.weaponName?a.weaponName:c.weaponName,weaponWidth:a&&a.weaponWidth?a.weaponWidth:c.weaponWidth,weaponHeight:a&&a.weaponHeight?a.weaponHeight:c.weaponHeight,callback:a&&a.callback?a.callback:""})},createNormalTrajectory:function(a){var c=a.object.statParameters.trajectoryProp;weaponName=c.weaponName;weaponWidth=c.weaponWidth;
weaponHeight=c.weaponHeight;callback="";this.pushTrajectoryItem({parent:a,weaponName:weaponName,weaponWidth:weaponWidth,weaponHeight:weaponHeight,callback:callback})}}};this.moveVector2dSmooth=function(c,f,b){c=a.distanceAndAngleBetweenTwoPoints(c.position.x,c.position.y,f.position.x,f.position.y);return new a.vector(c.distance/b,c.angle)};this.moveVector2dWithVelocity=function(c,f,b,d){c=c.position?a.distanceAndAngleBetweenTwoPoints(c.position.x,c.position.y,f.position.x,f.position.y):a.distanceAndAngleBetweenTwoPoints(c.x,
c.y,f.x,f.y);return d?{vector:new a.vector(b,c.angle),angle:c.angle}:a.extend(new a.vector(b,c.angle),{distance:c.distance},!0)};this.moveVector2d=function(a,f,b){this.install=!1;this.start=a.position;this.dest=f.position;this.lastTime=(new Date).getTime();this.startSpeed=b||.4;this.velocity=null;this.update=function(){if(!this.install){var a=this.start,b=this.dest,c=b.x-a.x;a=b.y-a.y;b=Math.sqrt(c*c+a*a);this.startVelocity=c={x:c/b*this.startSpeed,y:a/b*this.startSpeed};this.velocity=Object.create(c);
this.install=!0}c=(new Date).getTime();a=c-this.lastTime;b=this.velocity;this.lastTime=c;return{x:b.x*a,y:b.y*a}}}};t.particle=function(){var a=this,c={textures:[],particleSpec:function(){this.opacity=1;this.decLife=a.random(4,3);this.decSize=a.random(3,2);this.centerY=this.centerX=0},createParticles:function(f){for(var b=null,d=a.context,k,h=0,g=this.textures,l=g.length;h<l;h++)g[h].src===f.src&&(b=g[h]);k=d.createTexture();d.bindTexture(d.TEXTURE_2D,k);d.texImage2D(d.TEXTURE_2D,0,d.RGBA,1,1,0,d.RGBA,
d.UNSIGNED_BYTE,new Uint8Array([0,0,255,255]));d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,d.CLAMP_TO_EDGE);d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,d.CLAMP_TO_EDGE);d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,d.LINEAR);if(b)b.img.complete&&(k=b.glTexture,p=b.img,d.bindTexture(d.TEXTURE_2D,k),d.texImage2D(d.TEXTURE_2D,0,d.RGBA,d.RGBA,d.UNSIGNED_BYTE,p));else{var p=new Image;p.src=f.src;p.addEventListener("load",function(){d.bindTexture(d.TEXTURE_2D,k);d.texImage2D(d.TEXTURE_2D,0,d.RGBA,
d.RGBA,d.UNSIGNED_BYTE,p)});this.textures.push({src:f.src,img:p,glTexture:k})}b=a.random(f.lifeRange[1],f.lifeRange[0]);return a.extend({parent:f.parent,texture:k,width:f.width,height:f.height,sizeWidth:f.width,sizeHeight:f.height,x:f.bind.x-f.width/2,y:f.bind.y-f.height/2,lifeTick:b,life:b,lifeRange:f.lifeRange,src:f.src},new c.particleSpec)},particleEmitter:function(f){this.gl=a.context;this.reset=!0;this.glProp=a.glDrawV1nV2.value;this.objTranslate=a.objTranslate.value;this.particleContainer=[];
this.particleLoader=function(b){this.reset="undefined"!==typeof b.reset?b.reset:!0;this.parent=b.parent;this.needTranslate="undefined"!==typeof b.needTranslate?b.needTranslate:!0;this.alpha=b.alpha;this.lifeSpan=b.lifeSpan;this.behaviour=b.behaviour;this.bind=b.bind;for(this.velocity={x:b.velocity[0],yMax:2*b.velocity[1],yMin:b.velocity[1]};b.particleNumber--;){if(b.sizeRandom){var d=a.random(b.sizeRandom[1],b.sizeRandom[0]);b.height=b.width=d}this.particleContainer.push(c.createParticles(b))}};this.draw=
function(b){var d=this.glProp,c=this.gl,f=a.orthographic,g=a.webglM4;c.bindTexture(c.TEXTURE_2D,b.texture);c.useProgram(d.program);c.bindBuffer(c.ARRAY_BUFFER,d.positionBuffer);c.enableVertexAttribArray(d.positionLocation);c.vertexAttribPointer(d.positionLocation,2,c.FLOAT,!1,0,0);c.bindBuffer(c.ARRAY_BUFFER,d.texcoordBuffer);c.enableVertexAttribArray(d.texcoordLocation);c.vertexAttribPointer(d.texcoordLocation,2,c.FLOAT,!1,0,0);c.uniformMatrix4fv(d.matrixLocation,!1,f);f=g.translate(f,b.x+b.centerX,
b.y+b.centerY,0);f=g.scale(f,b.width,b.height,1);c.uniformMatrix4fv(d.matrixLocation,!1,f);c.uniform1i(d.textureLocation,0);c.drawArrays(c.TRIANGLES,0,6)};this.translateState=!0;this.translate=new a.objGlobalTranslate;this.alpha=!0;this.clear=function(){this.particleContainer.length=0};this.update=function(){var a=this.particleContainer,d=this.gl,f=this.velocity;if(a.length){if(!this.parent.bind.visible)return!0;this.alpha&&d.blendFunc(d.SRC_ALPHA,d.ONE_MINUS_CONSTANT_ALPHA);for(var h=0;h<a.length;h++){var g=
a[h];this.behaviour(g,f);this.needTranslate&&this.translate.update(g);d.useProgram(this.glProp.program);d.uniform1f(this.glProp.alphaLocation,g.opacity);this.draw({texture:a[h].texture,x:g.x,y:g.y,width:g.width,height:g.height,centerX:g.centerX,centerY:g.centerY});var l=0>g.lifeTick||0>g.width;l&&this.reset?a[h]=c.createParticles({width:g.sizeWidth,height:g.sizeHeight,bind:this.bind,lifeRange:g.lifeRange,src:g.src}):l&&!this.reset&&a.splice(h,1);d.uniform1f(this.glProp.alphaLocation,1)}d.blendFunc(d.ONE,
d.ONE_MINUS_SRC_ALPHA)}else return!0}}};this.createArrowRainParticle=function(c,b){this.bind=c;this.position=function(){this.x=c.position.x+a.random(250,50);this.y=-100};this.particlesEnd=[];this.particles=[];this.particleNumber=b;this.radian=a.angleToRadian(330);this.draw=function(){if(this.install){for(var b=this.particles,c=0;c<b.length;c++){g=b[c];var f=g.position;g.install||(g.angleInRadians=this.radian,g.randomStart=a.random(50,0),g.randomEnd=a.random(40,-100),g.decRandY=a.random(40,30),g.life=
a.random(100,50),g.opacity=1,g.end=!1,g.endForParent=!0,g.install=!0,g.audio=!1);0<g.randomStart?g.randomStart--:(g.audio||(this.bind.visible&&a.playAudio("arrow-fire-hit"),g.audio=!0),f.y>this.bind.position.y+g.randomEnd||g.end?(!g.end&&this.particlesEnd.push(g),g.end=!0):a.Body.setPosition(g,{x:f.x-12,y:f.y+g.decRandY}),g.life--||(a.World.remove(a.staticWorld.value,g),a.orderObjectFn.value(),b.splice(c,1)))}if(!b.length)return!0}else{for(this.install=!0;this.particleNumber--;){var g=new a.createItem.value("arrowDrotate",
37,37,"itemWithAngle");b=new this.position;a.Body.setPosition(g,{x:b.x,y:b.y});a.World.add(a.staticWorld.value,g);this.particles.push(g)}this.bind.visible&&a.playAudio("Scary impact")}}};this.createGrowRing=function(a){this.bind=a.bind;this.life=a.life;this.targetStart={x:a.bind.x+a.optionalX,y:a.bind.y+a.optionalY};this.draw=function(){this.install||(this.particleA=new c.particleEmitter,this.particleA.particleLoader({parent:this,src:a.src,bind:this.targetStart,particleNumber:1,needTranslate:!1,width:a.width,
height:a.height,lifeRange:[100,50],velocity:[0,0],alpha:!0,behaviour:function(b){b.install?b.width<a.growingMax&&(b.width+=3,b.height+=3):(b.opacity=0,b.install=!0);10>b.parent.life?b.opacity-=.1:1>b.opacity&&(b.opacity+=.1);b.x=b.parent.targetStart.x;b.y=b.parent.targetStart.y;b.centerX=-b.width/2;b.centerY=-b.height/2}}),this.install=!0);this.particleA.update();if(this.life)this.life--;else return this.particleA.clear(),!0}};this.createShieldParticle=function(a,b,d,k){this.bind=a;this.life=b;this.additionalHeight=
a.additionalBoundsHeightValue;this.targetStart=a.position;this.draw=function(){var a=this.additionalHeight-k,b=this.life-100;this.install||(this.particleA=new c.particleEmitter,this.particleB=new c.particleEmitter,this.particleA.particleLoader({parent:this,src:d.shield,bind:this.targetStart,particleNumber:1,width:10,height:10,lifeRange:[100,50],velocity:[0,0],alpha:!0,behaviour:function(b){b.install?190>b.width?(b.width+=20,b.height+=20,1>b.opacity&&(b.opacity+=.1)):10>b.parent.life&&(b.opacity-=
.1):(b.opacity=0,b.install=!0);b.x=this.bind.x;b.y=this.bind.y;b.centerX=-b.width/2;b.centerY=-b.height/2-a}}),this.particleB.particleLoader({parent:this,src:d.innerShield,bind:this.targetStart,particleNumber:1,width:10,height:10,lifeRange:[100,50],velocity:[0,0],alpha:!1,behaviour:function(d){d.install?130>d.width?(d.width+=15,d.height+=15,.4>d.opacity&&(d.opacity+=.1)):d.parent.life<b&&0<d.opacity&&(d.opacity-=.1):(d.opacity=0,d.install=!0);d.x=this.bind.x;d.y=this.bind.y;d.centerX=-d.width/2;d.centerY=
-d.height/2-a}}),this.install=!0);this.particleA.update();this.particleB.update();if(this.life)this.life--;else return this.particleA.clear(),this.particleB.clear(),!0}};this.createBlueParticle=function(f,b,d,k){this.flip=this.hit=!1;this.life=b;this.bind=f;this.staticPos=d;this.targetExplode=0;this.targetDelay=100;this.targetDummy=new a.createItem.value("1px",1,1);this.targetStart={x:f.position.x+this.staticPos.x,y:f.position.y+this.staticPos.y};this.targetEnd="";this.hitted=!0;this.translate=new a.objGlobalTranslate;
this.draw=function(){this.targetStart.x=f.position.x+this.staticPos.x;this.targetStart.y=f.position.y+this.staticPos.y;this.install||(this.particleA=new c.particleEmitter,this.particleB=new c.particleEmitter,this.particleC=new c.particleEmitter,this.particleA.particleLoader({parent:this,src:a.path+k.cyrcle,bind:this.targetStart,particleNumber:20,width:k.sizeCyrcle,height:k.sizeCyrcle,lifeRange:[100,50],velocity:[0,0],alpha:!0,behaviour:function(b,d){b.install?0===b.sum&&1>b.opacity?(b.opacity+=.3,
b.lifeTick-=b.decLife,b.width-=b.decLife,b.height-=b.decLife):(b.lifeTick-=b.decLife,b.width-=b.decLife,b.height-=b.decLife,b.opacity=b.lifeTick/b.life,b.sum+=b.decLife,b.centerX=b.sum/2,b.centerY=b.sum/2):(b.x+=5,b.sum=0,b.opacity=0,b.decLife=a.random(4,2),b.install=!0)}}),this.particleB.particleLoader({parent:this,src:a.path+k.ring,bind:this.targetStart,particleNumber:5,width:100,height:100,lifeRange:[100,50],velocity:[0,0],alpha:!0,behaviour:function(b,d){b.install?0===b.sum&&1>b.opacity?b.opacity+=
.1:(b.lifeTick-=b.decLife,b.width-=b.decLife,b.height-=b.decLife,b.opacity=b.lifeTick/b.life,b.sum+=b.decLife,b.centerX=b.sum/2,b.centerY=b.sum/2):(b.y-=5,b.sum=0,b.opacity=0,b.decLife=a.random(3,1),b.install=!0)}}),this.particleC.particleLoader({parent:this,src:a.path+k.cyrcle,bind:this.targetDummy,particleNumber:3,width:100,height:100,lifeRange:[100,100],velocity:[0,0],alpha:!0,behaviour:function(b,d){b.lifeTick-=b.decLife;b.width-=b.decSize;b.height-=b.decSize;b.opacity=b.lifeTick/b.life;b.y+=
a.random(d.yMax,-d.yMin);b.x+=a.random(d.x,-d.x)}}),this.install=!0);this.hit=!1;if(0<this.targetDelay||!this.targetEnd)this.targetDelay--,this.particleA.translateState=!0;else{var b=this.targetDummy,d=this.targetDummy.position,l=a.moveVector2dWithVelocity(b,this.targetEnd,5),p=Math.round(l.distance);this.translate.update(d);this.particleA.translateState=!1;this.flip?10>p?(this.targetDelay=100,this.targetExplode=30,this.hitted=this.hit=!0,this.flip=!1,this.particleA.bind=this.targetStart,this.bind.visible&&
(a.playAudio("heat-impact"),a.explosiveA({object:this.targetEnd,parent:"",alpha:!1})),this.particleC.bind=this.targetEnd.position,a.Body.setPosition(b,{x:this.targetStart.x,y:this.targetStart.y})):a.Body.setPosition(b,{x:b.position.x+l.x,y:b.position.y+l.y}):(this.bind.visible&&a.playAudio("Bassy_swoosh"),this.particleA.bind=d,a.Body.setPosition(b,{x:this.targetStart.x,y:this.targetStart.y}),this.flip=!0,this.hitted=!1)}10>this.life&&(this.particleA.reset=!1,this.particleB.reset=!1,this.particleC.reset=
!1);this.particleA.update();this.particleB.update();this.particleC.update();this.targetExplode?(this.targetExplode--,this.particleC.reset=!0):this.particleC.reset=!1;if(this.life)return this.life--,{life:!1,hit:this.hit};this.particleA.clear();this.particleB.clear();this.particleC.clear();return{life:!0,hit:this.hit}}};this.createGlowParticle=function(f,b,d,k,h){this.particles="";this.bind=f;this.translate=new a.objGlobalTranslate;this.visible=!0;this.life=b;this.png=k||"blue-cycle.png";this.growEnd=
b-100;this.position=(this.bindToObject=h)?this.bind.position:{x:f.spawn?f.spawn.x:f.position.x,y:f.spawn?f.spawn.y:f.position.y};this.numOfParticles=d||20;this.draw=function(){if(!this.install){var b=this.growEnd;a.glowEffect({object:this,parent:"",alpha:!1,life:b,scaleSpeed:4,urlInner:k});this.particles=new c.particleEmitter;this.particles.particleLoader({parent:this,src:a.path+this.png,bind:this.position,particleNumber:this.numOfParticles,width:35,height:35,sizeRandom:[35,20],lifeRange:[100,50],
velocity:[0,0],alpha:!0,behaviour:function(d,g){if(!d.install){var c=a.random(110,-110);d.x+=c;d.y+=34;d.opacity=0;d.speedY=-45<c&&45>c?a.randomFloat(2.5,2):-100<c&&100>c?a.randomFloat(2,1):1;d.install=!0;d.lifeDec=a.random(3,2)}this.parent.life>b&&1>d.opacity&&!d.opacityState?(d.opacity+=.1,1<=d.opacity&&(d.opacity=1,d.opacityState=!0)):0<d.opacity?(c=d.lifeTick/d.life,opa=0<=c?c:0,d.opacity=opa,d.lifeTick-=d.lifeDec):d.opacity=0;d.y-=d.speedY}});this.install=!0}!this.bindToObject&&this.translate.update(this.position);
this.particles.update();if(this.life)this.life--;else return this.particles.clear(),!0}};this.createExplosiveParticle=function(f,b){this.particles="";this.bind=f;this.translate=new a.objGlobalTranslate;this.visible=!0;this.life=b;this.position={x:f.position.x,y:f.position.y};this.numOfParticles=7;this.draw=function(){this.install||(this.particles=new c.particleEmitter,this.particles.particleLoader({parent:this,reset:!1,src:a.path+"red-cyrcle.png",bind:this.position,particleNumber:this.numOfParticles,
width:35,height:35,sizeRandom:[35,20],lifeRange:[30,25],velocity:[0,0],alpha:!0,behaviour:function(b,c){if(!b.install){var d=360*Math.random()|0,g=5*Math.sin(d+180*Math.PI/180),f=function(){for(;;){var a=7*Math.cos((360*Math.random()|0)+180*Math.PI/180);if(0>a)return a}}();b.gravity=a.randomFloat(.45,.25);b.vx=g;b.vy=f;b.x+=g;b.y+=f;b.angle=d;b.velocity=function(){this.vy+=this.gravity;this.x+=this.vx;this.y+=this.vy};b.install=!0}b.velocity();b.lifeTick--;.5<b.opacity&&(d=b.lifeTick/b.life,opa=0<=
d?d:0,b.opacity=opa);1===b.lifeTick&&(d=this.parent.particlePositions)&&d.push({position:{x:b.x,y:b.y},visible:!0})}}),this.install=!0);this.translate.update(this.position);this.particles.update();if(this.life)this.life--;else return this.particles.clear(),!0}};this.hitNumber=function(c,b){this.number=c;this.numberSplit=c.toString().split("");this.critical=b&&b||"";this.install=!1;this.life=100;this.radius=12;this.remaining_life=this.life;this.tick=0;this.scaleState=11;this.moveYState=7;this.moveYStateFloat=
0;this.glDrawV3=a.glDrawV3.value;this.glDrawV1nV2=a.glDrawV1nV2.value;this.scaleY={a:10,b:20};this.scaleX={a:10,b:20};this.drawCnt=[];this.render={texture:"",src:a.path+"hit-num-color.png"};this.renderBold={texture:"",src:a.path+"hit-num-color-bold.png"};this.renderHeal={texture:"",src:a.path+"hit-num-color-heal.png"};this.renderBlock={texture:"",src:a.path+"block.png"};this.renderStun={texture:"",src:a.path+"stun.png"};this.renderMiss={texture:"",src:a.path+"miss.png"};this.opacity=1;this.numberCase=
function(){switch(this.number){case "block":this.texture=a.getTexture(this.render,this.renderBlock.src);break;case "stun":this.texture=a.getTexture(this.render,this.renderStun.src);break;case "miss":this.texture=a.getTexture(this.render,this.renderMiss.src);break;default:this.texture=a.getTexture(this.render,this.render.src)}"critical"===this.critical?this.texture=a.getTexture(this.renderBold,this.renderBold.src):"heal"===this.critical&&(this.texture=a.getTexture(this.renderBold,this.renderHeal.src))};
this.texture="";this.gravityX=this.gravityY=this.vx=this.vy=0;this.numberOnly=!0;this.newObj={context:a.context,width:40,height:40,state:"",image:"",posX:"",posY:"",scaleY:"",scaleX:"",additionalBoundsValue:""};this.objGlobalTranslate=new a.objGlobalTranslate;this.position={x:0,y:0};this.objTranslate=a.objTranslate.value;this.update=function(b,c){var d=this.newObj,g=this.position,f=c.additionalBoundsValue?-c.additionalBoundsValue:0,k=this.numberSplit.length;this.numberCase();if(!this.install){g.x=
c.position.x;g.y=c.bounds.min.y-50;this.vy=a.random(15,14);if(/block|miss|stun/i.test(this.number))this.missOrStun=/stun|miss/i.test(this.number),this.numberOnly=!1,this.drawCnt.unshift({fn:new a.draw.hitNumber,number:this.number});else for(var n=0;n<k;n++)this.drawCnt.unshift({fn:new a.draw.hitNumber,number:this.numberSplit[n]});this.objTranslate.totHitNum++;this.install=!0}this.gravityY-=this.vy;this.objGlobalTranslate.update(g);if(this.numberOnly){var q=3;var r=2.4;var v=0;var u="b";a.context.useProgram(this.glDrawV3.program);
a.context.uniform1f(this.glDrawV3.alphaLocation,this.opacity);for(n=0;n<this.drawCnt.length;n++){if(1===k){var K=20;q=5;r=4.4;v=5}else 2===k?(K=1===n?31.7:5,q=4,r=3.4):3===k?K=0===n?-6:1===n?20:46.7:4===k?(K=0===n?-16.7:1===n?10:2===n?36.7:63.3,v=-2):5===k&&(K=0===n?-33.3:1===n?-6.7:2===n?20:3===n?46.7:73.3,v=-5);this.scaleState>v?(this.scaleState--,this.scaleY[u]+=2,this.scaleX[u]+=1.5):(-15<this.scaleY[u]&&(this.scaleY[u]-=q),-15<this.scaleX[u]&&(this.scaleX[u]-=r));d.state=this.drawCnt[n].number;
d.image=this.texture;d.posX=g.x-K;d.posY=g.y+this.gravityY;d.scaleY=this.scaleY[u];d.scaleX=this.scaleX[u];d.additionalBoundsValue=f;d.numberOnly=this.numberOnly;this.drawCnt[n].fn.update(d)}a.context.uniform1f(this.glDrawV3.alphaLocation,1)}else this.scaleState--,u="b",5<this.scaleState?(this.scaleY[u]+=4,this.scaleX[u]+=3.5):(-1<this.scaleY[u]&&(this.scaleY[u]-=4),-1<this.scaleX[u]&&(this.scaleX[u]-=3)),this.missOrStun?(k=101,q=-30,K=35):(k=101,K=30,q=-50),d.state=this.drawCnt[0].number,d.width=
k,d.height=K,d.image=this.texture,d.posX=g.x+q,d.posY=g.y+this.gravityY,d.scaleY=this.scaleY[u],d.scaleX=this.scaleX[u],d.additionalBoundsValue=f,d.numberOnly=this.numberOnly,a.context.useProgram(this.glDrawV1nV2.program),a.context.uniform1f(this.glDrawV1nV2.alphaLocation,this.opacity),this.drawCnt[0].fn.update(d),a.context.uniform1f(this.glDrawV1nV2.alphaLocation,1);this.moveYStateFloat+=1;g.y+=6+this.moveYStateFloat;0<this.moveYState?this.moveYState--:this.opacity-=.05;this.tick++;if(20<=this.tick)return this.objTranslate.totHitNum&&
this.objTranslate.totHitNum--,this.numberSplit.length=0,this.drawCnt.length=0,!0}};this.hitEffect=function(c){var b=a.objTranslate.value;if(b.effect||10>=b.totHitNum){b=(c.object.additionalBoundsValue?c.object.additionalBoundsValue:0)+20;var d=c.object.additionalBoundsHeightValue,f=a.random(2,0);a.staticGeometry.createStoratePassBG({target:c.object.position,x:c.object.position.x,y:c.object.position.y,parent:c.parent,storage:"storagePassBGAfterObject",fn:new a.magicCircle({url:a.path+(0===f?"cycrle-hit":
1===f?"cycrle-hit-2":"cycrle-hit-3")+".png",scale:a.random(35,20),scaleSpeed:c.scaleSpeed?c.scaleSpeed:3,life:1,target:"",imagePosY:a.random(0,-b),imagePosX:a.random(d/3,-d/3),scaleBefore:0,opacityLoss:a.randomFloat(.25,.1),alpha:c.alpha})})}};this.glowEffect=function(c){if(c.object.visible){var b=c.urlInner?a.path+c.urlInner:a.path+"green-cycrle.png",d=c.opacityLoss?c.opacityLoss:.02,f=c.object.position,h="undefined"!==typeof c.bind?c.bind:!0;"undefined"!==typeof c.isShake&&c.isShake&&a.objTranslate.value.isShake.createShake(1);
a.staticGeometry.createStoratePassBG({target:f,x:f.x,y:f.y,parent:c.parent,storage:"storagePassBG",bind:h,fn:new a.magicCircle({url:b,scale:35,scaleSpeed:c.scaleSpeed?c.scaleSpeed:5,life:c.life?c.life:25,target:"",imagePosY:15,imagePosX:0,scaleBefore:0,opacityLoss:d,alpha:c.alpha})})}};this.explosiveA=function(c){if(c.object.visible){var b=c.urlInner?c.urlInner:a.path+"cycrle-skill.png",d=c.urlOutter?c.urlOutter:a.path+"cycrle-skill-2.png";("undefined"!==typeof c.isShake?c.isShake:1)&&a.objTranslate.value.isShake.createShake(c.shakeNum?
c.shakeNum:2);a.staticGeometry.createStoratePassBG({target:c.object.position,x:c.object.position.x,y:c.object.position.y,parent:c.parent,storage:"storagePassBG",fn:new a.magicCircle({url:b,scale:35,scaleSpeed:3,life:1,target:"",imagePosY:20,imagePosX:0,scaleBefore:0,opacityLoss:.04,alpha:c.alpha})});a.staticGeometry.createStoratePassBG({x:c.object.position.x,y:c.object.position.y,parent:c.parent,storage:"storagePassBG",fn:new a.magicCircle({url:d,scale:35,scaleSpeed:5,life:1,target:"",imagePosY:20,
imagePosX:0,scaleBefore:0,opacityLoss:.05,alpha:c.alpha})})}};this.magicCircle=function(c){this.install=!1;this.glDrawV1nV2=a.glDrawV1nV2.value;this.imagePosY=c.imagePosY;this.imagePosX=c.imagePosX;this.scale=c.scale;this.scaleY=this.scaleX=0;this.scaleSpeed=c.scaleSpeed;this.opacityLoss=c.opacityLoss;this.life=c.life;this.target=c.target;this.scaleBefore=c.scaleBefore;this.offsetY=this.offsetX=.1;this.lengthOpacity={lengthEnd:0,lengthStart:0,remove:1};this.opacity=function(a){return a?(0<this.lengthOpacity.remove&&
(this.lengthOpacity.remove-=this.opacityLoss),0>=this.lengthOpacity.remove?0:this.lengthOpacity.remove):1/this.lengthOpacity.lengthEnd*this.lengthOpacity.lengthStart};this.render={texture:"",src:c.url};this.update=function(b,d){this.install||(this.render.textures=a.getTexture(this.render,this.render.src),this.draw=new a.draw.generalDrawImage,this.lengthOpacity.lengthEnd=this.scaleSpeed,this.target.bind&&(this.target=this.target.target),this.install=!0);0<this.scaleSpeed&&(this.scaleSpeed--,this.scaleX+=
this.scale,this.scaleY+=this.scale,this.offsetX+=this.scale/2,this.offsetY+=this.scale/2);"undefined"!==typeof d.remove?d.remove&&this.opacity(!0):0<this.life?this.life--:this.opacity(!0);b.useProgram(this.glDrawV1nV2.program);b.uniform1f(this.glDrawV1nV2.alphaLocation,this.lengthOpacity.remove);c.alpha||b.blendFunc(b.SRC_ALPHA,b.ONE_MINUS_SRC_ALPHA);this.draw.update({gl:b,image:this.render.textures,posX:this.target.x,posY:this.target.y,imagePosY:this.imagePosY,imagePosX:this.imagePosX,scaleX:this.scaleX,
scaleY:this.scaleY,offsetX:this.offsetX,offsetY:this.offsetY,scaleBefore:this.scaleBefore});c.alpha||b.blendFunc(b.ONE,b.ONE_MINUS_SRC_ALPHA);b.uniform1f(this.glDrawV1nV2.alphaLocation,1);if(.1>=this.lengthOpacity.remove)return!0}};this.loadingAct=function(a,b,d){this.radius=a;this.color=b||"rgba(0, 0, 0, 0.4 )";this.tick=d||100;this.curPerc=0;this.circ=2*Math.PI;this.quart=Math.PI/2;this.remove=!1;this.x=0;this.update=function(a,b,d,c){"reset"===c&&(this.curPerc=0);if(this.curPerc<this.tick&&!this.remove)this.x=
b?b:-500,this.curPerc++;else return!0}};this.drawLine=function(c,b,d,k,h){this.indexStart=0;this.gl=a.context;this.lineType=this.gl[d];this.nVertices=0;this.orthographic=a.orthographic;this.setup=function(d){var g=[];if("line"===k){this.setVertiecsByPoint=new a.AI.setVertiecsByPoint;d=c.position;for(var f=0,n=b,q;f<n.length;f++)q=n[f-1]?f-1:n.length-1,n[q].indexGl=q,this.setVertiecsByPoint.setPosition(d,n[q]),g.push(n[q]);this.indexStart=1}else if("path"===k)for(this.setVertiecsByPoint=new a.AI.setVertiecsByPoint,
d=c.position,f=0,n=b,q={};f<n.length;f++){if(!q.x){var r=a.AI.boundVertexToIndex(b),v=n[r.max.y].y-n[r.min.y].y,u=c.bounds.max.y-c.bounds.min.y,K=h?h.y:0;q.x=c.bounds.min.x-(n[r.max.x].x-n[r.min.x].x-(c.bounds.max.x-c.bounds.min.x))/2+(h?h.x:0);q.y=c.bounds.min.y-(v-u)/2+K}n[f].x+=q.x;n[f].y+=q.y;n[f].indexGl=f;this.setVertiecsByPoint.setPosition(d,n[f]);g.push(n[f])}else for(f=1<c.parts.length?1:0,n=c.parts.length;f<n;f++)for(q=0,r=c.parts[f].vertices.length;q<r;q++)d=c.parts[f].vertices,g.push(d[q]);
this.lineStart=g[this.indexStart];this.objVertices=g;g=a.glLine.value.program;f=this.gl;lineLocation=f.getAttribLocation(g,"a_position");matrixLocation=f.getUniformLocation(g,"u_matrix");lineBufferPosition=f.createBuffer();f.bindBuffer(f.ARRAY_BUFFER,lineBufferPosition);f.useProgram(g);n=[];d=0;for(r=this.objVertices;d<r.length;d++)q="undefined"===typeof r[d+1]?0:d+1,n.push(r[q].x-r[this.indexStart].x),n.push(r[q].y-r[this.indexStart].y);this.nVertices=this.objVertices.length;f.bufferData(f.ARRAY_BUFFER,
new Float32Array(n),f.STATIC_DRAW);this.orthographic=a.webglM4.scale(this.orthographic,1,1,1);this.program=g;this.matrixLocation=matrixLocation;this.lineBufferPosition=lineBufferPosition};this.setup();this.update=function(){var b=this.gl,d=this.lineStart,c=a.webglM4,f=a.orthographic;b.useProgram(this.program);b.bindBuffer(b.ARRAY_BUFFER,this.lineBufferPosition);b.enableVertexAttribArray(this.lineBufferPosition);b.vertexAttribPointer(this.lineBufferPosition,2,b.FLOAT,!1,0,0);f=c.translate(f,d.x,d.y,
0);b.uniformMatrix4fv(this.matrixLocation,!1,f);b.drawArrays(this.lineType,0,this.nVertices)}}};t.sprites=function(){var a=this;this.draw={};this.draw.enviOrnaments=function(){this.glProp=this.drawProp="";this.visible=this.install=!1;this.update=function(c){if(!this.install){var f=a.drawPropByVer(c);this.drawProp=f.drawProp;this.glProp=f.glProp;this.install=!0}a.drawImage(c.context,this.glProp,this.drawProp.update(c))}};this.draw.generalDrawImage=function(){this.glProp=this.drawProp="";this.draw=
new a.draw.enviOrnaments;this.install=!1;this.drawObj={};this.update=function(a){var c=this.drawObj;c.img=a.image;c.context=a.gl;c.ver="v2";c.width=0;c.height=0;c.posX=Math.floor(Math.floor(a.posX+a.imagePosX)-a.image.width/2-a.offsetX);c.posY=Math.floor(Math.floor(a.posY+a.imagePosY)-a.offsetY);c.scaleX=a.image.width+a.scaleBefore+a.scaleY;c.scaleY=a.image.height+a.scaleBefore+a.scaleX;this.draw.update(c)}};this.draw.monsterGeneral=function(){this.state=this.glProp=this.drawProp="";this.repeat=!0;
this.install=!1;this.frameStartFrom=this.frameindexAbsolute=this.indexHeight=this.frameindexHeight=this.frameindexWidth=this.height=this.width=0;this.levelFrames=8;this.tick=this.levelFrameUpdate=this.levelFramePerState=0;this.totalOfFrames=this.numberOfFrames=9;this.frameSpeed=1;this.tickHeight=0;this.opacity=2;this.activeImage="";this.drawObj={};this.frameFn=function(a){this.tick+=1;this.tick>=this.frameSpeed&&this.frameindexWidth<this.numberOfFrames?(this.tick=0,this.frameindexWidth++,this.frameindexAbsolute++):
this.frameindexWidth>this.levelFrameUpdate&&this.repeat?(1<this.tickHeight&&(this.frameindexAbsolute=this.frameStartFrom,this.frameindexHeight=this.indexHeight-this.height,this.tickHeight=0),/attack|boom|arrow|teleportation/i.test(a.state)&&(a.renderObj.repeatAttack=!0),this.frameindexWidth=this.frameStartFrom,this.frameindexHeight+=this.height,this.tickHeight++,a=this.height*(this.levelFramePerState+1)-this.height,this.frameindexHeight>a&&(this.frameindexHeight=a)):this.frameindexWidth>this.levelFrameUpdate&&
!this.repeat&&(this.frameindexAbsolute<this.numberOfFrames&&(this.frameindexHeight+=this.height),this.frameindexWidth=this.frameStartFrom,this.tickHeight++);!this.repeat&&this.frameindexAbsolute>=this.numberOfFrames&&(this.frameindexWidth=this.levelFrameUpdate)};this.draw=function(c,f){if(this.drawProp&&c.visible){var b=this.drawObj;b.ver=c.ver;b.img=this.activeImage;b.posX=f*this.activeImage.width/(this.totalOfFrames/this.levelFrames);b.posY=this.frameindexHeight;b.srcWidth=this.width;b.srcHeight=
this.height;b.dstX=c.positionX+-this.width/2+c.additionalBoundsWidthValue;b.dstY=c.positionY+-160+c.additionalBoundsHeightValue;b.dstWidth=this.width;b.dstHeight=this.height;b.angleInRadians=c.angleInRadians;a.drawImage(c.context,this.glProp,this.drawProp.update(b))}};this.update=function(c){this.state!==c.state&&(this.frameindexHeight=this.indexHeight=0,this.totalOfFrames=c.behaveRig.totalOfFrames,this.frameSpeed="attack"===c.behave&&c.renderObj.behaveRig.walk&&c.renderObj.behaveRig.walk.speedAttack?
c.renderObj.behaveRig.walk.speedAttack:c.behaveRig.speed,this.levelFramePerState=0,this.activeImage=c.image[c.state]?c.image[c.state]:c.image[this.state],this.frameindexWidth=0,/die/i.test(c.state)?this.repeat=!1:this.repeat=!0);if(this.state!==c.state&&c.image[c.state]&&(this.totalOfFrames=c.behaveRig.totalOfFrames,this.levelFrames=1,this.numberOfFrames=this.totalOfFrames,1<c.image[c.state].width)){this.width=c.image[c.state].width/(this.totalOfFrames/this.levelFrames);this.height=c.image[c.state].height/
this.levelFrames;this.levelFrameUpdate=this.totalOfFrames/this.levelFrames-1;var f=a.drawPropByVer(c);this.drawProp=f.drawProp;this.glProp=f.glProp;this.tickHeight=this.tick=this.frameindexAbsolute=0;this.state=c.state}f=this.frameindexWidth>this.levelFrameUpdate?0:this.frameindexWidth;this.frameFn(c);"die"===c.state&&(this.opacity=0<this.opacity?this.opacity-.02:0);this.draw(c,f)}};this.draw.hitNumber=function(c){this.draw=new a.draw.enviOrnaments;this.tickCount=this.frameIndex=0;this.numberOfFrames=
10;this.install=!1;this.drawObj={};this.update=function(a,b){var d=this.drawObj;if(a.numberOnly){switch(a.state){case "0":this.frameIndex=9;break;case "+":this.frameIndex=10;break;default:this.frameIndex=Math.abs(a.state)-1}d.img=a.image;d.context=a.context;d.ver="v3";d.posX=Math.floor(this.frameIndex*a.width);d.posY=0;d.srcWidth=a.width;d.srcHeight=a.height;d.dstX=Math.floor(a.posX-a.scaleY/2);d.dstY=a.posY+a.additionalBoundsValue;d.dstWidth=a.width+a.scaleY;d.dstHeight=a.height+a.scaleX}else d.img=
a.image,d.context=a.context,d.ver="v2",d.width=0,d.height=0,d.posX=Math.floor(a.posX-a.scaleY/2),d.posY=a.posY+a.additionalBoundsValue,d.scaleX=a.width+a.scaleY,d.scaleY=a.height+a.scaleX;this.draw.update(d)}};this.draw.map=function(){this.widthPos=this.heightPos=0;this.mapSize=200;this.delayTick=5;this.install=!1;this.moveY=this.positionX=0;this.drawProp="";this.drawObj={};this.glProp="";this.positionXtoEdge=-11;this.positionYtoEdge=0;this.update=function(c){if(!this.install){var f=a.drawPropByVer(c);
this.drawProp=f.drawProp;this.glProp=f.glProp;this.install=!0}this.delayTick&&(this.moveY=-c.image.height+a.browserHeightUpdate/2/4,this.heightPos=c.posY/4-this.moveY-this.mapSize-this.positionYtoEdge,this.delayTick--);this.positionX=c.screenSizeX-this.mapSize;f=this.drawObj;f.ver=c.ver;f.img=c.image;f.posX=Math.floor(-(c.posX/4)-c.center.x)+this.positionXtoEdge;f.posY=Math.floor(this.heightPos+-c.posY/4+c.center.y);f.srcWidth=Math.floor(this.mapSize*c.scaleSize);f.srcHeight=Math.floor(this.mapSize*
c.scaleSize);f.dstX=Math.floor(this.positionX);f.dstY=0;f.dstWidth=this.mapSize;f.dstHeight=this.mapSize;a.drawImage(c.context,this.glProp,this.drawProp.update(f))}};this.draw.mapMark=function(c){this.mapSize=200;this.positionX=this.posY=this.posX=0;this.positionXtoEdge=13;this.screenHeightMin=this.screenHeightMax=this.screenWidthMin=this.screenWidthMax=this.positionYtoEdge=this.positionY=0;this.render={red:{textures:"",src:a.path+"dot-red.png"},purple:{textures:"",src:a.path+"dot-purple.png",oval:!0},
blue:{textures:"",src:a.path+"dot-blue.png"},tower:{textures:"",src:a.path+"tower-icon.png"},orange:{textures:"",src:a.path+"dot-orange.png"},arrow:{textures:"",src:a.path+"arrow-map.png"},arrowHit:{textures:"",src:a.path+"arrow-map-hit.png"},help:{textures:"",src:a.path+"help.png"},info:{textures:"",src:a.path+"info.png"}};this.isInside=function(a,b,d){this.posX=this.positionX+b/a.scaleSize;this.posY=this.positionY+d/a.scaleSize;return this.posX+this.positionXtoEdge<this.screenWidthMax-a.center.x&&
this.posX>this.screenWidthMin-a.center.x&&this.posY>this.screenHeightMax-a.center.y&&this.posY<this.screenHeightMin-a.center.y};this.updateTest=1;this.posTemp={x:-100,y:-100};this.updatePos={x:0,y:0};this.delayTick=100;this.moveY=this.heightPos=0;this.drawProp="";this.drawObj={};this.glProp="";this.glowRing=[];this.angleTest=0;this.markNeedGlow={tick:0,tickUpdate:40};this.drawGlow=function(){for(var a=0,b=this.glowRing;a<b.length;a++)b[a].draw()&&this.glowRing.splice(a,1)};this.update=function(c){if(!this.install){var b=
a.drawPropByVer(c);this.drawProp=b.drawProp;this.glProp=b.glProp;this.positionY=10;this.screenHeightMax=0;this.screenHeightMin=this.mapSize-20;for(var d in this.render)a.getTexture(this.render[d],this.render[d].src);c.quest&&(this.renderObj=new a.draw.enviOrnaments,this.updatePos.x=c.pos.x,this.updatePos.y=c.pos.y);this.install=!0}this.screenWidthMax=a.browserWidthUpdate;this.screenWidthMin=a.browserWidthUpdate-this.mapSize;this.positionX=c.screenSizeX-this.mapSize;if(this.isInside(c,c.pos.x,c.pos.y)){c.quest?
(this.updatePos={x:c.pos.x,y:c.pos.y},b=this.render[c.colorTarget]):b=this.render[c.color];var f=this.posY+c.center.y+b.textures.height/3;d=this.drawObj;d.ver=c.ver;d.img=b.textures;d.posX=Math.floor(this.posX+c.center.x);d.posY=f;a.drawImage(c.context,this.glProp,this.drawProp.update(d));c.markNeedGlow&&(this.markNeedGlow.tick--||(this.posTemp.x=Math.floor(d.posX-2),this.posTemp.y=Math.floor(d.posY),this.posTemp.visible=!0,this.glowRing.push(new a.createGrowRing({bind:this.posTemp,life:20,width:10,
height:10,optionalX:10,optionalY:10,src:a.path+"red-rings.png",growingMax:30})),this.markNeedGlow.tick=this.markNeedGlow.tickUpdate),this.drawGlow())}else if(c.quest){f=a.moveVector2dWithVelocity(c.characterPos,this.updatePos,this.updateTest,!0);b=this.render[c.color];d=f.vector;f=f.angle;this.isInside(c,this.updatePos.x,this.updatePos.y)?(this.posTemp.x=Math.floor(this.posX+c.center.x),this.posTemp.y=Math.floor(this.posY+c.center.y),this.updatePos.x=c.pos.x,this.updatePos.y=c.pos.y,this.updateTest=
1,this.posTemp.visible=!0,c.warning&&this.glowRing.push(new a.createGrowRing({bind:this.posTemp,life:20,width:10,height:10,optionalX:10,optionalY:10,src:a.path+"red-rings.png",growingMax:30}))):(this.updatePos.x+=d.x,this.updatePos.y+=d.y,this.updateTest--);this.drawGlow();var h=b.textures.width,g=b.textures.height;d=this.drawObj;d.ver="v3";d.context=c.context;d.img=b.textures;d.posX=0;d.posY=0;d.srcWidth=h;d.srcHeight=g;d.dstX=this.posTemp.x;d.dstY=this.posTemp.y;d.dstWidth=h;d.dstHeight=g;d.angleInRadians=
180-Math.PI/180*f;d.visible=!0;d.test=!0;this.renderObj.update(d)}}}};t.plugins=function(){var a=this,c=["b","o","m","d","a"].reverse().join(""),f="rennab".split("").reverse().join(""),b="laititsretni".split("").reverse().join(""),d=["d","i"].reverse().join(""),k="3341961968/4452499906520493-bup-ppa-ac".split("").reverse().join(""),h="stneve".split("").reverse().join(""),g=["E","S","O","L","C"].reverse().join(""),l=["N","E","P","O"].reverse().join(""),p="LIAF_DAOL".split("").reverse().join(""),n=
["D","A","O","L"].reverse().join(""),q={};this.ikGog=(q[f]=function(a){if(V[c]){var b="palrevo".split("").reverse().join(""),g=["e","z","i","s"].reverse().join(""),k="poTtArennab".split("").reverse().join(""),l="ELGNATCER_MUIDEM".split("").reverse().join(""),r="1118790036/4452499906520493-bup-ppa-ac".split("").reverse().join(""),q={};V[c][f].config((q[d]=r,q[b]=!0,q[g]=l,q[k]=!0,q));V[c][f].prepare();V[c][f].show();a.eventLoadfail&&document.addEventListener(c+"."+[f]+"."+h+"."+p,a.eventLoadfail);
a.eventLoad&&document.addEventListener(c+"."+[f]+"."+h+"."+n,a.eventOpen)}else a.evenAdsUndefined&&a.evenAdsUndefined()},q[b]=function(a){if(V[c]){var f={};V[c][b].config((f[d]=k,f));V[c][b].prepare();V[c][b].show();a.eventClose&&document.addEventListener(c+"."+[b]+"."+h+"."+g,a.eventClose);a.eventOpen&&document.addEventListener(c+"."+[b]+"."+h+"."+l,a.eventOpen);a.eventLoadfail&&document.addEventListener(c+"."+[b]+"."+h+"."+p,a.eventLoadfail);a.eventLoad&&document.addEventListener(c+"."+[b]+"."+
h+"."+n,a.eventLoad)}else a.evenAdsUndefined&&a.evenAdsUndefined()},q);this.infoHelp=new function(){var a=new t.utils;this.container=a.qs("help-info");this.containerEl=a.qs("container-info");this.cloneElement=[{element:a.qs("chara"),text:m.lang.fn("guiInfo","guiMainCharaButton","detail"),navigate:"right",callbackStart:function(){window.scope.blockRender=!0},callbackEnd:function(){window.scope.blockRender=!1},css:function(){a.css(a.qs("text-info"),{top:"-100px"});a.css(a.qs("close-info"),{top:"115px"})}},
{element:a.qs("chara-support-b"),text:m.lang.fn("guiInfo","guiSupportCharaButton","detail"),navigate:"right",callbackStart:function(){window.scope.blockRender=!0},callbackEnd:function(){window.scope.blockRender=!1},css:function(){a.css(a.qs("text-info"),{top:"-100px"});a.css(a.qs("close-info"),{top:"125px"})}},{element:a.qs("bag-button"),elementMirror:function(){return a.qs("bag-button")},text:m.lang.fn("guiInfo","guiMenuButton","detail"),navigate:"right",callbackStart:function(){window.scope.blockRender=
!0},callbackEnd:function(){window.scope.blockRender=!1},css:function(){a.css(a.qs("text-info"),{top:"-100px"});a.css(a.qs("close-info"),{top:"125px"})}},{element:a.qs("shop"),elementMirror:function(){return a.qs("shop")},text:m.lang.fn("guiInfo","guiShopButton","detail"),navigate:"right",callbackStart:function(){window.scope.blockRender=!0},callbackEnd:function(){window.scope.blockRender=!1},css:function(){a.css(a.qs("text-info"),{top:"-100px"});a.css(a.qs("close-info"),{top:"95px"})}},{element:a.qs("mining-button"),
elementMirror:function(){return a.qs("mining-button")},text:m.lang.fn("guiInfo","guiMiningButton","detail"),navigate:"right",callbackStart:function(){window.scope.blockRender=!0},callbackEnd:function(){window.scope.blockRender=!1},css:function(){a.css(a.qs("text-info"),{top:"-100px"});a.css(a.qs("close-info"),{top:"125px"})}},{element:a.qs("info-remaining"),elementMirror:function(){return a.qs("info-remaining")},text:m.lang.fn("guiInfo","guiInfoRemainingButton","detail"),navigate:"right",callbackStart:function(){window.scope.blockRender=
!0},callbackEnd:function(){window.scope.blockRender=!1},css:function(){a.css(a.qs("text-info"),{top:"-100px"});a.css(a.qs("close-info"),{top:"95px"})}},{element:a.qs("controller-appear"),text:m.lang.fn("guiInfo","guiVirtualControlButton","detail"),navigate:"right",callbackStart:function(){window.scope.blockRender=!0;window.scope.virtualControl=!0},callbackEnd:function(){window.scope.blockRender=!1},css:function(){a.css(a.qs("text-info"),{top:"-100px"});a.css(a.qs("close-info"),{top:"75px"})}},{element:a.id("slot-mp"),
elementMirror:function(){return a.id("slot-mp")},text:m.lang.fn("guiInfo","potionMPattach","detail"),navigate:"right",callbackStart:function(){window.scope.blockRender=!0},callbackEnd:function(){window.scope.blockRender=!1},css:function(){a.css(a.qs("text-info"),{top:"-100px"});a.css(a.qs("close-info"),{top:"145px"})}},{element:a.id("slot-hp"),elementMirror:function(){return a.id("slot-hp")},text:m.lang.fn("guiInfo","potionHPattach","detail"),navigate:"right",callbackStart:function(){window.scope.blockRender=
!0},callbackEnd:function(){window.scope.blockRender=!1;a.isMobile()||(a.removeClass(a.qs("help-info-success"),"hidden"),setTimeout(function(){a.addClass(a.qs("help-info-success"),"show-menu")},100))},css:function(){a.css(a.qs("text-info"),{top:"-100px"});a.css(a.qs("close-info"),{top:"145px"})}},{element:a.isMobile()?a.qs("attack-right-nav"):"",elementMirror:function(){return a.qs("attack-right-nav")},text:m.lang.fn("guiInfo","guiAttackNavButton","detail"),navigate:"left",callbackStart:function(){window.scope.blockRender=
!0},callbackEnd:function(){window.scope.blockRender=!1},css:function(){a.css(a.qs("text-info"),{top:"-100px"});a.css(a.qs("close-info"),{top:"75px"})}},{element:a.isMobile()?a.qs("auto-skill-nav"):"",elementMirror:function(){return a.qs("auto-skill-nav")},text:m.lang.fn("guiInfo","guiAutoSkillButton","detail"),navigate:"left",callbackStart:function(){window.scope.blockRender=!0},callbackEnd:function(){window.scope.blockRender=!1},css:function(){a.css(a.qs("text-info"),{top:"-150px"});a.css(a.qs("close-info"),
{top:"25px"})}},{element:a.isMobile()?a.qs("auto-switch-nav"):"",elementMirror:function(){return a.qs("auto-switch-nav")},text:m.lang.fn("guiInfo","guiAutoSwitchButton","detail"),navigate:"left",callbackStart:function(){window.scope.blockRender=!0},callbackEnd:function(){window.scope.blockRender=!1},css:function(){a.css(a.qs("text-info"),{top:"-150px"});a.css(a.qs("close-info"),{top:"40px"})}},{element:a.isMobile()?a.qs("switch-right-nav"):"",elementMirror:function(){return a.qs("switch-right-nav")},
text:m.lang.fn("guiInfo","guiAutoSwitchSkillButton","detail"),navigate:"left",callbackStart:function(){window.scope.blockRender=!0},callbackEnd:function(){window.scope.blockRender=!1;a.removeClass(a.qs("help-info-success"),"hidden");setTimeout(function(){a.addClass(a.qs("help-info-success"),"show-menu")},100)},css:function(){a.css(a.qs("text-info"),{top:"-150px"});a.css(a.qs("close-info"),{top:"40px"})}},{element:a.qs("menu-profile"),text:m.lang.fn("guiInfo","buttonMenu","detail"),navigate:"right"},
{element:a.qs("button-random-hig"),text:m.lang.fn("guiInfo","randomHard","detail"),navigate:"right",css:function(){a.css(a.qs("text-info"),{top:"-100px"});a.css(a.qs("close-info"),{top:"65px"})}},{element:a.qs("button-random-mid"),text:m.lang.fn("guiInfo","randomMed","detail"),navigate:"right",css:function(){a.css(a.qs("text-info"),{top:"-100px"});a.css(a.qs("close-info"),{top:"65px"})}},{element:a.qs("button-random-eas"),text:m.lang.fn("guiInfo","randomEas","detail"),navigate:"right",css:function(){a.css(a.qs("text-info"),
{top:"-100px"});a.css(a.qs("close-info"),{top:"65px"})}},{element:a.qs("cnt-villant"),elementMirror:function(){return a.qs("cnt-villant").getElementsByTagName("li")[0].getElementsByTagName("li")[0]},text:m.lang.fn("guiInfo","chooseVillant","detail"),navigate:"right",css:function(){a.css(a.qs("text-info"),{top:"100px"});a.css(a.qs("close-info"),{top:"290px"})}},{element:a.qs("box-profile-detail"),elementMirror:function(){return a.qs("m-level")},text:m.lang.fn("guiInfo","tapSkill","detail"),navigate:"right",
css:function(){a.css(a.qs("text-info"),{top:"-160px"});a.css(a.qs("close-info"),{top:"5px"})}},{element:a.qs("box-hero"),elementMirror:function(){return a.qs("box-hero").getElementsByTagName("li")[0]},text:m.lang.fn("guiInfo","chooseHero","detail"),navigate:"right",css:function(){a.css(a.qs("text-info"),{top:"100px"});a.css(a.qs("close-info"),{top:"290px"})}},{element:a.qs("cnt-map").getElementsByTagName("li")[0],text:m.lang.fn("guiInfo","chooseMap","detail"),navigate:"right",css:function(){a.css(a.qs("text-info"),
{top:"70px"});a.css(a.qs("close-info"),{top:"260px"})}},{element:a.qs("box-profile"),elementMirror:function(){return a.qs("box-profile").getElementsByTagName("li")[1]},text:m.lang.fn("guiInfo","tapCharacter","detail"),navigate:"right",css:function(){a.css(a.qs("text-info"),{top:"-100px"});a.css(a.qs("close-info"),{top:"65px"})}}];this.cntState=function(b,d){var c=this;"open"===d&&(a.removeClass(c.container,"hidden"),setTimeout(function(){a.addClass(c.container,"show-menu")},100))};this.freeze=!1;
this.update=function(){var b=this,d,c=setInterval(function(){"true"===localStorage.getItem("tutorial")&&(clearInterval(c),window.scope.virtualControl=!0);if(b.breakTime)b.breakTime=!1;else if(!b.freeze)for(var g=0;g<b.cloneElement.length;g++){if(!b.cloneElement[g].element){b.cloneElement.splice(g,1);break}d=b.cloneElement[g];var f=d.element,h=f.getBoundingClientRect();if(h.x){var k=f.cloneNode(!0),l=document.createElement("div");d.elementMirror&&(k=d.elementMirror(),h=k.getBoundingClientRect(),k=
k.cloneNode(!0));switch(d.navigate){case "right":l.className="nav-info-right";a.css(l,{position:"fixed",top:h.y+h.height/2-20+"px",left:h.x+h.width+20+"px"});break;case "left":l.className="nav-info-left",a.css(l,{position:"fixed",top:h.y+h.height/2-20+"px",left:h.x-h.width/2-40+"px"})}k.nodeName="LI";a.css(k,{"list-style":"none"});a.css(k,{position:"fixed",top:h.y+"px",left:h.x+"px",margin:"0px"});b.containerEl.innerHTML="";b.containerEl.appendChild(k);b.containerEl.appendChild(l);d.css&&d.css();
d.callbackStart&&d.callbackStart();a.text(a.qs("text-info"),d.text);b.cntState(f.cloneNode(!0),"open");b.freeze=!0;b.deleteIndex=g;break}}},1E3);a.attachListener(a.qs("close-info"),"click",function(d){a.removeClass(a.qs("help-info"),"show-menu");setTimeout(function(){a.addClass(a.qs("help-info"),"hidden")},100);b.freeze=!1;b.breakTime=!0;(d=b.cloneElement[b.deleteIndex])&&d.callbackEnd&&d.callbackEnd();b.cloneElement.splice(b.deleteIndex,1)});a.attachListener(a.qs("close-info-success"),"click",function(d){a.removeClass(a.qs("help-info-success"),
"show-menu");setTimeout(function(){a.addClass(a.qs("help-info-success"),"hidden");clearInterval(c);b.cloneElement.length=0;localStorage.setItem("tutorial",!0);window.scope.virtualControl=!0},100)})}};this.audioBackground=new function(){this.container={};this.initCritical=this.currentInit="";this.createAudio=function(b,d,c){var g=this,f=function(){var f=a.globalAnimation.value,h=f.globalAudio.get(d+".ogg");if(h)var k=h;else k=new Audio,k.src=a.path+"audio/"+d+".ogg";k.play();k.volume=g.volumeInit?
1:0;a.attachListener(k,"ended",function(a){k.currentTime=0;"critical"===b&&(a=f.characterControl,a.characterParameters.health<a.characterParameters.maxHealth/2?this.play():(g.fn(g.initCritical),g.volumeInit&&g.setVolume("on")))});c&&(k.loop=!0);g.container[b]={audio:k,init:b,volume:!0}};(function(){for(var a in g.container)a!==b&&(g.container[a].volume=!1,g.container[a].audio.pause());g.container[b]?(a=g.container[b].audio,g.container[b].volume=!0,a.play()):f()})()};this.bgNormal=["bg-2","bg-3"];
this.bgStart=["bg-start","bg-start-2"];this.bgEnd=["bg-end"];this.bgEpic=["bg-epic"];this.bgCritical=["bg-critical"];this.randomAudio=function(b){for(var d=a.random(10,5),c=0;d--;)c=a.random(b.length-1,0);return b[c]};this.volumeInit=!0;this.setVolumeForAds=function(a){if(this.volumeInit)if("off"===a)for(var b in this.container)this.container[b].audio.volume=0;else for(b in this.container)this.container[b].volume&&(this.container[b].audio.volume=1)};this.setVolume=function(a){if("off"===a){for(var b in this.container)this.container[b].audio.volume=
0;this.volumeInit=!1}else{for(b in this.container)this.container[b].volume&&(this.container[b].audio.volume=1);this.volumeInit=!0}};this.fn=function(a){if(this.currentInit!==a)switch(this.currentInit=a,/epic|normal/i.test(this.currentInit)&&(this.initCritical=a),a){case "start":this.createAudio(a,this.randomAudio(this.bgStart),!0);break;case "normal":this.createAudio(a,this.randomAudio(this.bgNormal),!0);break;case "epic":this.createAudio(a,this.randomAudio(this.bgEpic),!0);break;case "critical":this.createAudio(a,
this.randomAudio(this.bgCritical),!1);break;case "end":this.createAudio(a,this.randomAudio(this.bgEnd),!1)}}};this.screenTransitionOnload=function(a){var b=m.assets.imgOnload,d=new t.utils,c=0,g=0,f=d.qs("loading-assets"),h=d.slice(f.getElementsByTagName("span")),k=function(a,b,c,g){this.renderVal=function(a,b,c){this.loop=function(a,b){for(var c=0;c<a.length;c++)"progress-val"===a[c].className?d.text(a[c],b+"%"):"progress-in"===a[c].className&&(a[c].style.width=b+"%")};"open"===a?this.loop(b,c):
this.loop(b,0)};"open"===a&&(f.style.display="block",this.renderVal(a,g,Math.floor(c/b*100)))};temp=[];for(var l=0;l<b.length;l++){var n="assets/2d/"+b[l],p=new Image;p.src=n;temp.push({src:n,img:p});g++;p.addEventListener("load",function(){c++})}var q=setInterval(function(){k("open",g,c,h);g===c&&(a(temp),clearInterval(q))},100)};this.screenTransition=function(b,d,c){if("download"===b){var g=a.staticAllMap.value[d];b=a.staticGeometry.storage.get(d);var f=a.staticGeometry.storageMap.get(d),h=m.assets.audio,
k=m.assets.img,l=function(b,d,c,g){this.renderVal=function(b,d,c){this.loop=function(b,d){for(var c=0;c<b.length;c++)"progress-val"===b[c].className?a.text(b[c],d+"%"):"progress-in"===b[c].className&&(b[c].style.width=d+"%")};"open"===b?this.loop(d,c):this.loop(d,0)};"open"===b?(a.loading.style.display="block",this.renderVal(b,g,Math.floor(c/d*100))):"close"===b&&(a.loading.style.display="none",this.renderVal(b,g))};dataNpcPair=function(){var a={len:0,current:0},b;for(b in g)if("content"===b)for(var d in g[b])if(/monster/i.test(d)){var c=
g[b][d].render.textures,f;for(f in c){var h=c[f],k;for(k in h){behaveRig=h[k];for(var l in behaveRig)a.len++,behaveRig[l].complete&&a.current++}}}return a};for(var n in g)if("textures"===n)for(var p in g[n])p in g[n]&&(d=g[n][p].src)&&(d=d.split("//").join("/"),img=new Image,img.src=d,a.globalImage.set(d,img));n=0;for(p=b;n<p.length;n++)d=p[n].render.src.split("//").join("/"),img=new Image,img.src=d,a.globalImage.set(d,img);n=0;for(p=f;n<p.length;n++)d=p[n].render.src.split("//").join("/"),img=new Image,
img.src=d,a.globalImage.set(d,img);n=0;for(p=k;n<p.length;n++)d=a.path+p[n].split("//").join("/"),img=new Image,img.src=d,a.globalImage.set(d,img);var v=h.length,q=0;n=0;for(p=h;n<p.length;n++)d=a.path+"audio/"+p[n],b=new Audio,b.src=d,a.transport({url:d,type:"GET",requestHeader:{"Content-Type":"audio/ogg"},callback:function(b,d){a.globalAudio.set(b,d);q++}.bind({},p[n],b)});n=a.qs("loading-assets");var r=a.slice(a.loading.getElementsByTagName("span"));a.removeClass(n,"hidden");var u=setInterval(function(){for(var b=
dataNpcPair(),d=a.globalImage.storage,g=d.length,f=0,h=0;h<g;h++)d[h].status.complete&&f++;d=g+v+b.len+a.svgCount.tot;b=f+q+b.current+a.svgCount.current;l("open",d,b,r);d===b&&(c(),a.globalObjectGUI.value.audioBackground.fn("normal"),clearInterval(u))},500)}};this.toggleButton=function(b){setTimeout(function(){var d=a.slice(a.qsAll("switch-control"));a.qs("bar-hp");a.qs("bar-mp");for(var c=a.characterParameters.value,g=0,f=d.length;g<f;g++){var h=d[g],k=a.getFirstChild(h),l=a.getFirstChild(k),n=a.sibling(k,
"next");k=function(b){b?(l.style.left="35px",a.text(n,"ON"),n.style.marginRight="-40px"):(l.style.left="0px",a.text(n,"OFF"),n.style.marginRight="-50px")};h=h.getAttribute("label");c.setting.effect?(l.style.left="35px",a.text(n,"ON"),n.style.marginRight="-40px"):(l.style.left="0px",a.text(n,"OFF"),a.objTranslate.value.effect=!1,n.style.marginRight="-50px");switch(h){case "performance":c.setting.effect?(a.objTranslate.value.effect=!0,k(!0)):(a.objTranslate.value.effect=!1,k(!1));break;case "volume-bg":k(a.globalObjectGUI.value.audioBackground.volumeInit);
break;case "volume-action":k(a.objTranslate.value.volume);break;case "tutorial-game":k("false"===localStorage.getItem("tutorial"))}}if(!b)for(g=0,f=d.length;g<f;g++)a.attachListener(d[g],"click",function(b){var d=b.getAttribute("label"),g=a.getFirstChild(b);b=a.getFirstChild(g);var f=g.getBoundingClientRect();g=a.sibling(g,"next");Math.abs(f.left-a.mousePosition.value.pos.mousedown.x)>f.width/2?(b.style.left=f.width/2-5+"px",a.text(g,"ON"),g.style.marginRight="-40px",b="right"):(b.style.left="0px",
a.text(g,"OFF"),g.style.marginRight="-50px",b="left");switch(d){case "performance":"right"===b?(a.objTranslate.value.effect=!0,c.setting.effect=!0):(a.objTranslate.value.effect=!1,c.setting.effect=!1);break;case "volume-bg":"right"===b?a.globalObjectGUI.value.audioBackground.setVolume("on"):a.globalObjectGUI.value.audioBackground.setVolume("off");break;case "volume-action":a.objTranslate.value.volume="right"===b;break;case "tutorial-game":localStorage.setItem("tutorial","right"!==b)}}.bind(this,d[g]))},
1E3)};this.dragBar=function(){var b=a.slice(a.qsAll("bar-control")),d="",c="",g="",f=!1,h="",k=function(){var b=a.mousePosition.value.pos.mousemove.x;if(b>d.left&&b<d.right){var f=Math.round(d.right)-Math.round(d.left);currentLength=Math.round(b)-Math.round(d.left);length=Math.round(100*currentLength/f)+1;q=a.characterParameters.value;g.style.width=0>length?0:length+"%";c.style.left=b-d.left+"px";"hp"===h?(b=q.maxHealth,q.setting.healthPercentage=length,q.maxHealthCure=Math.round(b*length/100)):(b=
q.maxMp,q.setting.mpPercentage=length,q.maxMpCure=Math.round(b*length/100))}},l=a.isMobile()?a.qs("tab-performance-mb"):a.controlContainer,n=a.qs("bar-hp"),p=a.qs("bar-mp"),q=a.characterParameters.value;q.setting||(q.setting={mpPercentage:100,healthPercentage:100,effect:!0});var m=q.setting.healthPercentage,P=q.setting.mpPercentage;n.style.width=q.setting.healthPercentage+"%";p.style.width=q.setting.mpPercentage+"%";q.maxHealthCure=Math.round(q.maxHealth*m/100);q.maxMpCure=Math.round(q.maxMp*P/100);
dragHpEl=a.getFirstChild(n);dragHpEl.style.left=n.getBoundingClientRect().width+"px";dragMpEll=a.getFirstChild(p);dragMpEll.style.left=p.getBoundingClientRect().width+"px";n=0;for(p=b.length;n<p;n++)a.attachListener(b[n],a.CursorStartEvent,function(a){if(!f){var b=a.querySelectorAll("div");d=a.getBoundingClientRect();c=b[b.length-1];g=b[0];h=/bar-hp/i.test(g.className)?"hp":"mp";f=!0;k()}}.bind(a,b[n]));a.attachListener(l,a.CursorMoveEvent,function(a){f&&k()});a.attachListener(l,a.CursorEndEvent,
function(a){f=!1})};this.scrollSlide=function(){var b=a.slice(a.qsAll("box-quest")),d={oldVal:0,newVal:0,moveVal:0,moveValInPercent:0,moveScroll:0,posY:0},c={firstLoad:!1,checkOverflow:function(a,b,d){d=0;for(var c=b.length;d<c;d++)b[d].getBoundingClientRect().bottom>a.bottom&&(b[d].style.display="none")},attachEvent:function(b,c){a.that(b).use("attachListener",[a.CursorMoveEvent,function(d,c,g,f){if(a.isScroll.value){for(var h=c.getElementsByTagName("li"),k=d.getBoundingClientRect(),l=0,n=h.length;l<
n;l++)h[l].style.display="block";var p=d.offsetHeight,q=c.offsetHeight+25;d=a.mousePosition.value.pos.mousemove;l=a.sibling(c,"next");var v={formulaImgScroll:function(a){return 3*Math.abs(a/2/100*q)},formulaCntScroll:function(a){return a/2/100*p*3},widthScrollFormula:function(){var a=0,b=0;if(!d)for(;b<q-p;){a++;b=v.formulaImgScroll(a);var d=v.formulaCntScroll(a)}return p-d}};if(a.isMobile()||a.detectLeftButton(f)){g.newVal=d.y;g.newVal>g.oldVal?0<=g.moveVal&&g.moveVal<=q&&g.moveValInPercent<q-p&&
Math.abs(g.moveVal++):0<=g.moveVal&&g.moveVal<=q&&Math.abs(g.moveVal--);if(0>g.moveVal||0>g.moveValInPercent)g.moveVal=0;g.oldVal=d.y;f=v.widthScrollFormula();g.moveValInPercent=v.formulaImgScroll(g.moveVal);n=v.formulaCntScroll(g.moveVal);g.posY||(g.posY=d.y);Math.abs(g.posY-d.y)&&(a.css(c,{transform:"0px,"+-g.moveValInPercent+"px,0px"}),a.css(l,{transform:"0px,"+n+"px,0px",height:f+"px",opacity:"0.5",transition:"opacity 0.5s linear"}),this.checkOverflow(k,h,b))}else q>p?(f=v.widthScrollFormula(),
a.css(l,{height:f+"px",opacity:"0.5",transition:"opacity 0.5s linear"})):q<p&&a.css(l,{transform:"0px,0px,0px"})}else c.setAttribute("style","")}.bind(this,b,c,d)]);a.attachListener(b,a.CursorEndEvent,function(b){a.sibling(b,"next").style.opacity=0;d.posY=0}.bind(this,c));a.attachListener(b,a.CursorLeaveEvent,function(b){a.sibling(b,"next").style.opacity=0}.bind(this,c))},fn:function(){for(var d=0,c=b.length;d<c;d++){var g=a.getFirstChild(b[d]),f=b[d].getBoundingClientRect(),h=g.getElementsByTagName("li");
this.checkOverflow(f,h);this.firstLoad||this.attachEvent(b[d],g)}this.firstLoad=!0}};c.fn();this.scrollSlideParams=c};this.textDialog=function(b){clearTimeout(a.activeDialog.value.timeout);clearInterval(a.activeDialog.value.interval);a.activeDialog.value.state=!1;var d=a.qs("body-dialog"),c=a.qs("left-dialog"),g=a.qs("right-dialog"),f="innerText"in d?"innerText":"textContent",h=0,k=function(b){b.avatarPosition&&(b.avatarPosition,a.qs("avatar-position").className="avatar-position "+b.avatarPosition+
" "+b.avatarBackground,a.text(a.qs("title-dialog"),b.avatarName),a.text(a.qs("count-dialog"),h+1+"  / "+a.activeDialog.value.dialogCnt.length))},l=function(){a.activeDialog.value.state||(a.activeDialog.value.timeout=setTimeout(function(){var b=a.activeDialog.value.dialogCnt,c=b[h];console.log(c);k(c);a.activeDialog.value.state=!0;var g=c.text.split(","),n=g[0].split(" "),p="";d[f]="";a.activeDialog.value.interval=setInterval(function(){n.length||p.length?""!==p&&p.length?a.text(d,'"'+d[f].split('"').join("")+
p.splice(0,1)+'"'):(p=n[0].split(""),a.text(d,d[f]+" "+p.splice(0,1)),n.splice(0,1)):g.length?(g.splice(0,1),g.length&&(n=g[0].split(" "),n.unshift(", "),a.text(a.qs("count-dialog"),h+1+"  / "+b.length))):(clearInterval(a.activeDialog.value.interval),a.activeDialog.value.state=!1,b.length-1>h&&(h++,l()))},50)},1E3))};a.activeDialog.value.dialogCnt=b;l();a.attachListener(c,"click",function(b){0<=h-1&&(h--,b=a.activeDialog.value.dialogCnt[h],k(b),a.text(d,b.text),clearTimeout(a.activeDialog.value.timeout),
clearInterval(a.activeDialog.value.interval))});a.attachListener(g,"click",function(b){h+1<=a.activeDialog.value.dialogCnt.length-1&&(h++,b=a.activeDialog.value.dialogCnt[h],k(b),a.text(d,b.text),clearTimeout(a.activeDialog.value.timeout),clearInterval(a.activeDialog.value.interval))})}};t.AIs=function(a){var c=this,f={intersectsPoly:function(a,d,c,f,g){var b,h=!1;var k=0;for(b=a-1;k<a;b=k++)c[k]>g!=c[b]>g&&f<(d[b]-d[k])*(g-c[k])/(c[b]-c[k])+d[k]&&(h=!h);return h},activeMapContent:"",shortestObject:function(a,
d){for(var b=d.position?d.position:d,f=[],g=[],l=0;l<a.length;l++){var p=a[l].position?a[l].position:a[l];p=Math.round(c.distanceAndAngleBetweenTwoPoints(b.x,b.y,p.x,p.y).distance);g.push({path:a[l],distance:p});f.push(p)}f=f.sort(function(a,b){return a-b});var n;a:for(n in f)for(var q in g){if("Object"===typeof f[n])continue a;f[n]===g[q].distance&&(f[n]=g[q].path)}return f}};this.AI={};this.AI.sortestEnemy=function(a,d,k){if(k){if(k.orderByDir)return a=f.shortestObject(a,{position:{x:0,y:0}}),c.random(1,
0)&&a||a.reverse()}else return f.shortestObject(a,d)};this.AI.attackBehaviour=function(a){"melee"!==a&&(this.rangeMovement=function(a){var b=this,d=a.object,g=a.targetDummy,f=d.position,p=g.position,n=a.distanceY,q=a.distY>=n.max&&a.distY<n.min,r=a.distX<a.distanceX&&-a.distanceX<a.distX;n=c.distanceAndAngleBetweenTwoPoints(f.x,f.y,p.x,p.y).distance;var v=function(){var a=b.dirSwitch.prior,d=c.random(b.dirSwitch.prior.length-1,0);a=a[d];b.dirSwitch.selectedFrame=a?a.selectedFrame:b.performAttackRandomBehaviour(b.attackFrame)},
u=this.dirSwitch.dirBlock.state;q=q&&r;r=10>Math.round(n);var m;if(m=q)!g.isSpotted&&r?(b.dirSwitch.reset(),b.dirSwitch.attackDelayPerFrame=b.dirSwitch.attackDelayPerFrameReplace,m=g.isSpotted=!0):m=g.isSpotted;q&&u&&(b.dirSwitch.dirBlock.reset(),b.dirSwitch.selectedFrame="",g.init=!0,m=this.dirSwitch.mainTurn=!0);0<a.dirSwitch.attackDelay&&(a.dirSwitch.attackDelay--,g.init=!0);if(m)return r&&(g.init=!0,this.dirSwitch.mainTurn=!0),""===b.dirSwitch.selectedFrame&&v(),{init:!0,x:0,y:0};this.dirSwitch.latestFrame&&
(v(),delete this.dirSwitch.latestFrame);if(0>=a.dirSwitch.attackDelay||this.dirSwitch.turn){if(u)return this.dirSwitch.dirBlock.fn();g.init||this.dirSwitch.turn?(q?(p=f.x,n=f.y):(p=c.random(a.distanceX-50,a.distanceX-250),n=c.random(0,-50),p=0<a.distX&&!this.dirSwitch.turn?a.target.position.x-p:a.target.position.x+p,n=a.target.position.y+n),v=this.dirSwitch.tempTarget,v.position={x:p,y:n},g.isSpotted=!1,v.init=!1,this.dirSwitch.turn&&(this.dirSwitch.turn=!1)):g.init||(this.objGlobalTranslate.update(p),
r&&(this.dirSwitch.tempTarget.init=!0));g=c.moveVector2dWithVelocity(d,g,a.speed);g.y=a.forceGravity?0:g.y;this.dirSwitch.forceAttackFrame?(g.x=0,g.y=0):c.Body.setPosition(d,{x:f.x+g.x,y:f.y+g.y});this.dirSwitch.mainTurn=!1;return{init:!1,x:g.x,y:g.y}}return{init:!1,x:0,y:0,distance:n}});"range"!==a&&(this.meleeMovement=function(a){var b=a.object,d=a.target,g=b.position,f=a.dirSwitch.targetDummyForMelee;f.position.x=d.position.x;f.position.y=d.position.y;d=f.position;g=c.distanceAndAngleBetweenTwoPoints(g.x,
g.y,d.x,d.y);0<a.dirSwitch.attackDelay&&a.dirSwitch.attackDelay--;if(this.attackTolerance())return""===this.dirSwitch.selectedFrame&&(a=this.dirSwitch.prior,b=this.dirSwitch.prior.length,f=c.random(b-1,0),g=a[f],this.dirSwitch.dirBlock.reset(),this.dirSwitch.selectedFrame=g?g.selectedFrame:this.performAttackRandomBehaviour(this.attackFrame),b&&(g.fn(),a.splice(f,1)),this.dirSwitch.attackDelayPerFrame=this.dirSwitch.attackDelayPerFrameReplace),{init:!0,x:0,y:0};if(0>=this.dirSwitch.attackDelay){if(this.dirSwitch.dirBlock.state)return this.dirSwitch.dirBlock.fn();
f=c.moveVector2dWithVelocity(b,f,a.speed);f.y=a.forceGravity?0:f.y;this.dirSwitch.forceAttackFrame?(f.x=0,f.y=0):c.Body.translate(b,{x:f.x,y:f.y});return{init:!1,x:f.x,y:f.y}}return{init:!1,x:0,y:0,distance:g.distance}});this.performAttackFrame=function(a,b){var d=this.dirSwitch;d.attackState=!1;if(a.init){b=this.attackFrame[b]?b:"normal";var g=this.object,f=this.attackFrame.fn(this,b),k=g.render,n=f.frame[d.frameCount],q=d.tickLengthPerFrame?d.tickFrame>d.tickLengthPerFrame[d.frameExtendCount+1]:
!1;if(0<d.attackDelayPerFrame)"idle"!==c[g.stateStorage].get(g.label)&&c[g.stateStorage].set(g.label,"idle"),d.attackDelayPerFrame--;else if(k.repeatAttack||q)(this.turn?"right"===this.turn:"right"===this.monsterDir())?this.changeRightFn(!0):this.changeLeftFn(!0),k.repeatAttack=!1,d.frameExtendCount++,d.tickLengthPerFrame||(d.tickLengthPerFrame={}),d.tickLengthPerFrame[d.frameExtendCount]=d.tickFrame+5,k=f.frameExtend,n=k[d.frameExtendCount],c[g.stateStorage].set(g.label,n?n:k[0]),d.forceAttackFrame&&
!d.resetWhenFrameEnd||!(d.prior.length||d.frameExtendCount>=f.frameExtend.length)||(d.reset(),d.attackDelayPerFrame=d.attackDelayPerFrameReplace,d.resetWhenFrameEnd=!1,this.attackFrame.state=!0,d.selectedFrame="",this.attackFrame[b].frameEnd=!0);else{if(0===d.tickFrame)(this.turn?"right"===this.turn:"right"===this.monsterDir())?(this.changeRightFn(!0),d.right=!0):(this.changeLeftFn(!0),d.left=!0),f.audioStart&&5<=c.random(5,1)&&g.visible&&c.playAudio(f.audioStart[d.frameCount]),d.attackDelay="undefined"!==
typeof this.initialAttackDelay?this.initialAttackDelay:c.random(40,25);else if(1===d.tickFrame)c[g.stateStorage].set(g.label,f.frameExtend[0]);else if(d.tickFrame===n){if(f.effect&&"function"===typeof f.effect[d.frameCount])f.effect[d.frameCount](this,c.objTranslate.value);f.audioEnd&&(k=f.audioEnd[d.frameCount],n=k instanceof Array?k.length:k,g.visible&&n&&c.playAudio(k));d.frameCount++;d.frameCount>=f.frame.length&&(d.frameCount=0);k=d.prior;if(k.length&&"long-range"===g.statParameters.attackType)for(g=
0;g<k.length;g++)k[g].selectedFrame===b&&(k[g].fn(),k.splice(g,1));d.attackState=!0}this.attackFrame[b].unique&&d.tickFrame>f.frame[f.frame.length-1]&&(d.latestFrame=b);d.tickFrame++}}else 2>=d.firstDirMove&&(1>d.firstDirMove?(this.turn?"right"===this.turn:"right"===this.monsterDir())?(this.changeRightFn(!0),d.right=!0):(this.changeLeftFn(!0),d.left=!0):2===d.firstDirMove&&(c[this.object.stateStorage].set(this.object.label,a.distance?"idle":d.approchingState),d.reset()),d.firstDirMove++);return d.attackState};
this.performAttackRandomBehaviour=function(a){var b=0,d,g={},f=function(a,d){for(var c in a)!a[c].unique&&100*Math.random()<=a[c].chance&&0>=a[c].delay&&(b++,g[c]=a[c],d&&d.call({},c))};f(a);var p=c.random(b,1);b=0;f(g,function(a){p===b&&(d=a)});return d}};this.AI.skillBehaviour=function(a,d){var b={operators:{"+":function(a,b,d){a[b]+=d},"-":function(a,b,d){a[b]-=d}},cloneOriginParams:function(a){a.originalParams||(a.originalParams={},c.extend(a.originalParams,a,!0))},gatherObjectFromParty:function(a,
b,d){var c=[],g=b.boss?b.boss.pions:b.object.pions instanceof Array?b.object.pions:[];d&&c.push(b.object);g.forEach(function(a){for(var b=!0,d=0;d<c.length;d++)if(c[d].label===a.label||a.deleted){b=!1;break}b&&c.push(a)});for(b=0;b<c.length;b++)a.push(c[b].rigBody.monsterParameters);c.length=0},forceSelectedFrame:function(a,b,d){a.dirSwitch.firstDirMove=3;a.dirSwitch.forceAttackFrame=!0;a.dirSwitch.selectedFrame=b;d&&c[a.object.stateStorage].set(a.object.label,d)},registerBuff:function(a,b,d){d=function(a){a&&
a.object.rigBody.buff.register({seletedBuff:b.buffSkill,paramsTarget:a,paramsAttacker:b})};if(a instanceof Array)for(var c=0;c<a.length;c++)d(a[c]);else d(a)},singleDmg:function(a,b,d){if(a&&d.isEnemyFn(a.object.label)){var g=c.random(b.damageMax,b.damageMin);d=d.object.statParameters;var f="long-range"===d.attackType,h=c.random(f?d.attackRangeMax:d.attackMax,f?d.attackRangeMin:d.attackMin);f=a.object;var l=f.rigBody,k=f.visible,u=0,m=!0;if("magic"===b.damageType){var C=c.random(a.magicDefenseMax,
a.magicDefenseMin);g=g+h-C}else C=c.random(a.defenseMax,a.defenseMin),g=g+h-C;h={criticalChanceMax:0,critical:0};b.criticalChanceMax&&(h.criticalChance=c.random(b.criticalChanceMax,b.criticalChanceMin));b.criticalMax&&(h.critical=c.random(b.criticalMax,b.criticalMin));h=l.abilityCritical(d,g,h);b=0<h;g+=h;h=l.attackerAbilities(f.statParameters);C=0;for(var A=h.length;C<A;C++)if("block"===h[C])c.playAudio("shiled-blocking"),k&&l.hitNumber.push(new c.hitNumber("block")),m=!1;else if("avoid"===h[C]){k&&
l.hitNumber.push(new c.hitNumber("miss"));m=!1;break}if(m){g=0<g?g:Math.round(c.random(100,50)/2);u=a.health-g;a.health?(k&&(b?l.hitNumber.push(new c.hitNumber(g,"critical")):((l.objTranslate.effect||l.isHero)&&l.hitNumber.push(new c.hitNumber(g)),l.healthBar&&(l.healthBar.tick=l.healthBar.tickUpdate))),0>u?u=a.health=0:(a.health-=g,u=g)):u=0;l.characterState||(a=d.object.label,d.object.label!==l.boss.label&&(l.partyRandomHelp.update(l),l.hitterNotTarget(a)),"attack"!==l.behave&&l.forceObjectToAttack(d.object,
!0));if(l.updateHpBar||l.cureSelf.gui)l.updateHpBar?l.updateHpBar():l.cureSelf.updateBar("hp-inner-line-bar");c.playAudio(["stab"]);1===c.random(3,1)&&c.hitEffect({object:f,parent:"",alpha:!0})}l.buff.register({seletedBuff:d.buffSkill,paramsTarget:l.monsterParameters,paramsAttacker:d});return u}return 0},areaDmg:function(a){var b=a.parent,d=a.propSkill;a=b.createAreaDamagePool({target:a.target,width:a.width,height:a.height,caster:b.object.label});if(a.length)for(var c=0;c<a.length;c++)this.singleDmg(a[c],
d,b);return a},damageBuff:function(a,b){var g=c.random(a.damageMax,a.damageMin),f=c.random(b.paramsTarget.magicDefenseMax,b.paramsTarget.magicDefenseMax);g-=f;g=0<g?g:Math.round(c.random(100,50)/2);tempHealth=b.paramsTarget.health-g;objTarget=b.paramsTarget.object;d=objTarget.rigBody;returnDamage=0;if(b.paramsTarget.health){if(d.updateHpBar||d.cureSelf.gui)d.updateHpBar?d.updateHpBar():d.cureSelf.updateBar("hp-inner-line-bar");objTarget.visible&&d.hitNumber.push(new c.hitNumber(g));0>tempHealth?returnDamage=
b.paramsTarget.health=0:(b.paramsTarget.health-=g,returnDamage=g)}else returnDamage=0;return returnDamage},buffModifierAbilities:function(a){var b=a.modifierInitial,d=a.buff,f=d.paramsTarget,h=a.propSkill,k=a.op;if("register"===a.initial)switch(b){case "block":d[b]=c.random(h.blockMax,h.blockMin);break;case "avoid":d[b]=c.random(h.avoidMax,h.avoidMin);break;case "critical":d[b]=c.random(h.criticalMax,h.criticalMin);break;case "criticalChance":d[b]=c.random(h.criticalChanceMax,h.criticalChanceMin)}f.modifierAbilities||
(f.modifierAbilities={});f.modifierAbilities[b]||(a={},a[b]=0,c.extend(f.modifierAbilities,a,!0));this.operators[k](f.modifierAbilities,b,d[b])},buffSpeedPlusChara:function(a,b,d){"register"===d?(b.rigBodyTarget=b.paramsTarget.object.rigBody,b.paramsTarget.mainCharacter?(b.rigBodyTarget.originX||(b.rigBodyTarget.originX=b.rigBodyTarget.moveReplaceX,b.rigBodyTarget.originY=b.rigBodyTarget.moveReplaceY),b.reduceMovementX=b.rigBodyTarget.originX-b.rigBodyTarget.originX*a.reduceMovement,b.reduceMovementY=
b.rigBodyTarget.originY-b.rigBodyTarget.originY*a.reduceMovement,b.rigBodyTarget.moveReplaceY=b.reduceMovementX,b.rigBodyTarget.moveReplaceX=b.reduceMovementY,b.rigBodyTarget.moveStaticX=b.reduceMovementX,b.rigBodyTarget.moveStaticY=b.reduceMovementY,b.rigBodyTarget.moveSpeed=0<=b.rigBodyTarget.moveSpeed?b.reduceMovementX:-b.reduceMovementX,b.rigBodyAI=b.rigBodyTarget.rigBodyAI.rigBody,b.label=b.paramsTarget.object.label):(b.rigBodyTarget.originSpeedAttack||(b.rigBodyTarget.originSpeedAttack=b.rigBodyTarget.moveSpeedAttack,
b.rigBodyTarget.originSpeedNormal=b.rigBodyTarget.moveSpeedNormal),b.reduceSpeedAttack=b.rigBodyTarget.originSpeedAttack-b.rigBodyTarget.originSpeedAttack*a.reduceMovement,b.reduceSpeedNormal=b.rigBodyTarget.originSpeedNormal-b.rigBodyTarget.originSpeedNormal*a.reduceMovement,b.rigBodyTarget.moveSpeedAttack=b.reduceSpeedAttack,b.rigBodyTarget.moveSpeedNormal=b.reduceSpeedNormal,b.rigBodyTarget.moveSpeed=0<=b.rigBodyTarget.moveSpeed?b.reduceSpeedAttack:-b.reduceSpeedAttack)):b.rigBodyTarget.originX?
(d=a=b.rigBodyTarget.originX)&&d&&(b.label===b.rigBodyTarget.object.label?(b.rigBodyTarget.moveReplaceY=a,b.rigBodyTarget.moveReplaceX=d,b.rigBodyTarget.moveStaticX=a,b.rigBodyTarget.moveStaticY=d,b.rigBodyTarget.moveSpeed=0<=b.rigBodyTarget.moveSpeed?a:-a):(b.rigBodyAI.moveSpeedAttack=a,b.rigBodyAI.moveSpeedNormal=a,b.rigBodyAI.moveSpeed=0<=b.rigBodyAI.moveSpeed?a:-a)):(a=b.rigBodyTarget.originSpeedAttack,d=b.rigBodyTarget.originSpeedNormal,a&&d&&(b.rigBodyTarget.moveSpeedAttack=a,b.rigBodyTarget.moveSpeedNormal=
d,b.rigBodyTarget.moveSpeed=0<=b.rigBodyTarget.moveSpeed?a:-a,b.rigBodyTarget.rigState||(b=c.characterControl,b.moveReplaceX=a,b.moveReplaceY=a-.222*a,b.moveStaticX=a,b.moveStaticY=a-.222*a,b.moveSpeed=0<=b.moveSpeed?a:-a)))},buffSpeed:function(a,b,d){var c=b.paramsTarget.object.rigBody;"register"===d?(b.tempSpeedAttack=c.moveSpeedAttack,b.tempSpeedNormal=c.moveSpeedNormal,c.moveSpeedAttack=a.speedIncrease,c.moveSpeedNormal=a.speedIncrease,c.moveSpeed=0<=c.moveSpeed?a.speedIncrease:-a.speedIncrease):
(c.moveSpeedAttack=b.tempSpeedAttack,c.moveSpeedNormal=b.tempSpeedNormal,c.moveSpeed=0<=c.moveSpeed?b.tempSpeedAttack:-b.tempSpeedAttack)},buffAttack:function(a,b,d,f){this.cloneOriginParams(b.paramsTarget);f=b.paramsTarget.originalParams;"register"===d?(d=c.random(a.damageIncreaseMax,a.damageIncreaseMin),a=f.attackMax*d/100,f=f.attackMin*d/100,b.paramsTarget.attackMax+=a,b.paramsTarget.attackMin+=f,b.attackMax=a,b.attackMin=f):(b.paramsTarget.attackMax-=b.attackMax,b.paramsTarget.attackMin-=b.attackMin)},
buffDefenseVitallity:function(a,b,d,c){this.cloneOriginParams(b.paramsTarget);var g=b.paramsTarget.originalParams;"register"===d?(d=g.defenseMax*a.defenseRateMax/100,a=g.defenseMin*a.defenseRateMin/100,this.operators[c](b.paramsTarget,"defenseMax",d),this.operators[c](b.paramsTarget,"defenseMin",a),b.defenseMax=d,b.defenseMin=a):(this.operators[c](b.paramsTarget,"defenseMax",b.defenseMax),this.operators[c](b.paramsTarget,"defenseMin",b.defenseMin))},buffDefenseMagic:function(a,b,d,c){this.cloneOriginParams(b.paramsTarget);
"register"===d?(d=b.paramsTarget.magicDefenseMax*a.defenseRateMax/100,a=b.paramsTarget.magicDefenseMin*a.defenseRateMin/100,this.operators[c](b.paramsTarget,"magicDefenseMax",d),this.operators[c](b.paramsTarget,"magicDefenseMin",a),b.magicDefenseMax=d,b.magicDefenseMin=a):(this.operators[c](b.paramsTarget,"magicDefenseMax",b.magicDefenseMax),this.operators[c](b.paramsTarget,"magicDefenseMin",b.magicDefenseMin))}};if(a){if(a.throwBoom||a.character)this.throwBoom=function(a,d){this.boomType=d.triggerName;
this.parent=a;this.name="throwBoom";this.buffName="";this.selectedSkillFrame=/hero/i.test(this.parent.object.label)?"throwBoom":"attack";this.throwLife=15;this.explodeLife=14;this.initExplode=!1;this.particlePositions=[];this.needExplode="explosionNormalBoom"===this.boomType?!1:!0;this.update=function(a){if(this.initExplode){if(this.draw())if(this.explodeLife)a=this.particlePositions,a.length&&0===this.explodeLife%2&&(a=a.pop(),c.playAudio("explosion"),c.glowEffect({object:a,urlInner:"red-ring-cyrcle.png",
parent:"",alpha:!0,life:15,isShake:4<this.explodeLife,scaleSpeed:3,opacityLoss:.08,bind:!1}),b.areaDmg({target:a,parent:this.parent,width:200,height:300,propSkill:d})),this.explodeLife--;else return this.buffReg&&delete this.buffReg[this.buffName],!0}else if(this.throwLife)15===this.throwLife?(this.parent.object.visible&&c.playAudio("throw"),(this.parent.turn?"right"===this.parent.turn:"right"===this.parent.monsterDir())?this.parent.changeRightFn(!0):this.parent.changeLeftFn(!0)):10===this.throwLife?
this.parent.trajectoryInit.createSkillTrajectory({parent:this.parent,callback:function(a){var g=d.buffName,f=this.parent.object.statParameters.buffSkill;!f[g]&&g&&(f[g]=new c.items.value.buffSkills[g],/redBoom/i.test(this.boomType)?(f[g].chance=50,f[g].callbackStart=function(a){b.damageBuff(d,a)},f[g].icon="burningEffectSmall.png"):/blueBoom/i.test(this.boomType)&&(f[g].chance=c.random(d.stunMax,d.stunMin),f[g].callbackStart=function(a){if(!a.register){var b=a.paramsTarget,d=b.object.rigBody;d.hitNumber.push(new c.hitNumber("stun"));
a.register=!0;d.stunEffect.fn("long",b.object)}},f[g].callbackEnd=function(a){},f[g].icon="blue-boom-small.png"),this.buffReg=f,this.buffName=g);this.needExplode?(this.initExplode=!0,c.extend(this,new c.createExplosiveParticle(a,30),!0)):(c.explosiveA({object:a,parent:"",alpha:!0}),c.playAudio("explosion"),b.areaDmg({target:a,parent:this.parent,width:200,height:300,propSkill:d}),this.buffReg&&delete this.buffReg[this.buffName])}.bind(this)}):1===this.throwLife?(a.dirSwitch.reset(),a.dirSwitch.selectedFrame=
"normal"):b.forceSelectedFrame(a,"throwBoom",this.selectedSkillFrame),this.throwLife&&this.throwLife--;else if(!this.needExplode&&!this.throwLife)return!0}};if(a.arrowRain||a.character)this.arrowRain=function(a,d){this.rainNum=15;c.extend(this,new c.createArrowRainParticle(a,this.rainNum),!0);this.parent="";this.update=function(a){this.parent=a;a=this.particlesEnd;for(var c=0;c<a.length;c++){var g=a[c].position;b.areaDmg({target:{position:{x:g.x,y:g.y}},parent:this.parent,width:100,height:150,propSkill:d});
a.splice(c,1)}return this.draw()}};if(a.powerAgility||a.powerAgilityII||a.powerAgilityIII)this.powerAgility=function(a,d){this.parent=a;this.object=a.object;this.buffName=d.name;this.life=15;this.object.visible&&c.playAudio("Scary impact");this.update=function(a){if(15===this.life){a=this.parent.object.statParameters;var g=a.buffSkill;g[this.buffName]||(g[this.buffName]=new c.items.value.buffSkills[this.buffName],g[this.buffName].icon=d.icon,g[this.buffName].castedToAlly=!0,g[this.buffName].callbackStart=
function(a){a.isRegisted||(b.buffDefenseMagic(d,a,"register","+"),b.buffModifierAbilities({modifierInitial:"avoid",initial:"register",buff:a,propSkill:d,op:"+"}),b.buffModifierAbilities({modifierInitial:"critical",initial:"register",buff:a,propSkill:d,op:"+"}),b.buffModifierAbilities({modifierInitial:"criticalChance",initial:"register",buff:a,propSkill:d,op:"+"}),a.isRegisted=!0)},g[this.buffName].callbackEnd=function(a){a.isRegisted&&(b.buffDefenseMagic(d,a,"unregister","-"),b.buffModifierAbilities({modifierInitial:"avoid",
initial:"unregister",buff:a,propSkill:d,op:"-"}),b.buffModifierAbilities({modifierInitial:"critical",initial:"unregister",buff:a,propSkill:d,op:"-"}),b.buffModifierAbilities({modifierInitial:"criticalChance",initial:"unregister",buff:a,propSkill:d,op:"-"}))},b.registerBuff(a,a,this.buffName),delete g[this.buffName]);c.explosiveA({object:this.object,parent:"",alpha:!0,isShake:!1})}if(this.life)b.forceSelectedFrame(this.parent,d.name,"idle"),this.life--;else return this.parent.dirSwitch.reset(),this.parent.dirSwitch.selectedFrame=
"normal",!0}};if(a.powerDefenese||a.powerDefeneseII||a.powerDefeneseIII)this.powerDefenese=function(a,d){this.parent=a;this.object=a.object;this.buffName=d.name;this.life=30;this.object.visible&&c.playAudio("Scary impact");this.update=function(a){if(15===this.life){a=this.parent.object.statParameters;var g=a.buffSkill;g[this.buffName]||(g[this.buffName]=new c.items.value.buffSkills[this.buffName],g[this.buffName].icon=d.icon,g[this.buffName].castedToAlly=!0,g[this.buffName].callbackStart=function(a){a.isRegisted||
(b.buffDefenseVitallity(d,a,"register","+"),b.buffModifierAbilities({modifierInitial:"block",initial:"register",buff:a,propSkill:d,op:"+"}),b.buffModifierAbilities({modifierInitial:"critical",initial:"register",buff:a,propSkill:d,op:"+"}),b.buffModifierAbilities({modifierInitial:"criticalChance",initial:"register",buff:a,propSkill:d,op:"+"}),a.isRegisted=!0)},g[this.buffName].callbackEnd=function(a){a.isRegisted&&(b.buffDefenseVitallity(d,a,"unregister","-"),b.buffModifierAbilities({modifierInitial:"block",
initial:"unregister",buff:a,propSkill:d,op:"-"}),b.buffModifierAbilities({modifierInitial:"critical",initial:"unregister",buff:a,propSkill:d,op:"-"}),b.buffModifierAbilities({modifierInitial:"criticalChance",initial:"unregister",buff:a,propSkill:d,op:"-"}))},b.registerBuff(a,a,this.buffName),delete g[this.buffName]);c.explosiveA({object:this.object,parent:"",alpha:!0,isShake:!1})}if(this.life)b.forceSelectedFrame(this.parent,this.buffName),this.life--;else return this.parent.dirSwitch.reset(),this.parent.dirSwitch.selectedFrame=
"normal",!0}};a.teleport&&(this.teleport=function(a,d){this.parent=a;this.object=a.object;this.target=a.character;this.opacity=1;this.spawnPos=function(){var a=c.random(1,0)?-50:50;return{x:this.target.position.x+a,y:this.target.position.y}};this.object.visible&&c.playAudio("evil-swish");this.update=function(a){if(!this.spawnInit&&0<this.opacity)b.forceSelectedFrame(this.parent,d.frameStart,d.frameSkillStart),this.opacity-=d.opacityStart,this.object.opacity=this.opacity;else if(this.spawnInit||(this.object.opacity=
this.opacity=0,c.Body.setPosition(this.object,this.spawnPos()),this.spawnInit=!0,a.dirSwitch.reset(),a.dirSwitch.selectedFrame="normal"),1>this.opacity)this.opacity+=d.opacityEnd,this.object.opacity=this.opacity;else return this.object.opacity=1,this.target.opacity=1,!0}});a.mindControl&&(this.mindControl=function(a,d){this.parent=a;this.object=a.object;this.buffName="mindControl";this.objectControl=[];this.objectGlowParticle=[];this.life=30;this.object.visible&&c.playAudio(["teleport-swish"]);this.update=
function(a){if(15===this.life){var g=this.parent.object.statParameters,f=g.buffSkill;b.gatherObjectFromParty(this.objectControl,this.parent,!1);f[this.buffName]||(f[this.buffName]=new c.items.value.buffSkills[this.buffName],f[this.buffName].icon="mind-control-small.png",f[this.buffName].castedToAlly=!0,f[this.buffName].callbackStart=function(b){for(var d=!1,c=0;c<b.affected.length;c++)if("intimidation"===b.affected[c].skill.toLowerCase()){d=!0;break}!d&&b.paramsTarget.object.rigBody.forceObjectToAttack(a.character)},
b.registerBuff(this.objectControl,g,this.buffName));c.explosiveA({object:this.object,parent:"",alpha:!0,isShake:!1});this.objectControl.forEach(function(a){this.objectGlowParticle.push(c.extend({},new c.createGlowParticle(a.object,d.life,10,"purple-cycrle-ring.png",!0),!0))}.bind(this));this.objectControl.length=0}this.life&&(b.forceSelectedFrame(this.parent,"mindControl","skill"),1===this.life&&(this.parent.dirSwitch.reset(),this.parent.dirSwitch.selectedFrame="normal"),this.life--);if(15>this.life)if(g=
this.objectGlowParticle,g.length)for(f=0;f<g.length;f++)g[f].draw()&&g.splice(f,1);else return!0}});a.beresekYeti&&(this.bereseker=function(a,d){var g={shield:c.path+"red-ring.png",innerShield:c.path+"beresek-shield.png"};this.parent=a;this.buffProp=new c.items.value.buffSkills.bereseker;this.object=a.object;c.extend(this,new c.createShieldParticle(this.object,this.buffProp.tick,g,30),!0);this.lifeSkill=30;this.update=function(a){if(!this.beresekInstall){this.parent.dirSwitch.approchingState="run";
this.object.visible&&c.playAudio("evil-crack");c.explosiveA({object:this.object,parent:"",alpha:!0,isShake:!1});var g=this.object.statParameters,f=g.buffSkill;f.bereseker||(f.bereseker=this.buffProp,f.bereseker.icon="beresek-small.png",f.bereseker.castedToAlly=!0,f.bereseker.callbackStart=function(a){a.isRegisted||(b.buffSpeed(d,a,"register"),b.buffAttack(d,a,"register"),a.isRegisted=!0)}.bind(this),f.bereseker.callbackEnd=function(a){a.isRegisted&&(b.buffSpeed(d,a,"unregister"),b.buffAttack(d,a,
"unregister"))}.bind(this),b.registerBuff(g,g,"bereseker"),delete f.bereseker);this.beresekInstall=!0}0<this.lifeSkill?(b.forceSelectedFrame(a,"beresekYeti","skill"),this.lifeSkill--):0===this.lifeSkill&&(this.parent.dirSwitch.reset(),this.parent.dirSwitch.selectedFrame="normal",this.lifeSkill--);if(this.draw())return this.parent.dirSwitch.reset(),this.parent.dirSwitch.selectedFrame="normal",this.parent.dirSwitch.approchingState="walk",!0}});a.healing&&(this.healing=function(a,d){this.parent=a;this.object=
a.object;this.life=30;this.update=function(a){b.forceSelectedFrame(a,d.name,"skill");if(15===this.life)this.object.visible&&c.playAudio(["healing"]),c.glowEffect({object:this.object,parent:"",alpha:!0,life:25,scaleSpeed:4});else if(14>this.life){var g=this.parent.object.statParameters,f=g.buffSkill;f.healing||(f.healing=new c.items.value.buffSkills.healing,f.healing.castedToAlly=!0,f.healing.callbackStart=function(a){var b=c.random(d.healthIncreaseMax,d.healthIncreaseMin);if(a.paramsTarget.health+
b<a.paramsTarget.maxHealth){a.paramsTarget.object.visible&&c.playAudio("heartbeat-1");var g=a.paramsTarget.object;g.visible&&g.rigBody.hitNumber.push(new c.hitNumber(b,"heal"));a.paramsTarget.health+=b}else a.paramsTarget.health=a.paramsTarget.maxHealth},b.registerBuff(g,g,"healing"),delete f.healing)}if(this.life)this.life--;else return a.dirSwitch.reset(),a.dirSwitch.selectedFrame="normal",!0}});a.massHealing&&(this.massHealing=function(a,d){this.parent=a;this.object=a.object;this.objectHeal=[];
this.life=30;this.update=function(a){b.forceSelectedFrame(a,d.name,"skill");if(15===this.life){this.object.visible&&c.playAudio("healspell2");b.gatherObjectFromParty(this.objectHeal,this.parent,!0);for(var g=0,f=this.objectHeal;g<f.length;g++)c.glowEffect({object:f[g].object,parent:"",alpha:!0,life:25,scaleSpeed:4})}else 14>this.life&&(g=this.parent.object.statParameters,f=g.buffSkill,f.massHealing||(f.massHealing=new c.items.value.buffSkills.massHealing,f.massHealing.castedToAlly=!0,f.massHealing.callbackStart=
function(a){var b=c.random(d.healthIncreaseMax,d.healthIncreaseMin);if(a.paramsTarget.health+b<a.paramsTarget.maxHealth){a.paramsTarget.object.visible&&c.playAudio("heartbeat-1");var g=a.paramsTarget.object;g.visible&&g.rigBody.hitNumber.push(new c.hitNumber(b,"heal"));a.paramsTarget.health+=b}else a.paramsTarget.health=a.paramsTarget.maxHealth},b.registerBuff(this.objectHeal,g,"massHealing"),delete f.massHealing));if(this.life)this.life--;else return a.dirSwitch.reset(),a.dirSwitch.selectedFrame=
"normal",!0}});a.earthQuake&&(this.earthQuake=function(a,d){this.parent=a;this.object=a.object;this.life=64;this.update=function(){b.forceSelectedFrame(a,"earthQuake","attack");0===this.life%13&&(this.object.visible&&c.playAudio("explosion"),b.areaDmg({target:this.object,parent:this.parent,width:300,height:250,propSkill:d}),c.explosiveA({object:this.object,parent:"",alpha:!0,isShake:!0,shakeNum:1}),a.dirSwitch.reset());if(this.life)this.life--;else return a.dirSwitch.reset(),a.dirSwitch.selectedFrame=
"normal",!0}});a.earthShake&&(this.earthShake=function(a,d){this.parent=a;this.object=a.object;this.life=40;this.scaleSpeed=5;this.update=function(a){b.forceSelectedFrame(a,"earthShake","attackB");13>=this.life&&5<=this.life&&0===this.life%3&&(this.object.visible&&c.playAudio("explosion"),b.areaDmg({target:this.object,parent:this.parent,width:300,height:250,propSkill:d}),c.objTranslate.value.isShake.createShake(1),c.glowEffect({object:this.object,parent:"",alpha:!0,life:3,scaleSpeed:this.scaleSpeed--,
urlInner:"grey-cycrle.png",opacityLoss:.05}));if(this.life)this.life--;else return a.dirSwitch.reset(),a.dirSwitch.selectedFrame="normal",!0}});if(a.defenseSteal||a.abilitiesSteal)this[a.defenseSteal?"defenseSteal":"abilitiesSteal"]=function(a,d){this.parent=a;this.object=a.object;this.target=a.character;this.buffName=d.name;this.life=d.life;this.object.visible&&c.playAudio(["phazed-bang"]);this.update=function(a){b.forceSelectedFrame(a,this.buffName,"attack");if(5===this.life){(this.parent.turn?
"right"===this.parent.turn:"right"===this.parent.monsterDir())?this.parent.changeRightFn(!0):this.parent.changeLeftFn(!0);c.glowEffect({object:this.object,parent:"",alpha:!0,life:10,scaleSpeed:3,urlInner:"black-cycrle.png"});c.glowEffect({object:this.target,parent:"",alpha:!0,life:d.life,scaleSpeed:3,urlInner:"black-cycrle.png"});var g=this.parent.object.statParameters,f=g.buffSkill;f[this.buffName]||(f[this.buffName]=new c.items.value.buffSkills[this.buffName],f[this.buffName].icon=d.icon,f[this.buffName].callbackStart=
function(a){a.isRegisted||("defenseSteal"===this.buffName?(b.buffDefenseVitallity(d,a,"register","-"),b.buffDefenseMagic(d,a,"register","-")):"abilitiesSteal"===this.buffName&&(b.buffModifierAbilities({modifierInitial:"avoid",initial:"register",buff:a,propSkill:d,op:"-"}),b.buffModifierAbilities({modifierInitial:"block",initial:"register",buff:a,propSkill:d,op:"-"})),a.isRegisted=!0)}.bind(this),f[this.buffName].callbackEnd=function(a){a.isRegisted&&("defenseSteal"===this.buffName?(b.buffDefenseVitallity(d,
a,"unregister","+"),b.buffDefenseMagic(d,a,"unregister","+")):"abilitiesSteal"===this.buffName&&(b.buffModifierAbilities({modifierInitial:"avoid",initial:"unregister",buff:a,propSkill:d,op:"+"}),b.buffModifierAbilities({modifierInitial:"block",initial:"unregister",buff:a,propSkill:d,op:"+"})))}.bind(this),b.registerBuff(this.target.statParameters,g,this.buffName),delete f[this.buffName])}if(this.life)this.life--;else return a.dirSwitch.reset(),a.dirSwitch.selectedFrame="normal",!0}};a.bodyCharge&&
(this.bodyCharge=function(a,d){this.parent=a;this.object=a.object;this.target=a.character;this.speed=5;this.life=50;this.vec="";this.update=function(a){if(this.install)if(b.forceSelectedFrame(a,"bodyCharge"),this.life)0===this.life%5&&(this.object.visible&&c.playAudio(["swing","swing2","swing3"]),b.areaDmg({target:this.object,parent:this.parent,width:200,height:150,propSkill:d})),c.Body.setPosition(this.object,{x:this.object.position.x+this.vec.x,y:this.object.position.y+this.vec.y}),this.life--;
else return a.dirSwitch.reset(),a.dirSwitch.selectedFrame="normal",!0;else this.vec=c.moveVector2dWithVelocity(this.object,this.target,this.speed),this.install=!0}});a.growHowl&&(this.growHowl=function(a,d){this.parent=a;this.object=a.object;this.buffName="growHowl";this.life=30;this.object.visible&&c.playAudio(["evil-crack"]);this.update=function(a){if(20===this.life){c.explosiveA({object:this.object,parent:"",alpha:!1,isShake:!1});var g=this.parent.createAreaDamagePool({target:this.parent.object,
width:500,height:500,caster:this.parent.object.label}),f=this.parent.object.statParameters,h=f.buffSkill;h.growHowl||(h.growHowl=new c.items.value.buffSkills[this.buffName],h.growHowl.castedToAlly=!0,h.growHowl.icon="grow-howl-small.png",h.growHowl.callbackStart=function(a){a.isRegisted||(b.buffAttack(d,a,"register"),a.isRegisted=!0)},h.growHowl.callbackEnd=function(a){a.isRegisted&&b.buffAttack(d,a,"unregister")},b.registerBuff(g,f,this.buffName),b.registerBuff(f,f,this.buffName),delete h[this.buffName])}b.forceSelectedFrame(a,
this.buffName,this.buffName);if(this.life)this.life--;else return a.dirSwitch.reset(),a.dirSwitch.selectedFrame="normal",!0}});if(a.summoning||a.golemSummoner||a.sekletonSummoner)this.summoning=function(a,d,f){this.parent=a;this.target=d;this.spawnTick=f.spawnTick;this.skillTick=30;this.selectedSkillFrame=(this.isBeastArmor=/beastArmor/i.test(this.parent.object.label))?"growHowl":f.selectedSkillFrame;this.update=function(){if(this.installParent){var a=f.initialParams.objPawns;this.spawnTick&&(a.forEach(function(a){b.forceSelectedFrame(a.rigBody,
"summon","summon")}.bind(this)),1===this.spawnTick&&a.forEach(function(a){a.rigBody.behaveRandomFn(1)}),this.spawnTick--);this.skillTick?(b.forceSelectedFrame(this.parent,f.name,this.selectedSkillFrame),this.skillTick--):this.resetFrame||(this.parent.dirSwitch.reset(),this.parent.dirSwitch.selectedFrame="normal",this.resetFrame=!0);if(this.draw())return a.forEach(function(a){a.rigBody.forceObjectToAttack(this.target);a.rigBody.dirSwitch.reset();a.rigBody.dirSwitch.selectedFrame="normal"}.bind(this)),
a.length=0,!0}else a=f.initialParams,this.parent.object.visible&&c.playAudio("spawn"),a.aIParent=this.parent.initialSpawn,a.spawn.x=this.target.position.x+c.random(250,-250),a.spawn.y=this.target.position.y+c.random(100,-100),a.objBoss=this.parent.object,a.visible=!0,a.objPawns=[],c.monsterControl.createAINpc(a),c.orderObjectFn.value(),c.extend(this,new c.createGlowParticle(f.initialParams,f.life),!0),a.objPawns.forEach(function(a){a.rigBody.forceObjectToAttack(this.target)}.bind(this)),c.glowEffect({object:this.parent.object,
parent:"",alpha:!1,life:25,scaleSpeed:4}),this.installParent=!0}};if(a.createBlue||a.createRed)this[a.createBlue?"createBlue":"createRed"]=function(a,b){c.extend(this,new c.createBlueParticle(a.object,b.tick,{x:0,y:-170},b.particleParams),!0);this.parent=a;this.name=b.name;this.update=function(a){this.parent=a;a=this.draw();if(a.hit){if(this.targetEnd){var b=0;for(var d=this.parent.createAreaDamagePool({target:this.targetEnd,width:300,height:300,caster:this.parent.object.label});b<d.length;b++)this.parent.characterDamagePool({objectAttacker:this.parent.object,
objectTarget:d[b].object});b="random"}else b="nearest";this.targetEnd=this.parent.AISelectTarget(800,400,b)}return a.life}};if(a.piercingSpear||a.piercingSpeed||a.piercingSword)this.piercingObject=function(a,d){this.parent=a;this.object=a.object;this.target=a.character;this.install=!1;this.speed=d.speed;this.life=20;this.update=function(a){if(this.install)if(b.forceSelectedFrame(a,d.uniqueFrame,d.selectedFrame),14<this.life)this.life--;else if(11<this.life)c.Body.setPosition(this.object,{x:this.object.position.x+
this.vec.x,y:this.object.position.y+this.vec.y}),this.life--;else if(9===this.life)this.object.visible&&c.playAudio(["hitfreeze"]),b.singleDmg(this.target.statParameters,d,this.parent),this.life--;else if(this.life)this.life--;else return a.dirSwitch.reset(),a.dirSwitch.selectedFrame="normal",!0;else this.install=!0,this.vec=c.moveVector2dWithVelocity(this.object,this.target,this.speed),a.dirSwitch.reset()}};a.bindingRoot&&(this.bindingRoot=function(a,d,f){this.parent=a;this.object=this.parent.object;
this.target=d.statParameters;this.buffName="bindingRoot";this.life=20;this.object.visible&&c.playAudio(["teleport-swish"]);this.update=function(a){var d=/human/i.test(this.object.label)?"bindingRoot":"attackB";b.forceSelectedFrame(a,"bindingRoot",d);if(5===this.life){(this.parent.turn?"right"===this.parent.turn:"right"===this.parent.monsterDir())?this.parent.changeRightFn(!0):this.parent.changeLeftFn(!0);c.explosiveA({object:this.object,parent:"",alpha:!0,isShake:!1});d=this.parent.object.statParameters;
var g=d.buffSkill;g.bindingRoot||(g.bindingRoot=new c.items.value.buffSkills[this.buffName],g.bindingRoot.icon="binding-root-small.png",g.bindingRoot.callbackStart=function(a){a.isRegisted||(b.buffSpeedPlusChara(f,a,"register"),a.isRegisted=!0)},g.bindingRoot.callbackEnd=function(a){a.isRegisted&&b.buffSpeedPlusChara(f,a,"unregister")},b.registerBuff(this.target,d,this.buffName),delete g.bindingRoot)}if(this.life)this.life--;else return a.dirSwitch.reset(),a.dirSwitch.selectedFrame="normal",!0}});
a.bloodDrain&&(this.bloodDrain=function(a,d){c.extend(this,new c.createShieldParticle(a,d.tick,{shield:c.path+"red-ring.png",innerShield:c.path+"blood-drain.png"},55),!0);this.parent=a.rigBody;tickUpdate=100;this.buffName="bloodDrain";this.tick=0;this.parent.object.visible&&c.playAudio("evil-crack");this.updateBloodDrain=function(){var a=this.parent.createAreaDamagePool({target:this.parent.object,width:500,height:500,caster:this.parent.object.label}),g=this.parent.object.statParameters,f=g.buffSkill;
f.bloodDrain||(f.bloodDrain=new c.items.value.buffSkills.bloodDrain,f.bloodDrain.icon="bloodDrainSmall.png",f.bloodDrain.callbackStart=function(a){var c=Math.round(b.damageBuff(d,a)*(d.healthConvertion/100));a.paramsAttacker.health+c<a.paramsAttacker.maxHealth&&(a.paramsAttacker.health+=c)});b.registerBuff(a,g,this.buffName)};this.update=function(a){this.parent=a;this.tick?this.tick--:(this.tick=tickUpdate,this.updateBloodDrain());return this.draw()}});if(a.intimidation||a.character)this.intimidation=
function(a,d){this.parent=a;tickUpdate=100;this.object=a.object;var g={shield:c.path+"red-ring.png",innerShield:c.path+"protection-shield.png"};this.object.visible&&c.playAudio("evil-crack");this.buffProp=new c.items.value.buffSkills.intimidation;c.extend(this,new c.createShieldParticle(this.object,this.buffProp.tick,g,45),!0);this.buffName="intimidation";this.tick=0;this.selfIntimidation=function(){var a=this.parent.object.statParameters,g=a.buffSkill;g.selfIntimidation||(g.selfIntimidation=new c.items.value.buffSkills.intimidation,
g.selfIntimidation.icon="intimidationSmall.png",g.selfIntimidation.name="selfIntimidation",g.selfIntimidation.castedToAlly=!0,g.selfIntimidation.callbackStart=function(a){a.paramsTarget.object.rigBody.forceObjectToAttack(this.parent.object);a.isRegisted||(b.buffDefenseVitallity(d,a,"register","+"),b.buffDefenseMagic(d,a,"register","+"),b.buffModifierAbilities({modifierInitial:"block",initial:"register",buff:a,propSkill:d,op:"+"}),a.isRegisted=!0)}.bind(this),g.selfIntimidation.callbackEnd=function(a){a.isRegisted&&
(b.buffDefenseVitallity(d,a,"unregister","-"),b.buffDefenseMagic(d,a,"unregister","-"),b.buffModifierAbilities({modifierInitial:"block",initial:"unregister",buff:a,propSkill:d,op:"-"}))}.bind(this),b.registerBuff(a,a,"selfIntimidation"));delete g.selfIntimidation};this.updateIntimidation=function(){for(var a=this.parent.createAreaDamagePool({target:this.parent.object,width:500,height:500,caster:this.parent.object.label}),d=this.parent.object.statParameters,c=d.buffSkill,g=0;g<a.length;g++)this.parent.isEnemyFn(a[g].object.label)&&
a[g].object.label!==this.object.label||a.splice(g,1);this.updateSelfbuff||(this.selfIntimidation(),this.updateSelfbuff=!0);c.intimidation||(c.intimidation=this.buffProp,c.intimidation.icon="intimidationSmall.png",c.intimidation.callbackStart=function(a){a.paramsTarget.object.rigBody.forceObjectToAttack(this.parent.object);a.isRegisted||(a.isRegisted=!0)}.bind(this));b.registerBuff(a,d,this.buffName);delete c[this.buffName]};this.update=function(a){this.parent=a;this.tick?this.tick--:(this.tick=tickUpdate,
this.updateIntimidation());return this.draw()}};if(a.rollingAttack||a.character)this.rollingAttack=function(a,d){this.parent=a;this.selectedFrame=d.name;this.life=20;this.delayAreaPool=this.lifePhysic=10;this.trajectoryX=this.trajectoryY=!0;c.extend(this,new c.physicsComponent.objectTrajectory(this.parent.object,this.lifePhysic),!0);a.forceToSwitchTurn();this.update=function(a){this.parent=a;if(this.selectedFrame!==this.parent.dirSwitch.selectedFrame)return!0;if(this.parent.isAttacking||"attack"===
this.parent.behave)if(this.life)this.life<=this.lifePhysic&&(this.updatePhysic(this.trajectoryX,this.trajectoryY),this.delayAreaPool--,0===this.delayAreaPool%3&&(this.parent.object.visible&&c.playAudio(["swing","swing2","swing3"]),b.areaDmg({target:this.parent.object,parent:this.parent,width:200,height:175,propSkill:d}))),this.life--;else return a.dirSwitch.resetWhenFrameEnd=!0;else return a.dirSwitch.resetWhenFrameEnd=!0}};a.teleportation&&(this.teleportation=function(a,b,d){this.object=a;this.target=
b;this.isOval=a.label===c.oval.value.label;this.opacity=this.ovalIterate=0;this.spawnInit=!1;this.objTranslate=c.objTranslate.value;this.object.visible&&c.playAudio("evil-swish");this.translateOvalOnly=function(a){this.isOval&&(this.objTranslate.staticObjMoveX=a.x,this.objTranslate.staticObjMoveY=a.y)};this.spawnPos=function(){var a=c.random(1,0);return{x:this.target.position.x+(a?-50:50),y:this.target.position.y}};this.update=function(a){if("approching"===d){if(this.spawnInit)if(this.isOval&&2>this.ovalIterate)b=
{x:this.object.rigBody.moveReplaceX,y:this.object.rigBody.moveReplaceY},this.translateOvalOnly(b);else if(a.dirSwitch.selectedFrame="normal",1>=this.opacity)this.opacity+=.09,this.object.opacity=this.opacity;else return this.target.opacity=1,!0;else{var b=this.spawnPos();c.Body.setPosition(this.object,b);this.translateOvalOnly(b);this.spawnInit=!0;a.dirSwitch.reset();a.dirSwitch.dirBlock.reset()}this.ovalIterate++}}});if(a.sliceAttack||a.character)this.sliceAttack=function(a,d){this.parent=a;this.selectedFrame=
d.name;this.life=10;a.forceToSwitchTurn();this.update=function(a){this.parent=a;if(this.selectedFrame!==this.parent.dirSwitch.selectedFrame)return!0;if(!this.life)return b.areaDmg({target:this.parent.object,parent:this.parent,width:400,height:350,propSkill:d}),c.playAudio("heat-impact"),c.explosiveA({object:this.parent.object,parent:"",alpha:!0}),a.dirSwitch.resetWhenFrameEnd=!0;this.life--}};if(a.upperAttack||a.character)this.upperAttack=function(a,d){this.parent=a;this.selectedFrame=d.name;this.life=
20;this.delayAreaPool=this.lifePhysic=6;this.trajectoryY=!1;this.trajectoryX=!0;c.extend(this,new c.physicsComponent.objectTrajectory(this.parent.object,this.lifePhysic),!0);a.forceToSwitchTurn();this.update=function(a){this.parent=a;if(this.selectedFrame!==this.parent.dirSwitch.selectedFrame)return!0;if(this.parent.isAttacking||"attack"===this.parent.behave)if(this.life)this.life<=this.lifePhysic&&(this.updatePhysic(this.trajectoryX,this.trajectoryY),this.delayAreaPool--,0===this.delayAreaPool%3&&
(this.parent.object.visible&&c.playAudio(["swing","swing2","swing3"]),b.areaDmg({target:this.parent.object,parent:this.parent,width:200,height:175,propSkill:d}))),this.life--;else return a.dirSwitch.resetWhenFrameEnd=!0;else return a.dirSwitch.resetWhenFrameEnd=!0}}}this.skillRequirement=function(a){var b=c.characterInventoryBag.value.get(this.object.label);switch(a.name){case "throwBoom":for(var d=!0,f=[],k=0,h=b.length;k<h;k++){var r=b[k],v=r.name.toLowerCase();"equipmentThrowBoom"===r.type&&-1!==
v.indexOf(a.stringRequired)&&(v="undefined"!==typeof r.indexBagLocation?r.indexBagLocation:"bagUnreg",f.push(v))}f.sort(function(a,b){return a-b});k=0;v=f[0];h=b.length;a:for(;k<h;k++)if(r=b[k],"equipmentThrowBoom"===r.type&&(r.indexBagLocation===v&&"bagUnreg"!==v||"bagUnreg"===v)){/redBoom/i.test(r.name)?(a.triggerName=r.name.toLowerCase(),a.damageMax=r.damageMax,a.damageMin=r.damageMin,a.buffName="burningEffect"):/blueBoom/i.test(r.name)&&(a.triggerName=r.name.toLowerCase(),a.damageMax=r.damageMax,
a.damageMin=r.damageMin,a.stunMax=r.stunMax,a.stunMin=r.stunMin,a.reduceMovement=r.reduceMovement,a.buffName="stunEffect");d=!1;r.quantity--;r.quantity||b.splice(k,1);break a}f.length=0;d&&(a.triggerName="explosionNormalBoom",a.buffName="burningEffect",a.damageMax=this.object.statParameters.attackRangeMax,a.damageMin=this.object.statParameters.attackRangeMin)}};this.triggerUniqueSkill=function(a,b){var d=this.object.statParameters;if(d.mp>b.mp&&b.state&&function(){return b.enemyTolerance?!1:this.attackTolerance()}.bind(this)){a.install();
a.guiInitLoading();this.skillRequirement(b);var f=b.mp,g=this,k=function(a){c.intervalList[b.label]={always:!0,tick:a.tick,tickUpdate:a.tick,alreadyExecuted:!1,fn:function(){if(a.isCustom){if(a.conditional?a.conditional():1)"customExecute"===a.isCustom?a.callback(this):this.alreadyExecuted||(a.callback(),g.dirSwitch.reset(),this.always=!1,this.alreadyExecuted=!0,this.tick=0)}else{var d;if(d=!this.alreadyExecuted)d=!0,"melee"===g.object.statParameters.attackType&&(d=g.characterState?g.attackTolerance()&&
!g.dirSwitch.forceAttackFrame&&!g.moveLeft&&!g.moveRight&&!g.moveUp&&!g.moveDown:g.attackTolerance()&&!g.dirSwitch.forceAttackFrame);d&&(this.always=!1,this.alreadyExecuted=!0,g.dirSwitch.prior.push({selectedFrame:a.frameSkill,label:b.label,fn:a.callback}))}}}};d.mp=0<d.mp?d.mp-f:0;switch(b.name){case "powerAgilityIII":case "powerAgilityII":case "powerAgility":k({isCustom:!0,frameSkill:b.name,tick:1,callback:function(){a.initLoading();g.cntActiveSkill.push(new g.powerAgility(g,b))}});break;case "powerDefeneseIII":case "powerDefeneseII":case "powerDefenese":k({isCustom:!0,
frameSkill:b.name,tick:1,callback:function(){a.initLoading();g.cntActiveSkill.push(new g.powerDefenese(g,b))}});break;case "abilitiesSteal":case "defenseSteal":case "bodyCharge":case "massHealing":case "healing":case "earthShake":case "mindControl":case "earthQuake":case "teleport":case "growHowl":case "intimidation":case "createRed":case "createBlue":k({isCustom:!0,frameSkill:b.name,tick:1,callback:function(){a.initLoading();g.cntActiveSkill.push(new g[b.name](g,b))}});break;case "beresekYeti":k({isCustom:!0,
frameSkill:"beresekYeti",tick:1,callback:function(){a.initLoading();g.cntActiveSkill.push(new g.bereseker(g,b))}});break;case "sekletonSummoner":case "golemSummoner":k({isCustom:!0,frameSkill:b.name,tick:1,callback:function(d){d=g.characterState?g.monsterParameters.object:g.character;a.initLoading();g.cntActiveSkill.push(new g.summoning(g,d,b))}});break;case "bindingRoot":k({isCustom:!0,frameSkill:"bindingRoot",tick:1,callback:function(){var d=g.characterState?g.monsterParameters.object:g.character;
a.initLoading();g.cntActiveSkill.push(new g.bindingRoot(g,d,b))}});break;case "piercingSword":case "piercingSpeed":case "piercingSpear":k({isCustom:!0,frameSkill:b.name,tick:1,callback:function(d){a.initLoading();g.cntActiveSkill.push(new g.piercingObject(g,b))}});break;case "bloodDrain":g.cntActiveSkill.push(new g.bloodDrain(g.object,b));a.initLoading();break;case "teleportation":k({isCustom:"customExecute",frameSkill:"teleportation",tick:1,callback:function(b){if(!b.alreadyExecuted&&(0<g.object.opacity&&
(g.dirSwitch.firstDirMove=3,c[g.object.stateStorage].set(g.object.label,"teleportation"),g.object.opacity-=.09,0>g.object.opacity&&(g.object.opacity=0)),0>=g.object.opacity)){var d=g.characterState?g.monsterParameters.object:g.character;g.dirSwitch.firstDirMove=0;a.initLoading();g.cntActiveSkill.push(new g.teleportation(g.object,d,"approching"));b.always=!1;b.alreadyExecuted=!0;b.tick=0}}});break;case "arrowRain":k({isCustom:!1,frameSkill:"arrowRain",tick:30,callback:function(){a.initLoading();g.cntActiveSkill.push(new g.arrowRain(g.characterState?
g.monsterParameters.object:g.character,b))}});break;case "sliceAttack":k({isCustom:!1,frameSkill:"sliceAttack",tick:30,callback:function(){a.initLoading();g.dirSwitch.forceAttackFrame=!0;g.cntActiveSkill.push(new g.sliceAttack(g,b))}});break;case "rollingAttack":k({isCustom:!1,frameSkill:"rollingAttack",tick:30,callback:function(){a.initLoading();g.dirSwitch.forceAttackFrame=!0;g.cntActiveSkill.push(new g.rollingAttack(g,b))}});break;case "upperAttack":k({isCustom:!1,frameSkill:"upperAttack",tick:30,
callback:function(){a.initLoading();g.dirSwitch.forceAttackFrame=!0;g.cntActiveSkill.push(new g.upperAttack(g,b))}});break;case "throwBoom":var h=g.object.statParameters;k({isCustom:!0,frameSkill:"throwBoom",tick:1,conditional:function(){if(g.attackTolerance()&&g.dirSwitch.tempTarget.isSpotted){var a=!0;if(h.mainCharacter){var b=!g.moveLeft&&!g.moveRight&&!g.moveUp&&!g.moveDown;a=g.attackTolerance()&&b;b&&a&&g.dirSwitch.reset()}return a}return!1},callback:function(){g.cntActiveSkill.push(new g.throwBoom(g,
b));a.initLoading()}});break;case "piercingShoot":k({isCustom:!1,frameSkill:"piercingShoot",tick:30,callback:function(){a.initLoading()}})}}};this.updateRegisterSkillFn=function(){var a=this.cntActiveSkill,b=a.length;if(b)for(var d=0;d<b;d++){var c=a[d];c&&c.update(this)&&a.splice(d,1)}}};this.AI.playerProperies=function(){this.specialItems=new function(){this.cntItem=[];this.updateRegisterItemFn=function(){var a=this.cntItem;if(len=a.length)for(var d=0;d<len;d++){var c=a[d];c&&c.update()&&a.splice(d,
1)}};this.register=function(a,d){var b=this,f=a.rigBody,g={forceSelectedFrame:function(a,b,d){a.dirSwitch.firstDirMove=3;a.dirSwitch.forceAttackFrame=!0;a.dirSwitch.selectedFrame=b;d&&c[a.object.stateStorage].set(a.object.label,d)},registerToIntervalList:function(a){b.cntItem.push({always:!0,tick:1,tickEnd:a.tickEnd,update:function(){a.callback();this.tick++;if(this.tick>=this.tickEnd)return!0}})}};switch(d.name){case "sekletonSummoner":case "golemSummoner":var l=d.initialParams,p={};a.pions.length<
l.maximumPawns?(a.visible&&c.playAudio("spawn"),l.aIParent=f.initialSpawn,l.spawn.x=a.position.x+c.random(250,-250),l.spawn.y=a.position.y+c.random(100,-100),l.objBoss=a,l.visible=!0,l.objPawns=[],c.monsterControl.createAINpc(l),c.orderObjectFn.value(),c.extend(p,new c.createGlowParticle(d.initialParams,d.life),!0),l.objPawns.forEach(function(b){b.rigBody.forceObjectToAttack(a);b.rigBody.enemyPass=d.name}),c.glowEffect({object:a,parent:"",alpha:!0,life:25,scaleSpeed:4}),g.registerToIntervalList({tickEnd:d.life,
tickSpawn:d.spawnTick,callback:function(){this.tickSpawn&&(l.objPawns.forEach(function(a){g.forceSelectedFrame(a.rigBody,"summon","summon")}),1===this.tickSpawn&&l.objPawns.forEach(function(a){a.rigBody.behaveRandomFn(1)}),this.tickSpawn--);p.draw()&&(l.objPawns.forEach(function(a){a.rigBody.dirSwitch.reset();a.rigBody.dirSwitch.selectedFrame="normal"}),l.objPawns.length=0)}}),d.quantity--,c.globalObjectGUI.value.autoUpdateEffectItemLeader()):c.pushMsgText.value(m.lang.fn("gui","pawnLimit","detail"),
100)}}}};this.AI.pathFinding=function(){this.initialPathFinding=new function(){this.reset=function(){this.pos.x=0;this.pos.y=0;this.tick=2};this.temp={x:0,y:0};this.pos={x:0,y:0};this.getPath=this.state=!1;this.tolerance=this.tick=2;this.globalTranslate=new c.objGlobalTranslate;this.update=function(a,d){var b=this.pos;this.globalTranslate.reverse(b);this.tick--;if(0>this.tick){var c=this.tolerance;var g=Math.abs(this.temp.x-Math.abs(a+b.x));var f=Math.abs(this.temp.y-Math.abs(d+b.y));var p=Math.abs(a+
b.x);b=Math.abs(d+b.y);if(g<c&&f<c)return this.getPath=0,this.state=!0;this.temp.x=p;this.temp.y=b;this.tick=2}return this.state=!1}}};this.AI.setVertiecsByPoint=function(){this.position={center:"",previousVerts:[],wholeVerts:[]};this.getPosition=function(a,d){var b=Math.round(a.x),c=Math.round(a.y),g=Math.round(d.x),f=Math.round(d.y);if(b===g&&c>f)return"top";if(b<g&&c>f)return"rightTop";if(b<g&&c===f)return"right";if(b<g&&c<f)return"rightBottom";if(b===g&&c<f)return"Bottom";if(b>g&&c<f)return"leftBottom";
if(b>g&&c===f)return"left";if(b>g&&c>f)return"leftTop"};this.setPosition=function(a,d){var b=c.staticWallOutter.value(),f=b[1].bounds.min.y,g=b[2].bounds.min.x,l=b[3].bounds.max.x;d.innerWall=d.y>b[0].bounds.max.y&&d.y<f&&d.x<g&&d.x>l?!0:!1;switch(this.getPosition(a,d)){case "top":d.positionByCenter="top";break;case "rightTop":d.positionByCenter="rightTop";break;case "right":d.positionByCenter="right";break;case "rightBottom":d.positionByCenter="rightBottom";break;case "bottom":d.positionByCenter=
"bottom";break;case "leftBottom":d.positionByCenter="leftBottom";break;case "left":d.positionByCenter="left";break;case "leftTop":d.positionByCenter="leftTop"}b=!1;f=0;for(g=this.position.wholeVerts;f<g.length;f++)Math.floor(g[f].x)===Math.floor(d.x)&&Math.floor(g[f].y)===Math.floor(d.y)&&(b=!0);this.position.center=a;!b&&this.position.wholeVerts.push(d)};this.createDirBlock=function(a){this.install=!0;this.tick=c.random(300,150);this.reset=function(){this.tick=c.random(300,150);this.state=!1;this.sortedVerts.length=
0;this.rangeProp.dummyState=!1;this.previousVertex="";var a=this.object.rigBody.dirSwitch.tempTarget;a.init=!0;a.position.x=this.object.position.x;a.position.y=this.object.position.y};this.sortedVerts=a.sortedVerts;this.sortedVertsAlternate=a.sortedVertsAlternate;this.object=a.target;this.previousVertex="";this.changeDir=function(a,b){0<(b?Math.round(a.x-b.x):this.previousVertex?Math.round(a.x-this.previousVertex[0].x):Math.round(a.x-this.object.position.x))?setTimeout(function(){this.object.rigBody.changeRightFn(!0)}.bind(this),
2):setTimeout(function(){this.object.rigBody.changeLeftFn(!0)}.bind(this),2)};this.storedDir={prev:""};this.dir=function(a){this.storedDir.prev!==a.indexGl&&(a.innerWall||(this.sortedVerts=this.sortedVertsAlternate),this.changeDir(a),this.storedDir.prev=a.indexGl)};this.state=!0;this.scale={center:a.center,x:0,y:0,sub:function(a,b){var d={};d.x=a.x-b.x;d.y=a.y-b.y;return d},fn:function(a){var b=this.center,d=scaleY=2,c=this.sub(a,b);this.x=b.x+c.x*d;this.y=b.y+c.y*scaleY;b=this.x-a.x;a=this.y-a.y;
this.x=70<b?70:-70>b?-70:b;this.y=70<a?70:-70>a?-70:a}};this.targetDummy={position:{}};this.rangeProp={dummyState:!1,state:!1,destEnd:""};this.fn=function(a){a=this.object;var b=a.position,d=a.rigBody,g=this.targetDummy,f=d.initialPathFinding,p=this.sortedVerts.length,n=!0;this.tick?this.tick--:p=this.sortedVerts.length=0;f.update(b.x,b.y);f.state&&(n=!1);if(p){if(n)return f=this.sortedVerts[0],p=Math.abs(d.moveSpeed),this.dir(f),g.position.x=f.x,g.position.y=f.y,g=c.moveVector2dWithVelocity(a,g,
p),g.x=isNaN(g.x)?0:g.x,g.y=isNaN(g.y)?0:g.y,c.Body.setPosition(a,{x:b.x+g.x,y:b.y+g.y}),10>g.distance&&(this.previousVertex=this.sortedVerts.splice(0,1)),this.state=!0,this.rangeProp.dummyState&&(d.dirSwitch.tempTarget.position.x=b.x,d.dirSwitch.tempTarget.position.y=b.y),{init:!1,x:g.x,y:g.y}}else"attack"===d.behave?this.changeDir(d.character.position,this.object.position):this.object.statParameters.mainCharacter&&this.changeDir(d.monsterParameters.object.position,this.object.position);f.reset();
this.reset();return{init:!1,x:0,y:0}}};this.path=function(){this.pointA=[];this.pointB=[];this.distanceB=this.distanceA=0};this.generatePreviousVertices=function(a){this.position.previousVerts=[];for(var b=0,c=a.length;b<c;b++)this.position.previousVerts.push(a[b].indexGl)};this.isPreviousVertices=function(a){var b=this.position.previousVerts;if(b.length===a.length){for(var c=0,f=0,g=a.length;f<g;f++){var l=0,p=b,n=p.length;a:for(;l<n;l++)if(a[f].indexGl===p[l]){c++;break a}}if(c===a.length)return!0}return!1};
this.generatePath=function(a,d){var b=new this.path,f=this.position.wholeVerts,g=c.AI.sortestEnemy(f,a.targetPosition),l=a.destinationPoint,p=g[0];pointB=g[1];g=p.indexGl;var n=f.length,q=0,r=!1;for(;g<n;g++){var v=f[g];l.indexGl===v.indexGl||r?l.indexGl!==v.indexGl?b.pointB.push(v):r=!0:b.pointA.push(v);if(q+p.indexGl===n-1)for(var u=0,m=p.indexGl;u<m;u++)v=f[u],l.indexGl===v.indexGl||r?l.indexGl!==v.indexGl?b.pointB.push(v):r=!0:b.pointA.push(v);q++}b.pointB.reverse();1>=b.pointA.length?b.pointA=
[l]:b.pointA.push(l);1>=b.pointB.length?b.pointB=[l]:b.pointB.push(l);return b};this.generateDistance=function(a,d,f){var b=0;d=a[d];for(var g=d.length;b<g;b++)d[b+1]&&(a[f]+=c.distanceAndAngleBetweenTwoPoints(d[b].x,d[b].y,d[b+1].x,d[b+1].y).distance)};this.removeVertexNotNeighbor=function(a,d){for(var b=function(a,b){var d=Math.abs(a.indexGl-b.indexGl);return 1<d||1>d},f=0;f<a.length;f++)if(2<=a.length){var g=a[f+1]?a[f+1]:a[0],l=a[f-1]?a[f-1]:a[a.length-1];if(b(a[f],g)&&b(a[f],l))if(2<a.length)a.splice(f,
1);else{var p=d.destinationPoint,n=Math.abs(c.distanceAndAngleBetweenTwoPoints(g.x,g.y,p.x,p.y).distance);p=Math.abs(c.distanceAndAngleBetweenTwoPoints(l.x,l.y,p.x,p.y).distance);indexRemove=n>p?g.indexGl:l.indexGl;a.splice(indexRemove,0)}}};this.removeVerticesWhenTooFarFromTarget=function(a,d){if(1<a.length)for(var b=0;b<a.length;b++){var f=d.targetDestinationPos,g=Math.abs(c.distanceAndAngleBetweenTwoPoints(a[b].x,a[b].y,f.x,f.y).distance);f=Math.abs(c.distanceAndAngleBetweenTwoPoints(d.targetPosition.x,
d.targetPosition.y,f.x,f.y).distance);g>f&&a.splice(b,1)}return a};this.createRandDestinationVertexByDir=function(a){for(var b={right:[],left:[]},f=0,h=this.position.wholeVerts,g=h.length;f<g;f++)-1!==h[f].positionByCenter.indexOf("right")?b.right.push(h[f]):b.left.push(h[f]);return(a=b[a.objectDir])?a[c.random(a.length-1,0)]:!1};this.getTargetByRandDestPoint=function(a){var b=a.rigBody,f=b.turn?b.turn:b.latestDir,h=c.AI.sortestEnemy(this.position.wholeVerts,a.position)[0],g=this.createRandDestinationVertexByDir({objectDir:f});
/hero/i.test(a.label);f=this.generatePath({targetPosition:h,destinationPoint:g},!0);this.removeVertexNotNeighbor(f.pointA,{destinationPoint:g});this.removeVertexNotNeighbor(f.pointB,{destinationPoint:g});this.generateDistance(f,"pointA","distanceA");this.generateDistance(f,"pointB","distanceB");g=f.distanceA<f.distanceB?"pointA":"pointB";h=f[g];f=f["pointA"===g?"pointB":"pointA"];g=b.dirSwitch;b.turnState=c.random(300,100);g.dirBlock.install?(g.dirBlock.sortedVerts=h,g.dirBlock.sortedVertsAlternate=
f,g.dirBlock.target=a,g.dirBlock.state=!0,g.dirBlock.previousVertex="",g.dirBlock.tick=c.random(300,150)):g.dirBlock=new this.createDirBlock({sortedVerts:h,sortedVertsAlternate:f,target:a,center:this.position.center})};this.getTarget=function(a,d){var b=d?a:a.position,f=d?d:"attack"===a.rigBody.behave?a.rigBody.character.position:a.rigBody.pointMove.position,g=this.position.wholeVerts,l=d?d:c.AI.sortestEnemy(g,f)[0],p=this.generatePath({targetPosition:b,destinationPoint:l},a);this.removeVertexNotNeighbor(p.pointA,
{destinationPoint:l});this.removeVertexNotNeighbor(p.pointB,{destinationPoint:l});this.generateDistance(p,"pointA","distanceA");this.generateDistance(p,"pointB","distanceB");var n=p.distanceA<p.distanceB?"pointA":"pointB",q=p[n];p=p["pointA"===n?"pointB":"pointA"];if(!d)var r=a.rigBody.dirSwitch,v=r.dirBlock.rangeProp;d||"long-range"!==a.rigBody.monsterParameters.attackType?(q=this.removeVerticesWhenTooFarFromTarget(q,{targetPosition:b,targetDestinationPos:f}),p=this.removeVerticesWhenTooFarFromTarget(p,
{targetPosition:b,targetDestinationPos:f})):(b=q[q.length-1],!v.state&&b.y>f.y&&(v.dummyState=v.state=!0,v.destEnd=a.rigBody.character,f=g[c.AI.boundVertexToIndex(g).min.y],f=this.getTarget(b,f),q=q.concat(f),this.removeVertexNotNeighbor(q,{destinationPoint:l})),v.state=!1);if(d)return q;r.dirBlock.install?(r.dirBlock.sortedVerts=q,r.dirBlock.sortedVertsAlternate=p,r.dirBlock.target=a,r.dirBlock.state=!0,r.dirBlock.previousVertex="",r.dirBlock.tick=c.random(300,150)):r.dirBlock=new this.createDirBlock({sortedVerts:q,
sortedVertsAlternate:p,target:a,center:this.position.center})}};this.AI.boundVertexToIndex=function(a){for(var b=[],c=[],f={max:{},min:{}},g=0;g<a.length;g++)b.push(a[g].x),c.push(a[g].y);b.sort(function(a,b){return a-b});c.sort(function(a,b){return a-b});for(g=0;g<a.length;g++)b[b.length-1]===a[g].x&&(f.max.x=g),b[0]===a[g].x&&(f.min.x=g),c[c.length-1]===a[g].y&&(f.max.y=g),c[0]===a[g].y&&(f.min.y=g);return f};this.AI.verticesTail=function(a){this.objectPos=a.position;this.tail=[];this.updateTailTick=
15;this.update=function(){var a=this.tail,b=!0;this.updateTailTick?(this.updateTailTick--,b=!1):this.updateTailTick=15;b&&(9<a.length?(a.pop(),a.unshift({x:this.objectPos.x,y:this.objectPos.y})):a.push({x:this.objectPos.x,y:this.objectPos.y}))}}};t.component=function(){var a=this;this.components={};this.components.monster=function(){this.objectGetDamage=function(c,f,b){this.cureSelf.gui&&this.cureSelf.updateBar("hp-inner-line-bar");this.monsterParameters.health=0>b?0:this.monsterParameters.health-
c;this.turnState=a.random(600,500);this.dirSwitch.previousTarget!==f&&(this.dirSwitch.dirBlock.reset(),this.dirSwitch.previousTarget=f);return f!==this.boss.label?(this.partyRandomHelp.update(this),this.hitterNotTarget(f),!0):!1};this.healthBar={opacity:0,tickUpdate:100,tick:0,hpTick:0,staticDrawImage:a.staticDrawImage.value,update:function(a,f,b,d,k,h){if(0<this.tick){this.tickUpdate===this.tick&&(!this.health||this.health<f)&&(this.health=f);this.tick--;d=this.staticDrawImage;var c=d.fn,l=d.hpMedTexture.textures.width,
p=d.hpMedTexture.textures.height;10>this.tick&&0<this.opacity?(a.useProgram(c.glProp.program),a.uniform1f(c.glProp.alphaLocation,this.opacity-=.09)):.9>this.opacity&&(a.useProgram(c.glProp.program),a.uniform1f(c.glProp.alphaLocation,this.opacity+=.09));c.update({img:d.hpMedConver.textures,context:a,ver:"v3",posX:0,posY:0,srcWidth:l,srcHeight:p,dstX:k-l/2,dstY:h-20,dstWidth:l,dstHeight:p});var n=Math.round(this.health/b*l);b=Math.round(f/b*l);var q=40+Math.round(n-b);this.health>=f&&(this.health-=
q);c.update({img:d.hpMedTick.textures,context:a,ver:"v3",posX:0,posY:0,srcWidth:l,srcHeight:p,dstX:k-l/2,dstY:h-20,dstWidth:n,dstHeight:p});c.update({img:d.hpMedTexture.textures,context:a,ver:"v3",posX:0,posY:0,srcWidth:l,srcHeight:p,dstX:k-l/2,dstY:h-20,dstWidth:b,dstHeight:p})}}};this.displayBar=function(){var c=this.object,f=this.healthBar,b=c.additionalBoundsValue||0;c.visible&&!c.isHero&&f.update(a.context,this.monsterParameters.health,this.monsterParameters.maxHealth,this.hpSize,c.position.x,
c.bounds.min.y-b);c.monsterTarget?(this.installHealthGUI.state||(this.monsterParameters.monsterLevel&&this.installHealthGUI.fn(this.monsterParameters.name),this.installHealthGUI.state=!0),f.tick=f.tickUpdate):this.installHealthGUI.state&&(this.installHealthGUI.state=!1)};this.stat=function(){var c=this.monsterGetDamage;if(c&&c.length)for(var f=0,b=c.length;f<b;f++){var d=c[f];attacker=d&&d.attacker;if(this.monsterParameters.health&&attacker&&this.isEnemyFn(attacker)){d=Math.round(c[f].damage);var k=
c[f].status,h=c[f].attackerAbilities,g=Math.round(this.monsterParameters.health)-d;b=c[f].attackerParameters;var l=this.object.visible;c.splice(f,1);var p=!0,n=h.length;f=c=!0;for(var q=this.attackerAbilities(this.monsterParameters),r=0,v=q.length;r<v;r++)if("block"===q[r]){a.playAudio("shiled-blocking");l&&this.hitNumber.push(new a.hitNumber("block"));c=p=!1;break}else if("avoid"===q[r]){l&&this.hitNumber.push(new a.hitNumber("miss"));c=p=!1;break}if(n&&p)for(q=0;q<n;q++)"stun"===h[q]&&(f=!1,l&&
this.hitNumber.push(new a.hitNumber("stun")),this.stunEffect.fn("short",this.object));h=this.abilityCritical(b,d);n=0<h;d+=h;p&&"attack"===k&&c&&(d="mage"===this.monsterParameters.classType?this.abilityMagicDefense(this.monsterParameters,d):this.abilityDefense(this.monsterParameters,d),this.objectGetDamage(d,attacker,g),l&&(n?d=new a.hitNumber(d,"critical"):(this.healthBar.tick=this.healthBar.tickUpdate,d=this.objTranslate.effect?new a.hitNumber(d):this.object.isHero?new a.hitNumber(d):""),d&&f&&
c&&(this.hitNumber.push(d),a.hitEffect({object:this.object,parent:"",alpha:!0})),a.playAudio(["stab"])));this.isStatic||/attack|back/i.test(this.behave)||(this.attacker=attacker,this.setTarget(),this.dirSwitch.dirBlock.reset());if(attacker===this.object.bossLabel||/back/i.test(this.behave)||this.stunEffect.init)return!1;this.buff.register({seletedBuff:b.buffSkill,paramsTarget:this.monsterParameters,paramsAttacker:b});this.pitboss&&(this.object.attacker=this.attacker,this.object.needHelp=!0);return!0}c.length=
0}};this.installHealthGUI=new function(){this.state=!1;this.fn=function(c){a.removeClass(a.qs("monster-bar"),"hidden");var f=a.qs("box-name-level").getElementsByTagName("span")[0];a.text(f,c)}}};this.components.monsterDungeon=function(c){this.remove=!1;this.boss="";this.rigState=!0;this.parentObject=this.pointMove="";this.character=a.oval.value;this.objTranslate=a.objTranslate.value;this.object=this.attacker="";this.hpSize="medium";this.install=!1;this.monsterAttribute=!0;this.moveSpeed=1;this.moveIdle=
15;this.moveStrict=!1;this.walkState=100;this.idleAttackWalk=a.random(35,5);this.randState=this.rand=0;this.behave="walk";this.backRange={state:!1,x:600,y:300,normalX:600,normalY:300,backX:300,backY:150};this.backDelay=25;this.behaveRandom=10;this.behaveState=!0;this.tick=0;this.dirSwitch={prior:[],dirBlock:{state:!1,sortedVerts:[],reset:function(){},rangeProp:{state:!1}},tickFrame:0,forceAttackFrame:!1,frameExtendCount:0,frameCount:0,firstDirMove:0,previousTarget:"",attackDelay:0,attackDelayPerFrame:0,
attackDelayPerFrameReplace:28,approchingState:"walk",mainTurn:!0,selectedFrame:"normal",turn:!1,targetDummyForMelee:{position:{x:0,y:0}},tempTarget:{position:{x:0,y:0},init:!0},reset:function(){this.attackDelayPerFrame=this.firstDirMove=this.tickFrame=this.frameCount=this.frameExtendCount=0;this.forceAttackFrame=!1}};this.attackRangeX=300;this.attackRangeY=-300;this.vector={x:0,y:0};this.turnState=-1;this.turn="right";this.hitNumber=[];this.stunEffect={init:!1};this.objectPointing={objTranslate:a.objTranslate.value,
position:{x:0,y:0},translate:function(){this.objTranslate.staticObjStateX&&(this.objTranslate.moveLeft?this.position.x+=this.objTranslate.staticObjMoveX:this.objTranslate.moveRight&&(this.position.x+=this.objTranslate.staticObjMoveX));this.objTranslate.staticObjStateY&&(this.objTranslate.moveUp?this.position.y+=this.objTranslate.staticObjMoveY:this.objTranslate.moveDown&&(this.position.y+=-this.objTranslate.staticObjMoveY))}};this.addSpeedForTurnAndWalk=function(c,b){var d=this.initialSpeedNormal;
if("x"===c){var f="normal"===d?1:"fast"===d?2:3;d="normal"===d?.8:"fast"===d?1:2}else f="normal"===d?.9:"fast"===d?1.5:2.5,d="normal"===d?.1:"fast"===d?.5:1.5;return"min"===b?-a.randomFloat(parseFloat(f),parseFloat(d)):a.randomFloat(parseFloat(f),parseFloat(d))};this.addSpeed=function(){return"attack"===this.behave?this.moveSpeedAttack:this.moveSpeedNormal};this.monsterDir=function(){return this.character.position.x<this.object.position.x?"left":"right"};this.boundsWidthOperator={left:1,right:1};
this.changeLeftFn=function(){if(!this.dirSwitch.forceAttackFrame&&this.monsterParameters.health){var c=this.object.initialName+"-left.png";this.turn="left";this.object.additionalBoundsWidthValue=this.boundsWidthOperator.left*Math.abs(this.object.additionalBoundsWidthValue);this.moveSpeed=-Math.abs(this.addSpeed());a[this.object.stateStorage].set(this.object.label,"textureNeedChange|"+a.path+c)}};this.changeRightFn=function(){if(!this.dirSwitch.forceAttackFrame&&this.monsterParameters.health){var c=
this.object.initialName+"-right.png";this.turn="right";this.object.additionalBoundsWidthValue=this.boundsWidthOperator.right*Math.abs(this.object.additionalBoundsWidthValue);this.moveSpeed=Math.abs(this.addSpeed());a[this.object.stateStorage].set(this.object.label,"textureNeedChange|"+a.path+c)}};this.pathBack=[];this.behaveRandomFn=function(c){var b=a.random(1,0);b=0===c||1===c?c:b;0===b?(this.object.behave=this.behave="walk",this.turnState=0,a[this.object.stateStorage].set(this.object.label,"walk")):
1===b&&(this.turnState=a.random(200,50),this.object.behave=this.behave="idle",a[this.object.stateStorage].set(this.object.label,"idle"));this.pitboss&&(this.object.attacker=!1,this.object.needHelp=!1);this.dirSwitch.dirBlock.reset();this.behaveState=!0;this.behaveRandom=a.random(15,10);this.attackTick=50;this.bugAttacker=!1;this.attackTick=0;this.idleAttackWalk=a.random(35,5);this.object.selected=!1};this.posCapture={position:{x:0,y:0}};this.updateBossTickBack=!1;this.updateIntervalBack=600;this.loopDir=
function(a,b){this.dirSwitch.dirBlock.state||(0<a?("right"!==this.turn||b)&&setTimeout(function(){this.changeRightFn()}.bind(this),2):("left"!==this.turn||b)&&setTimeout(function(){this.changeLeftFn()}.bind(this),2))};this.backDir=function(a,b,d,c){a<-d?(this.changeLeftFn(),this.vector.x=-1):a>d&&(this.changeRightFn(),this.vector.x=1);b>c?this.vector.y=.5:b<-c&&(this.vector.y=-.5)};this.findBodies=function(c){for(var b=0,d=a.Composite.allBodies(a.engine.world);b<d.length;b++)if(d[b].label===c)return d[b];
return!1};this.AIParty=function(c){if("attack"!==this.behave){if(c.pions)c=[c].concat(c.pions);else{var b=this.findBodies(c.bossLabel);c=b?[c].concat(b.pions):[c]}c=a.AI.sortestEnemy(c,this.object);for(b=0;b<c.length;b++)if("attack"!==c[b].behave&&!c[b].selected)return c[b].selected=!0,c[b];c=c[a.random(c.length-1,0)];c.selected=!0;return c}};this.cntStateSkill=[];this.cntActiveSkill=[];this.skill={parent:"",active:[],uniqueSkill:function(c){var b=this.parent.object.position,d=this.parent.character.position;
b=a.distanceAndAngleBetweenTwoPoints(b.x,b.y,d.x,d.y).distance;switch(c.name){case "piercingSpear":state=250>b;break;case "teleport":case "teleportation":state=250<b;break;case "bodyCharge":state=200>b;break;case "bindingRoot":state=b<this.parent.monsterParameters.range;break;case "earthShake":case "throwBoom":case "earthQuake":case "piercingSpeed":case "abilitiesSteal":case "defenseSteal":state=this.parent.attackTolerance();break;case "sekletonSummoner":case "golemSummoner":this.parent.object.pions||
(this.parent.object.pions=[]);state=this.parent.object.pions.length+1<c.initialParams.maximumPawns;break;default:state=!0}return this.parent.dirSwitch.forceAttackFrame?!1:state},selectRandom:function(c,b){this.parent=c;var d=b.length,f=this;if(d){for(var h=[];d!==h.length;){var g=b[a.random(d-1,0)];if(g.state)break;else h.push(g),g=null}h.length=0;g&&this.uniqueSkill(g)&&c.triggerUniqueSkill({install:function(){},initLoading:function(){f.active.push(g)},guiInitLoading:function(){g.state=!1}},g)}},
updateTick:function(){for(var a=this.active,b=0;b<a.length;b++){var d=a[b];d.state||(0<d.tickUpdate?d.tickUpdate--:(d.state=!0,d.tickUpdate=d.tickOriginal&&d.tickOriginal||d.tick,this.active.splice(b,1)))}},reset:function(c,b){for(var d=b.length,f=c.skill.active,h=0;h<d;h++){for(var g=!1,l=b[h],p=0;p<f.length;p++){var n=f[p];l.label===n.label&&(g=!0)}l.state||g||(a.intervalList[l.label]&&delete a.intervalList[l.label],l.state=!0,l.tickUpdate=l.tick)}for(p=0;p<f.length;p++)n=f[p],n.tickUpdate>=n.tick&&
n.state&&f.splice(p,1);c.dirSwitch.selectedFrame="";c.dirSwitch.reset()}};this.manualUpdate=function(){if(this.rigState){for(var c=this.cntActiveSkill,b=0;b<c.length;b++)if(/createBlue|createRed/i.test(c[b].name)){var d=this.AISelectTarget(a.browserWidthUpdate,2*a.browserHeightUpdate,"random");d&&c[b].hitted&&(c[b].targetEnd=d)}("attack"===this.behave||this.isStatic)&&this.skill.selectRandom(this,this.cntStateSkill)}};this.AISelectTarget=function(c,b,d){var f,h=[],g=[];areaPool=this.createAreaDamagePool({target:this.object,
width:c,height:b,caster:this.object.label});c=0;for(b=areaPool;c<b.length;c++)h.push(b[c].object);c=0;b=a.AI.sortestEnemy(h,this.object);for(h=b.length;c<h;c++)this.isEnemyFn(b[c].label)&&g.push(b[c]);"nearest"===d?f=g[0]:"random"===d&&(f=g[a.random(g.length-1,0)]);g.length=0;return f};this.forceObjectToAttack=function(a,b){this.object.label===a.label||this.stunEffect.init||this.character.label===a.label&&"attack"===this.behave&&!b||!this.character.position&&!this.object.position||(this.character=
a,this.loopDir(Math.round(this.character.position.x-this.object.position.x)),this.attacker=this.character.label,this.object.behave=this.behave="attack")};this.setTarget=function(){for(var c=0,b=a.Composite.allBodies(a.engine.world);c<b.length;c++)if(b[c].label===this.attacker){b[c].selected=!1;this.character=b[c];this.loopDir(Math.round(this.character.position.x-this.object.position.x));this.dirSwitch.selectedFrame="";this.dirSwitch.reset();break}};this.hitterNotTargetTick=0;this.hitterNotTarget=
function(c){this.attacker!==c&&0===this.hitterNotTargetTick&&(this.hitterNotTargetTick=a.random(10,20));0<this.hitterNotTargetTick&&(this.hitterNotTargetTick--,1===this.hitterNotTargetTick&&(this.attacker=c,this.setTarget()))};this.bossNeedHelp=function(){if(this.boss&&this.boss.attacker&&"pointing"!==this.behave){if("die"===this.boss.attacker)this.pointMove=this.objSpawn=this.boss.setObjectSpawn,this.boss="",this.object.behave=this.behave="attack";else if(this.boss.needHelp&&"attack"!==this.behave){this.attacker=
this.boss.attacker;this.setTarget();var a=this.AIParty(this.character);this.forceObjectToAttack(a);this.boss.needHelp=!1}this.updateBossTickBack=!0}else this.updateBossTickBack&&(this.updateBossTickBack=!1)};this.forceGravity=!1;this.requireInstall=function(c,b,d,k,h,g,l){this.x=b;this.y=d;this.object=k;this.object.statParameters=this.monsterParameters;this.label=k.label;this.rand=h;this.items=g;this.parentObject=c;this.boss=l&&l||"";this.object.bossLabel=this.boss&&this.boss.label;this.monsterParameters.object=
this.object;this.attacker=this.character.label;this.replaceObjectSpawnByRand.originObjSpawn=this.objSpawn.label;this.pointMove=this.boss?this.boss:this.objSpawn;this.object.behave=this.behave="idle";this.forceGravity=this.object.forceGravity?this.object.forceGravity:!1;this.dungeonAttackRange-=Math.abs(this.object.additionalBoundsWidthValue);a.monsterParameters.value.set(this.object.label,this.monsterParameters);a.Body.setPosition(k,{x:b,y:d});a[this.object.stateStorage].set(this.object.label,"idle");
this.boundsWidthOperator.left=0<this.object.additionalBoundsWidthValue?-1:1;this.boundsWidthOperator.right=0<this.object.additionalBoundsWidthValue?1:-1;this.turnState=a.random(200,100);this.changeRightFn();this.disableExtendMap||(g={},c=a.staticAllMap.value[this.location],g[this.object.label]=this.object,a.extend(c.content,g,!0),this.temporaryObjectSpawn?(!c.content.temporaryObjectSpawn&&(c.content.temporaryObjectSpawn=[]),c.content.temporaryObjectSpawn.push(this.object)):setTimeout(function(){this.replaceObjectSpawnByRand.parent=
this;this.replaceObjectSpawnByRand.update(this.location)}.bind(this),100));a.monsterGetDamage.value.get(this.object.label)||(a.monsterGetDamage.value.set(this.object.label,[]),this.monsterGetDamage=a.monsterGetDamage.value.get(this.object.label));a.extend(this,new a.components.objPropertyFn("monster"),!0);a.extend(this,new a.components.buff,!0);a.extend(this,new a.AI.skillBehaviour(this.monsterParameters.abilitySkill,this),!0);this.objGlobalTranslate=new a.objGlobalTranslate;for(var f in this.monsterParameters.abilitySkill)a.items.value.skills[f]&&
this.cntStateSkill.push(new a.items.value.skills[f]);if(this.inventory.length&&!a.characterInventoryBag.value.get(this.object.label)){g=[];f=0;c=this.inventory;for(b=c.length;f<b;f++)g.push(new a.items.value[c[f].root?c[f].root:"magic"][c[f].item]({quantity:c[f].quantity}));a.characterInventoryBag.value.set(this.object.label,g);this.cureSelf.loot=g;this.cureSelf.parameters=this.monsterParameters}this.object.rigBody=this;this.boss&&(this.boss.pions||(this.boss.pions=[]),this.boss.pions.push(this.object),
this.pionState=!0,this.objSpawn=this.boss);this.hero&&(a.characterControl.switchCharacter(this.object),setTimeout(function(){var a=this.object.pions;if(a instanceof Array)for(var b=0;b<a.length;b++)a[b].rigBody.cureSelf.gui=!0,a[b].rigBody.cureSelf.updateBar("hp-inner-line-bar"),a[b].rigBody.cureSelf.updateBar("mp-inner-line-bar"),a[b].rigBody.cureSelf.updateAvatar()}.bind(this),100));this.install=!0};this.replaceObjectSpawnByRand={originObjSpawn:"",parent:"",selectedObjSpawn:"",update:function(c){var b=
this.selectedObjSpawn;if(this.parent.pionState)return this.parent.objSpawn;if(b&&!b.deleted)return b;c=a.staticAllMap.value[c].content;return this.selectedObjSpawn=(b=c.temporaryObjectSpawn)&&b.length?this.parent.pointMove=a.AI.sortestEnemy(b,this.parent.object)[0]:this.parent.pointMove=this.parent.objSpawn}};this.characterNotExist=function(){this.character.deleted?(this.spell&&(a.oval.value.attacker=!1,a.oval.value.needHelp=!1),this.character={},this.character.position={x:0,y:0},this.character.bounds=
{max:{x:0,y:0},min:{x:0,y:0}},this.attacker=!1,this.behaveRandomFn(1)):this.character.label?"attack"===this.behave&&"dummy"===this.character.label&&this.behaveRandomFn(1):(this.attacker=!1,this.character.label="dummy",this.behaveRandomFn(1))};this.randomAttacking=a.random(50,10);this.areaDamageHitter=[];this.areaDamageFn=function(){if(!this.rigState)return!0;this.areaDamageHitter.length=0;var c=this.object.position,b=0,d=a.areaDmgPool.value.storage;a:for(;b<d.length;b++){for(var k=0,h=this.areaDamageHitter;k<
h.length;k++)if(d[b].status.label===h[k])break a;c.x>d[b].status.bounds.min.x&&c.x<d[b].status.bounds.max.x&&c.y>d[b].status.bounds.min.y&&c.y<d[b].status.bounds.max.y&&this.aggresiveTo(d[b].status.caster)&&d[b].status.caster!==this.object.label&&(d[b].status.monsterParameters.push(this.monsterParameters),this.areaDamageHitter.push(d[b].status.label))}};this.toAggresive=function(){if(this.rigState&&this.aggresive&&"attack"!==this.behave&&!this.spell){var c=[];if(this.characterState){var b=a.oval.value;
"die"!==b.behave&&(c=[b].concat(b.pions))}else{b=0;for(var d=a.Composite.allBodies(a.engine.world);b<d.length;b++)for(var k=0,h=this.aggresive.length;k<h;k++)-1!==d[b].label.indexOf(this.aggresive[k])&&c.push(d[b])}c.length&&(targetEnemy=a.AI.sortestEnemy(c,this.object)[0],350>a.distanceAndAngleBetweenTwoPoints(this.object.position.x,this.object.position.y,targetEnemy.position.x,targetEnemy.position.y).distance&&(this.character=targetEnemy,this.loopDir(Math.round(this.character.position.x-this.object.position.x)),
this.attacker=targetEnemy.label,this.object.behave=this.behave="attack"))}};this.hitNumberFn=function(){if(this.hitNumber.length)for(var c=0;c<this.hitNumber.length;c++)this.hitNumber[c].update(a.context,this.object)&&this.hitNumber.splice(c,1)};this.cureSelf={guiSupportAvailable:a.guiSupportAvailable.value,selectedGUI:!1,gui:!1,parameters:"",loot:"",hpSlot:"",mpSlot:"",reset:function(){this.gui&&(this.gui=!1,this.selectedGUI&&this.guiSupportAvailable.push(this.selectedGUI),this.selectedGUI=!1)},
updateAvatar:function(){if(this.gui){var c=a.qs(this.selectedGUI).querySelectorAll(".avatar-support")[0];a.css(c,{background:"transparent url("+a.path+this.parameters.object.rigBody.avatar+") no-repeat top center","background-size":"100% auto"})}},updateBar:function(c,b){if(this.gui){!this.selectedGUI&&this.guiSupportAvailable.length&&(this.selectedGUI=this.guiSupportAvailable.splice(0,1)[0]);var d=a.qs(this.selectedGUI).querySelectorAll("."+c)[0],f="hp-inner-line-bar"===c?Math.round(this.parameters.health/
this.parameters.maxHealth*100):Math.round(this.parameters.mp/this.parameters.maxMp*100);a.css(d,{width:(1>f?0:f)+"% "})}},attachFn:function(a,b,d){for(var c=this.loot,f=!1,g=!1,l=0;l<c.length;l++){var p=c[l];if("add"===b){if("undefined"!==typeof p.cooldownTick)if(/healthpotion/i.test(a)&&/healthpotion/i.test(p.name)){this.hpSlot=p;f=!0;break}else if(/manapotion/i.test(a)&&/manapotion/i.test(p.name)){this.mpSlot=p;g=!0;break}}else"remove"===b&&p.label===d&&this.loot.splice(l,1)}!f&&/healthpotion/i.test(a)?
this.hpSlot="":!g&&/manapotion/i.test(a)&&(this.mpSlot="")},cure:function(a,b){var d=this.parameters;a.cooldownTick--;1>a.cooldownTick&&(1<a.quantity?("healthpotion"===b?(d.health<d.maxHealthCure&&(a.quantity--,d.health=d.health+a.cure<d.maxHealth?d.health+a.cure:d.maxHealth),this.updateBar("hp-inner-line-bar")):"manapotion"===b&&(d.mp<d.maxMpCure&&(a.quantity--,d.mp=d.mp+a.cure<d.maxMp?d.mp+a.cure:d.maxMp),this.updateBar("mp-inner-line-bar")),a.cooldownTick=a.cooldown):this.attachFn(b,"remove",a.label))},
update:function(){var a=this.hpSlot,b=this.mpSlot;a?this.cure(a,"healthpotion"):this.attachFn("healthpotion","add");b?this.cure(b,"manapotion"):this.attachFn("manapotion","add")}};this.removeParamsWhenObjDeath=function(c,b){return c.health||this.hitNumber.length||b.deleted?b.deleted?(b.opacity=0<=b.opacity?b.opacity-.03:0,!1):!0:(b.deleted=!0,setTimeout(function(){if(this.trajectoriesUpdate&&this.trajectoriesUpdate.length)for(var d=0;d<this.trajectoriesUpdate.length;d++)this.trajectoriesUpdate[d].update(0,
0,0,0,this.turn,this.character,!0)&&this.trajectoriesUpdate.splice(d,1);if(this.boss&&this.boss.pions&&this.boss.pions.length)for(d=0;d<this.boss.pions.length;d++){if(this.boss.pions[d].label===b.label){this.boss.pions.splice(d,1);break}this.boss.pions[d].deleted&&this.boss.pions.splice(d,1)}if(this.pitboss&&(b.attacker="die",b.setObjectSpawn=this.objSpawn,b.deleted=!0,b.pions&&b.pions.length))for(d=0;d<b.pions.length;d++)b.pions[d].rigBody.pionState=!1,b.pions[d].rigBody.boss="";var c=a.staticAllMap.value[this.location].content;
delete c[b.label];if(c.temporaryObjectSpawn)if(d=c.temporaryObjectSpawn,d.length)for(c=0;c<d.length;c++)d[c].label===this.object.label&&d.splice(c,1);else delete c.temporaryObjectSpawn;this.cureSelf.reset();this.buff.affected.length=0;(d=this.character.rigBody)&&d.characterState&&d.monsterParameters.object.label===this.object.label&&!d.dirSwitch.forceAttackFrame&&!d.isAttacking?(a.monsterTarget="",a[this.character.stateStorage].set(this.character.label,"idle"),a.addClass(a.qs("monster-bar"),"hidden")):
d&&d.behaveRandomFn&&d.behaveRandomFn(1);d&&d.dirSwitch.reset();a.addGoldToHero.value(this);/hero/i.test(this.object.label)&&this.pitboss&&(d=a.qs("remaining-box"),c=a.qs("eliminate-box"),remainingContent=a.qs("remaining-content"),remainingMsg=a.qs("msg-remaining"),remainingContent.innerHTML="",a.qs("button-remaining").setAttribute("init","reload"),a.text(a.qs("button-remaining"),m.lang.fn("gui","btnEndgame","detail")),a.text(remainingMsg,m.lang.fn("gui","leaderDied","detail")),a.removeClass(d,"hidden"),
a.removeClass(c,m.lang.fn("gui","bgPop","towersLeft")),a.removeClass(c,m.lang.fn("gui","bgPop","enemiesLeft")),a.addClass(c,m.lang.fn("gui","bgPop","lose")),a.globalObjectGUI.value.audioBackground.fn("end"));this.remove=!0;a.removeTextureNpc(a.context,b);a.World.remove(a.engine.world,b);a.monsterParameters.value.remove(b.label);a.monsterGetDamage.value.remove(b.label);a[b.stateStorage].remove(b.label)}.bind(this),1E3),this.isStatic?(a.pushMsgText.value(m.lang.fn("gui","towerDied","detail"),100,"danger"),
a.infoLogFn.value({title:"regular-title",text:{yellow:m.lang.fn("gui","towerDied","detail")}})):a[b.stateStorage].set(b.label,"die"),b.behave=this.behave="die",this.audioDie&&this.audioDie.length&&a.playAudio(this.audioDie),/sekleton/i.test(c.object.label),!1)};this.generalAIBehaviours=function(c){if(!this.rigState)return!0;this.bossNeedHelp();this.characterNotExist();this.skill.updateTick();this.updateRegisterSkillFn();this.cureSelf.loot.length&&this.cureSelf.update();c=this.object;var b=c.position,
d=this.character,f=this.behave,h=this.monsterParameters;if(this.removeParamsWhenObjDeath(h,c)){this.tick++;this.turnState--;var g=a[c.stateStorage].get(c.label);!/back|attack/i.test(f)&&this.tick>this.moveIdle&&(this.tick=0,this.behaveRandom--,0>this.behaveRandom&&this.behaveRandomFn());var l=d.position,p=this.pointMove.position.x-b.x,n=this.pointMove.position.y-b.y,q=this.backRange,r=q.x,v=q.y,u=p>-r&&p<r,m=n>-v&&n<v,C=u&&m;if("back"===f)if(this.backDelay)this.backDelay--,!/textureNeedChange|idle/i.test(g)&&
a[c.stateStorage].set(c.label,"idle");else{!/textureNeedChange|walk/i.test(g)&&a[c.stateStorage].set(c.label,"walk");d=this.replaceObjectSpawnByRand.update(this.location);u=Math.round(d.position.x-b.x);if(!C&&this.dirSwitch.dirBlock.state)return this.dirSwitch.dirBlock.fn(this.pointMove.label);this.dirSwitch.tempTarget.init=!0;this.dirSwitch.reset();d=a.moveVector2dWithVelocity(c,d,this.moveSpeedNormal);a.Body.setPosition(c,{x:c.position.x+d.x,y:c.position.y+d.y});C?(q.state&&(q.state=!1,q.x=q.normalX,
q.y=q.normalY),this.backDelay=a.random(25,10),this.behaveState=!0,this.behaveRandomFn(0)):this.loopDir(u)}else if("turn"===g)a[c.stateStorage].set(c.label,"walk"),c.behave=f="walk",/left|right/i.test(c.outterWall)?(this.vector.y=0<this.vector.y?this.addSpeedForTurnAndWalk("y","min"):0>this.vector.y?this.addSpeedForTurnAndWalk("y","max"):0,this.vector.x=0<this.vector.x?this.addSpeedForTurnAndWalk("x","min"):0>this.vector.x?this.addSpeedForTurnAndWalk("x","max"):0,"right"===this.turn?this.changeLeftFn():
this.changeRightFn(),c.outterWall=""):this.vector.y=0<this.vector.y?this.addSpeedForTurnAndWalk("y","min"):0>this.vector.y?this.addSpeedForTurnAndWalk("y","max"):0,this.dirSwitch.dirBlock.reset(),this.dirSwitch.turn=!0;else if("idle"===f)!/textureNeedChange|idle/i.test(g)&&a[c.stateStorage].set(c.label,"idle");else if("pointing"===f)this.objectPointing.translate(),!/textureNeedChange|walk/i.test(g)&&a[c.stateStorage].set(c.label,"walk"),d=a.moveVector2dWithVelocity(c,this.objectPointing,2),b=c.position.x+
Math.round(d.x),d=c.position.y+Math.round(d.y),u=Math.abs(Math.round(this.objectPointing.position.x-c.position.x)),q=Math.abs(Math.round(this.objectPointing.position.y-c.position.y)),h=!0,20>u&&20>q&&(h=!1),h?a.Body.setPosition(c,{x:b,y:d}):this.behaveRandomFn(1);else if("walk"===f){!/textureNeedChange|walk/i.test(g)&&a[c.stateStorage].set(c.label,"walk");if(this.dirSwitch.dirBlock.state)return this.turnState=0,this.dirSwitch.dirBlock.fn();0>=this.turnState&&(u="left"===this.turn?this.addSpeedForTurnAndWalk("x",
"min"):this.addSpeedForTurnAndWalk("x","plus"),b=a.random(1,0)?this.addSpeedForTurnAndWalk("y","min"):this.addSpeedForTurnAndWalk("y","plus"),d=Math.abs(1-(0<u)?Math.abs(b):-Math.abs(b)),b=this.forceGravity?0:b,this.vector={x:parseFloat(u+(0<u?d:-d)/2),y:parseFloat(b)},this.loopDir(u,!0),this.turnState=a.random(600,400),this.behaveState=!0,this.dirSwitch.dirBlock.reset());this.walkState?this.walkState--:(this.stateChange=!0,this.walkState=a.random(5,5));a.Body.setPosition(c,{x:c.position.x+this.vector.x,
y:c.position.y+this.vector.y});C||(c.behave=this.behave="back",this.behaveState=!1)}else if("attack"===f)if(!this.pionState||m&&u){u=Math.round(l.x-b.x);q=Math.round(l.y-b.y);l=!0;if(this.isArcherOrMage){m=this.dirSwitch.tempTarget;var A=this.rangeMovement({object:c,target:d,targetDummy:m,distanceY:this.dungeonAttackRangeY,distanceX:this.dungeonAttackRange,distY:q,distX:u,dirSwitch:this.dirSwitch,objTranslate:this.objTranslate,speed:Math.abs(this.moveSpeed)});A.status=g;this.performAttackFrame(A,
this.dirSwitch.selectedFrame)&&(this.turnState=a.random(600,400),l=this.dirSwitch.forceAttackFrame,"trajectory"!==h.trajectoryProp.weaponEquip||l?"none"===h.trajectoryProp.weaponEquip&&this.characterDamagePool({objectAttacker:c,objectTarget:d}):this.trajectoryInit.createNormalTrajectory(this));this.dirSwitch.mainTurn||(u=Math.round(m.position.x-b.x),q=Math.round(m.position.y-b.y))}else{A=this.meleeMovement({object:c,target:d,range:this.dungeonAttackRange,distanceY:this.dungeonAttackRangeY.min,speed:Math.abs(this.moveSpeed),
forceGravity:c.forceGravity,dirSwitch:this.dirSwitch});if(l=this.dirSwitch.forceAttackFrame)A.init=!0;l=!l;this.performAttackFrame(A,this.dirSwitch.selectedFrame)&&(this.turnState=a.random(600,400),this.characterDamagePool({objectAttacker:c,objectTarget:d}))}l&&this.loopDir(u);0>this.turnState&&!this.attackTolerance(u,q)&&(c.behave=this.behave="walk",a[c.stateStorage].set(c.label,"walk"))}else c.behave=this.behave="back",this.behaveState=!1,C||q.x!==q.normalX||q.y!==q.normalY||(q.x=q.backX,q.y=q.backY,
q.state=!0);this.updateIntervalBack--||!this.boss||C||/back|attack/i.test(f)||(c.behave=this.behave="back",this.behaveState=!1,this.updateIntervalBack=600,this.backDir(p,n,r,v))}}};this.components.attackFrameAttribute=function(){this.state=!0;this.stateIndex=0;this.fn=function(c,f){this[f]||(c.dirSwitch.selectedFrame="normal",c.dirSwitch.reset(),f="normal");this.state&&(this.stateIndex=a.random(this[f].frameContent.length-1,0),this.state=!1);var b=this[f].frameContent[this.stateIndex];return b?b:
this[f].frameContent[0]}};this.components.items=function(){this.itemTemp=[];this.item=new function(){this.create=function(c,f,b,d,k){this.object=new a.createItem.value(d.name,d.width,d.height);this.object.isStatic=!0;this.firstload=function(){a.playAudio("item-pick");a.Body.setPosition(this.object,{x:c,y:f});a.intervalList[this.object.label]={tick:1E3,fn:function(){a.World.remove(a.engine.world,this.object)}.bind(this)};return null}.call(this);this.character=a.oval.value;this.update=function(d,c){var g=
d.position,f=c.position,h=Math.abs(g.y-f.y);if(40>Math.abs(g.x-f.x)&&40>h&&function(){if(k){var b=new a.items.value[k.parent][k.initial]({quantity:1});if(b.itemfor)if(d.itemException){b=0;for(var g=d.itemException;b<g.length;b++)if(g[b]===c.label)return!1}else if(c.statParameters.classType===b.itemfor||a.characterControl.bossObject.label===c.label&&"leader"===b.itemfor)console.log(c.label);else return console.log(d),d.itemException=[c.label],!1}return!0}()){d.itemVal&&(a.playAudio("item-drop"),a.infoLogFn.value({title:"regular-title",
text:{white:c.statParameters.name+m.lang.fn("gui","accuredItem","detail"),chocolate:" "+d.itemVal+" ",gold:b}}));if(k)f=k.parent,g=k.initial;else switch(f="dropMonster",b.toLowerCase()){case "ness scale":g="nessScale";break;case "ness fang":g="nessFang";break;case "queen ness scale":g="nessQueenScale";break;case "meat":g="meat";break;case "gall boar fang":g="gallBoarFang";break;case "nortus green scale":g="nortusGreenScale";break;case "nortus red scale":g="nortusRedScale";break;case "light soul":g=
"lightSoul";break;case "basic magical plant":g="basicMagicPlant";break;case "basic herb plant":g="basicHerbPlant";break;case "goblin elixir":g="goblinElixir";break;case "bedrock meat":g="bedrockMeat";break;case "bedrock bone":g="bedrockBone";break;case "bedrock fang":g="bedrockFang";break;case "lapis fragment":g="lapisFragment";break;case "nortus tail heart":g="nortusTailHeart";break;case "nortus red tail scale":g="nortusRedTailScale";break;case "nortus green tail scale":g="nortusGreenTailScale";
break;case "tainted gem":g="taintedGem";break;case "tainted soul":g="taintedSoul";break;default:g=""}a.intervalList[d.label]&&delete a.intervalList[d.label];a.pickUpDropItem.value({parent:f,initial:g,value:d.itemVal});a.World.remove(a.engine.world,d);return!0}return!1}}};this.coin=new function(){this.create=function(c,f,b){this.object=new a.createItem.value("Ness Scale",74,68);this.firstload=function(){this.object.isStatic=!0;a.Body.setPosition(this.object,{x:c,y:f});a.intervalList[this.object.label]=
{tick:3600,fn:function(){a.World.remove(a.engine.world,this.object)}.bind(this)};return null}.call(this);this.character=a.oval.value;this.update=function(b,c){var d=b.position,g=c.position,f=a.characterParameters.value,k=d.y;rangeX=Math.abs(d.x-g.x);rangeY=Math.abs(k-g.y);return 40>rangeX&&40>rangeY?(b.coinVal&&(f.gold+=b.coinVal,a.playAudio("Pickup_Gold_04"),a.infoLogFn.value({title:"regular-title",text:{white:"Accured",chocolate:" "+b.coinVal+" ",gold:"Gold"}})),a.World.remove(a.engine.world,b),
!0):!1}}}};this.components.buff=function(){this.buff=new function(){this.affected=[];this.isOval=!1;this.check=function(a,f){for(var b=0;b<this.affected.length;b++)if(this.affected[b].skill.toLowerCase()===f.toLowerCase())return!0;return!1};this.gui=function(c,f,b){if("add"===c)c=document.createElement("div"),c.className="buff-skill "+b,c.id=f,f=document.createElement("span"),c.appendChild(f),a.buffBox.insertBefore(c,a.buffBox.firstChild);else if("remove"===c)for(b=a.slice(a.buffBox.getElementsByTagName("div")),
c=0;c<b.length;c++)if(b[c].id===f){b[c].remove();break}};this.guiGl=function(){for(var c=this.affected,f=c.length,b=11*(f-1),d=0;d<f;d++){var k=c[d];k.drawFn.update({gl:a.context,image:k.image.textures,posX:k.target.x-22*d+b,posY:k.boundMin.y-k.boundY,imagePosY:k.imagePosY,imagePosX:k.imagePosX,scaleX:k.scaleX,scaleY:k.scaleY,offsetX:k.offsetX,offsetY:k.offsetY,scaleBefore:k.scaleBefore})}};this.glProp=function(c,f){var b=c.paramsTarget.object;this.image={textures:"",src:a.path+f};a.getTexture(this.image,
this.image.src);this.drawFn=new a.draw.generalDrawImage;this.boundY=b.additionalBoundsValue?b.additionalBoundsValue:0;this.imagePosY=-42;this.scaleY=this.scaleX=this.scaleBefore=this.imagePosX=0;this.offsetY=this.offsetX=.1;this.boundMin=b.bounds.min;this.target=b.position};this.unregister=function(a,f){for(var b=0,d=a.paramsTarget.activeSkill;b<d.length;b++)d[b]===a.skill&&d.splice(b,1);delete a.paramsAttacker.buffSkill[a.skill];this.affected.splice(f,1)};this.register=function(c){if(c.paramsAttacker.buffSkill){var f=
c.seletedBuff,b;a:for(b in f){if(!c.paramsTarget.object||!c.paramsAttacker.object)continue a;var d=c.paramsTarget.object.rigBody,k=c.paramsAttacker.object.rigBody,h=f[b];if(this.check(h,b)||!h.icon||h.chance<=100*Math.random()||d.isStatic||function(){var a=d.isEnemyFn(k.object.label);return h.castedToAlly?a:!a}())continue a;var g=a.uniqueId();c.paramsTarget.activeSkill.push(f[b].name);this.isOval=c.paramsTarget.object.label===a.oval.value.label;f={skill:h.name,tick:h.tick,id:g,interval:h.interval,
intervalUpdate:h.intervalUpdate,callbackStart:h.callbackStart?h.callbackStart:function(){},callbackEnd:h.callbackEnd?h.callbackEnd:function(){},paramsTarget:c.paramsTarget,paramsAttacker:c.paramsAttacker,affected:this.affected};this.setDelayToAttacker(h);this.affected.push(a.extend(f,new this.glProp(c,h.icon)));return!1}}return!0};this.setDelayToAttacker=function(a){if(this.affected.length){if(a.paramsAttacker){for(var c=a.paramsAttacker.activeSkill,b=0;b<c.length;b++)if(c[b]===a.skill)return!0;c.push(a.skill)}return!0}};
this.update=function(){var a=this.affected;a.length&&this.guiGl();for(var f=0;f<a.length;f++){var b=a[f];b.tick--;0>b.tick?(b.callbackEnd(b),this.setDelayToAttacker(b),this.unregister(b,f)):(b.interval--,0>b.interval&&(b.callbackStart(b),b.interval=b.intervalUpdate))}}}};this.components.objPropertyFn=function(){this.abilityCritical=function(a,f,b){var d=a.modifierAbilities&&a.modifierAbilities.criticalChance?a.modifierAbilities.criticalChance:0,c=b?b.criticalPercentage:0;b=b?b.critical:0;return 0<
d+c&&100*Math.random()<=d+c?Math.round(f*((a.modifierAbilities&&a.modifierAbilities.critical?a.modifierAbilities.critical:0)+b)/100):0};this.abilityBlock=function(a){var c=[];if(a.abilitySkill){a=a.abilitySkill;for(var b in a)"block"===b&&100*Math.random()<=a[b]&&c.push(b)}return c};this.abilityMagicDefense=function(c,f){var b=f;c.abilitySkill&&c.abilitySkill.magicDefense&&(b=c.abilitySkill.magicDefense,b=a.random(b.max,b.min),b=f-f*b/100,b=0<b?b:Math.round(a.random(100,50)/2));return Math.round(b)};
this.abilityDefense=function(c,f){var b=f;c.abilitySkill&&c.abilitySkill.defense&&(b=c.abilitySkill.defense,b=a.random(b.max,b.min),b=f-f*b/100,b=0<b?b:Math.round(a.random(100,50)/2));return Math.round(b)};this.attackerAbilities=function(a){var c=[];if(a.modifierAbilities){a=a.modifierAbilities;for(var b in a)100*Math.random()<=a[b]&&c.push(b)}return c};this.monsterDamagePool=function(c){var f=c.objectAttacker,b=c.objectTarget;c=f.statParameters;var d=b.statParameters;b=b.label;if("melee"===c.attackType)var k=
c.attackMax,h=c.attackMin;else"long-range"===c.attackType&&(k=c.attackRangeMax,h=c.attackRangeMin);var g=d.defenseMax;d=d.defenseMin;k=a.random(k,h);h=a.random(g,d);h=k-h;k=this.attackerAbilities(c);h=0<h?h:Math.round(a.random(100,50)/2);g=a.monsterGetDamage.value.get(b);"undefined"===typeof g&&(a.monsterGetDamage.value.set(b,[]),g=a.monsterGetDamage.value.get(b));g.push({damage:h,status:"attack",attackerAbilities:k,attacker:f.label,attackerParameters:c})};this.forceToSwitchTurn=function(){"right"===
((this.turn?"right"===this.turn:"right"===this.monsterDir())?"right":"left")?this.changeRightFn(!0,!0):this.changeLeftFn(!0,!0)};this.previousEnemy={state:!0,name:!1};this.aggresiveTo=function(a){if(a){a=a.toLowerCase();for(var c=0,b=this.aggresive,d=b.length;c<d;c++)if(-1!==a.indexOf(b[c]))return!0;return!1}return!0};this.isEnemyFn=function(a){this.previousEnemy.name!==a&&(this.previousEnemy.name=a,this.previousEnemy.state=this.isEnemy(a));return this.previousEnemy.state};this.isEnemy=function(c){var f=
[];this.isStatic?(f=a.oval.value.rigBody.bossObject,f=[f].concat(f.pions)):this.characterState?f=[this.bossObject].concat(this.bossObject.pions):this.object.pions?f=[this.object].concat(this.object.pions):this.boss&&(f=[this.boss].concat(this.boss.pions));if(/tower/i.test(c)&&/hero/i.test(this.object.label)||/tower/i.test(this.object.label)&&/hero/i.test(c)||this.boss&&/tower/i.test(c)&&/hero/i.test(this.boss.label))return!1;if(f.length)for(var b=0;b<f.length;b++)if(c===f[b].label)return!1;return!0};
this.attackTolerance=function(a,f){var b=this.dungeonAttackRangeY,d=this.dungeonAttackRange;if(!a){if(!this.object||this.object.statParameters.mainCharacter&&(!this.monsterParameters.object||!this.monsterParameters))return!1;var c=this.object.position,h=this.object.statParameters.mainCharacter?this.monsterParameters.object.position:this.character.position;a=Math.round(h.x-c.x);f=Math.round(h.y-c.y)}return f>=b.max&&f<b.min&&a>-d&&a<d};this.characterDamagePool=function(c){if(c.objectTarget.statParameters.mainCharacter){var f=
a.characterGetDamage.value.get(c.objectTarget.label);f.push(c.objectAttacker.statParameters);a.characterGetDamage.value.set(c.objectAttacker.label,f)}else this.monsterDamagePool(c)};this.stunEffect=new function(){this.init=!1;this.fn=function(c,f){var b=this,d=f.rigBody;b.init=!0;f.behave=d.behave="idle";a[f.stateStorage].set(f.label,"idle");switch(c){case "long":var k=100;break;case "short":k=20}var h=a.intervalList[f.label];h?h.tick=k:a.intervalList[f.label]={tick:k,fn:function(){b.init=!1;d.dirSwitch.reset();
f.behave=d.behave="attack"}}}};this.createAreaDamagePool=function(c){var f=a.staticAreaDmg.value(c.target.position,c.width,c.height);f.caster=c.caster;a.areaDmgPool.value.set(f.label,f);a.monsterControl.triggerMonsterFn("area");a.characterControl.areaDamageFn();c=a.areaDmgPool.value.get(f.label);a.areaDmgPool.value.remove(f.label);return c.monsterParameters};this.partyRandomHelp=new function(){this.partyRandomHelpTick=0;this.update=function(c){0===this.partyRandomHelpTick&&(this.partyRandomHelpTick=
a.random(7,3));if(0<this.partyRandomHelpTick&&(this.partyRandomHelpTick--,1===this.partyRandomHelpTick)){var f=[];c.boss?(f.push(c.boss),c.boss.pions&&f.concat(c.boss.pions)):c.pitboss?(f.push(c.object),c.object.pions&&f.concat(c.object.pions)):c.bossObject&&(f.push(c.bossObject),c.bossObject.pions&&f.concat(c.object.pions));for(var b=0;b<f.length;b++)f[b].label!==c.object.label&&"attack"!==f[b].behave||f.splice(b,1);f.length&&(f=f[a.random(f.length-1,0)],f.rigBody&&(f.rigBody.forceObjectToAttack(c.characterState?
c.monsterParameters.object:c.character,!0),f.rigBody.object.selected=!1,f.rigBody.behaveState=!0))}}};this.checkObjectOutterWall=function(){if(!this.isStatic){var c=this.object.position,f=a.staticWallOutter.value(),b=f[1].bounds.min.y,d=f[2].bounds.min.x,k=f[3].bounds.max.x;c.y>f[0].bounds.max.y&&c.y<b&&c.x<d&&c.x>k||(c=a.random(100,-100),f=a.random(100,-100),b=this.pointMove.position,a.Body.setPosition(this.object,{x:b.x+c,y:b.y+f}))}}};this.components.companions=function(c){this.triggerMonsterFn=
function(c){for(var b=a.activeMap.value,d=function(a){switch(c){case "area":a.areaDamageFn();break;case "aggresive":a.toAggresive();break;case "update":a.manualUpdate(),a.checkObjectOutterWall()}},f=0,h=this.objSpawnMonster;f<h.length;f++)for(var g=h[f],l=0;l<g.length;l++){var p=g[l];if(p)if(p.monsters){if(b===p.location)for(var n=0;n<p.monsters.length;n++)d(p.monsters[n].play)}else d(p.play)}}};this.components.initArmored=function(c){return function(f){f.spell&&(this.spell=c.spell,this.itemLabel=
f.itemLabel,this.disableExtendMap=!0);this.avatar=c.avatar?c.avatar:"chara.png";this.hero=c.hero;this.aggresive=c.aggresive;this.isArcherOrMage=!1;this.audioDie=c.audioDie;this.attackFrame=c.attackFrame;this.pitboss=f.pitboss;this.location=f.location;this.inventory=c.inventory;this.objSpawn=f.objSpawn;this.dungeonAttackRange=c.attackRange;this.dungeonAttackRangeY={max:-30,min:30};this.moveSpeedAttack=c.moveSpeedAttack;this.moveSpeedNormal=c.moveSpeedNormal;this.initialSpeedNormal=c.initialSpeedNormal;
this.initialAttackDelay=c.initialAttackDelay;this.monsterParameters={name:c.name,level:c.level,monsterLevel:c.monsterLevel,gold:c.gold?c.gold:0,health:c.maxHealth,maxHealth:c.maxHealth,maxHealthCure:c.maxHealth,mp:c.mp,maxMp:c.mp,maxMpCure:c.mp,range:c.attackRange,attackRangeMax:c.attackRangeMax,attackRangeMin:c.attackRangeMin,attackMax:c.attackMax,attackMin:c.attackMin,defenseMax:c.defenseMax,defenseMin:c.defenseMin,magicDefenseMax:c.magicDefenseMax,magicDefenseMin:c.magicDefenseMin,modifierAbilities:c.modifierAbilities?
a.extend({},c.modifierAbilities,!0):{},activeSkill:[],buffSkill:{},abilitySkill:c.abilitySkill?a.extend({},c.abilitySkill,!0):{},coin:a.monsterAttribute.value(c.level,"soul")||a.random(15,5),item:c.item||"",exp:a.monsterAttribute.value(c.level,"exp")||a.random(25,50),attackType:"melee",classType:"meleeArmor",object:""};this.statInitial=function(){this.stat(c.hpBar)&&("back"===this.behave&&(this.pathState=!1,this.posCapture.position.y=0),this.object.behave=this.behave="attack")};this.update=function(b,
d,f,h,g,l,p){this.install||(a.extend(this,new a.components.monster,!0),a.extend(this,new a.components.monsterDungeon(this),!0),a.extend(this,new a.AI.pathFinding,!0),a.extend(this,new a.AI.attackBehaviour("melee"),!0),a.extend(this.attackFrame,new a.components.attackFrameAttribute,!0),this.initialSpeedAttack=c.initialSpeedAttack,this.dirSwitch.attackDelayPerFrameReplace=c.initialSpeedAttack,this.requireInstall(b,d,f,h,g,l,p));this.statInitial();this.generalAIBehaviours();return this.remove}}};this.components.initSpear=
function(c){return function(f){this.avatar=c.avatar?c.avatar:"chara.png";this.hero=c.hero;this.audioDie=c.audioDie;this.attackFrame=c.attackFrame;this.pitboss=f.pitboss;this.location=f.location;this.inventory=c.inventory;this.objSpawn=f.objSpawn;this.dungeonAttackRange=c.attackRange;this.dungeonAttackRangeY={max:-30,min:30};this.aggresive=c.aggresive;this.isArcherOrMage=!1;this.moveSpeedAttack=c.moveSpeedAttack;this.moveSpeedNormal=c.moveSpeedNormal;this.initialSpeedNormal=c.initialSpeedNormal;this.initialAttackDelay=
c.initialAttackDelay;this.monsterParameters={name:c.name,level:c.level,monsterLevel:c.monsterLevel,gold:c.gold?c.gold:0,health:c.maxHealth,maxHealth:c.maxHealth,maxHealthCure:c.maxHealth,mp:c.mp,maxMp:c.mp,maxMpCure:c.mp,range:c.attackRange,attackRangeMax:c.attackRangeMax,attackRangeMin:c.attackRangeMin,attackMax:c.attackMax,attackMin:c.attackMin,defenseMax:c.defenseMax,defenseMin:c.defenseMin,magicDefenseMax:c.magicDefenseMax,magicDefenseMin:c.magicDefenseMin,modifierAbilities:c.modifierAbilities?
a.extend({},c.modifierAbilities,!0):{},activeSkill:[],buffSkill:{},abilitySkill:c.abilitySkill?a.extend({},c.abilitySkill,!0):{},coin:a.monsterAttribute.value(c.level,"soul"),item:c.item||"",exp:a.monsterAttribute.value(c.level,"exp"),attackType:"melee",classType:"meleeSpear",object:""};this.statInitial=function(){this.stat(c.hpBar)&&("back"===this.behave&&(this.pathState=!1,this.posCapture.position.y=0),this.object.behave=this.behave="attack")};this.update=function(b,d,f,h,g,l,p){this.install||(a.extend(this,
new a.components.monster,!0),a.extend(this,new a.components.monsterDungeon(this),!0),a.extend(this,new a.AI.pathFinding,!0),a.extend(this,new a.AI.attackBehaviour("melee"),!0),a.extend(this.attackFrame,new a.components.attackFrameAttribute,!0),this.initialSpeedAttack=c.initialSpeedAttack,this.dirSwitch.attackDelayPerFrameReplace=c.initialSpeedAttack,this.requireInstall(b,d,f,h,g,l,p));this.statInitial();this.generalAIBehaviours();return this.remove}}};this.components.initMage=function(c){return function(f){this.avatar=
c.avatar?c.avatar:"chara.png";this.hero=c.hero;this.audioDie=c.audioDie;this.attackFrame=c.attackFrame;this.pitboss=f.pitboss;this.location=f.location;this.inventory=c.inventory;this.objSpawn=f.objSpawn;this.aggresive=c.aggresive;this.isArcherOrMage=!0;this.dungeonAttackRange=function(){var b=a.browserWidthUpdate/2;return b<c.attackRange?b:c.attackRange}();this.dungeonAttackRangeY={max:-130,min:130};this.moveSpeedAttack=c.moveSpeedAttack;this.moveSpeedNormal=c.moveSpeedNormal;this.initialSpeedNormal=
c.initialSpeedNormal;this.initialAttackDelay=c.initialAttackDelay;this.monsterParameters={name:c.name,level:c.level,monsterLevel:c.monsterLevel,gold:c.gold?c.gold:0,health:c.maxHealth,maxHealth:c.maxHealth,maxHealthCure:c.maxHealth,mp:c.mp,maxMp:c.mp,maxMpCure:c.mp,range:c.attackRange,attackRangeMax:c.attackRangeMax,attackRangeMin:c.attackRangeMin,attackMax:c.attackMax,attackMin:c.attackMin,defenseMax:c.defenseMax,defenseMin:c.defenseMin,magicDefenseMax:c.magicDefenseMax,magicDefenseMin:c.magicDefenseMin,
modifierAbilities:c.modifierAbilities?a.extend({},c.modifierAbilities,!0):{},coin:a.monsterAttribute.value(c.level,"soul"),item:c.item,exp:a.monsterAttribute.value(c.level,"exp"),activeSkill:[],buffSkill:{},abilitySkill:c.abilitySkill?a.extend({},c.abilitySkill,!0):{},attackType:"long-range",classType:"mage",object:"",trajectoryProp:c.trajectoryProp};this.statInitial=function(){this.stat(c.hpBar)&&("back"===this.behave&&(this.pathState=!1,this.posCapture.position.y=0),this.object.behave=this.behave=
"attack")};this.update=function(b,d,f,h,g,l,p){this.install||(a.extend(this.attackFrame,new a.components.attackFrameAttribute,!0),a.extend(this,new a.components.monster,!0),a.extend(this,new a.components.monsterDungeon(this),!0),a.extend(this,new a.AI.pathFinding,!0),a.extend(this,new a.AI.attackBehaviour("range"),!0),this.object.pionNeedHelp=!1,this.initialSpeedAttack=c.initialSpeedAttack,this.dirSwitch.attackDelayPerFrameReplace=c.initialSpeedAttack,this.requireInstall(b,d,f,h,g,l,p));this.statInitial();
this.generalAIBehaviours();return this.remove}}};this.components.initArhcer=function(c){return function(f){f.spell&&(this.spell=c.spell,this.itemLabel=f.itemLabel,this.disableExtendMap=!0);this.avatar=c.avatar?c.avatar:"chara.png";this.hero=c.hero;this.aggresive=c.aggresive;this.isArcherOrMage=!0;this.audioDie=c.audioDie;this.attackFrame=c.attackFrame;this.pitboss=f.pitboss;this.location=f.location;this.inventory=c.inventory;this.objSpawn=f.objSpawn;this.dungeonAttackRange=function(){var b=a.browserWidthUpdate/
2;return 600>b?b:600}();this.dungeonAttackRangeY={max:0,min:a.random(180,100)};this.moveSpeedAttack=c.moveSpeedAttack;this.moveSpeedNormal=c.moveSpeedNormal;this.initialSpeedNormal=c.initialSpeedNormal;this.initialAttackDelay=c.initialAttackDelay;this.monsterParameters={name:c.name,level:c.level,monsterLevel:c.monsterLevel,gold:c.gold?c.gold:0,health:c.maxHealth,maxHealth:c.maxHealth,maxHealthCure:c.maxHealth,mp:c.mp,maxMp:c.mp,maxMpCure:c.mp,range:c.attackRange,attackRangeMax:c.attackRangeMax,attackRangeMin:c.attackRangeMin,
attackMax:c.attackMax,attackMin:c.attackMin,defenseMax:c.defenseMax,defenseMin:c.defenseMin,magicDefenseMax:c.magicDefenseMax,magicDefenseMin:c.magicDefenseMin,coin:a.monsterAttribute.value(c.level,"soul"),item:c.item,exp:a.monsterAttribute.value(c.level,"exp"),activeSkill:[],buffSkill:{},abilitySkill:c.abilitySkill?a.extend({},c.abilitySkill,!0):{},modifierAbilities:c.modifierAbilities?a.extend({},c.modifierAbilities,!0):{},attackType:"long-range",classType:"archer",object:"",trajectoryProp:c.trajectoryProp};
this.statInitial=function(){this.stat(c.hpBar)&&("back"===this.behave&&(this.pathState=!1,this.posCapture.position.y=0),this.object.behave=this.behave="attack")};this.update=function(b,d,f,h,g,l,p){this.install||(a.extend(this.attackFrame,new a.components.attackFrameAttribute,!0),a.extend(this,new a.components.monster,!0),a.extend(this,new a.components.monsterDungeon(this),!0),a.extend(this,new a.physicsComponent.itemTrajectoryComponent,!0),a.extend(this,new a.AI.pathFinding,!0),a.extend(this,new a.AI.attackBehaviour("range"),
!0),this.initialSpeedAttack=c.initialSpeedAttack,this.dirSwitch.attackDelayPerFrameReplace=c.initialSpeedAttack,this.requireInstall(b,d,f,h,g,l,p));if(this.trajectoriesUpdate.length)for(g=this.object.position,l=this.object.statParameters.trajectoryProp,b=this.turn,h=this.trajectoriesUpdate,"right"===b?(f=g.y-l.posY,d=g.x+l.posX,g=110):(d=g.x-l.posX,f=g.y-l.posY,g=250),l=0;l<h.length;l++)h[l].update(d,f,g,b,this.character)&&h.splice(l,1);this.statInitial();this.generalAIBehaviours();return this.remove}}};
this.components.initStatic=function(c){return function(f){this.avatar=c.avatar?c.avatar:"chara.png";this.hero=c.hero;this.isStatic=!0;this.temporaryObjectSpawn=c.temporaryObjectSpawn;this.audioDie=c.audioDie;this.attackFrame=c.attackFrame;this.pitboss=f.pitboss;this.location=f.location;this.objSpawn=f.objSpawn;this.inventory=c.inventory;this.aggresive=c.aggresive;this.initialAttackDelay=c.initialAttackDelay;this.dungeonAttackRange=function(){var b=a.browserWidthUpdate/2;return b<c.attackRange?b:c.attackRange}();
this.dungeonAttackRangeY={max:-130,min:130};this.moveSpeedAttack=c.moveSpeedAttack;this.moveSpeedNormal=c.moveSpeedNormal;this.initialSpeedNormal=c.initialSpeedNormal;this.monsterParameters={name:c.name,level:c.level,monsterLevel:c.monsterLevel,gold:c.gold?c.gold:0,health:c.maxHealth,maxHealth:c.maxHealth,maxHealthCure:c.maxHealth,mp:c.mp,maxMp:c.mp,maxMpCure:c.mp,range:c.attackRange,attackRangeMax:c.attackRangeMax,attackRangeMin:c.attackRangeMin,attackMax:c.attackMax,attackMin:c.attackMin,defenseMax:c.defenseMax,
defenseMin:c.defenseMin,magicDefenseMax:c.magicDefenseMax,magicDefenseMin:c.magicDefenseMin,modifierAbilities:c.modifierAbilities?a.extend({},c.modifierAbilities,!0):{},coin:a.monsterAttribute.value(c.level,"soul"),item:c.item,exp:a.monsterAttribute.value(c.level,"exp"),activeSkill:[],buffSkill:{},abilitySkill:c.abilitySkill?a.extend({},c.abilitySkill,!0):{},attackType:"long-range",classType:"static",object:"",trajectoryProp:c.trajectoryProp};this.staticBehave={tick:50,health:this.monsterParameters.health};
this.update=function(b,d,f,h,g,l,p){this.install||(a.extend(this,new a.components.monster,!0),a.extend(this,new a.components.monsterDungeon(this),!0),a.extend(this,new a.AI.pathFinding,!0),this.object.pionNeedHelp=!1,this.initialSpeedAttack=c.initialSpeedAttack,this.dirSwitch.attackDelayPerFrameReplace=c.initialSpeedAttack,this.requireInstall(b,d,f,h,g,l,p),this.object.behave=this.behave="idle",this.object.quest={update:[this.object.label],mapMark:new a.draw.mapMark,target:"tower"},setTimeout(function(){a[this.object.stateStorage].set(this.object.label,
"idle")}.bind(this),100));this.staticBehave.tick?this.staticBehave.tick--:(this.monsterParameters.health!==this.staticBehave.health?(this.staticBehave.health=this.monsterParameters.health,this.object.staticBehave="attack"):this.object.staticBehave="idle",this.staticBehave.tick=50);this.stat(c.hpBar);this.skill.updateTick();this.updateRegisterSkillFn();this.removeParamsWhenObjDeath(this.monsterParameters,this.object);return this.remove}}}};t.animation=function(a){window.scope=this;scope.fn=new a.utils;
for(var c={screen:scope.fn.qs("screen"),canvas:scope.fn.id("canvas"),browserWidthUpdate:a.browserWidth(),browserHeightUpdate:a.browserHeight(),deltaTime:"",fps:33,blockRender:!1,isSwitchMapActive:!1,context:function(){var a=scope.fn.id("canvas").getContext("webgl",{premultipliedAlpha:!1});a.enable(a.BLEND);a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0);a.blendFunc(a.ONE,a.ONE_MINUS_SRC_ALPHA);return a}(),canvasStatus:"play",path:"assets/2d/",monsterTarget:"",Engine:Matter.Engine,Composite:Matter.Composite,
Composites:Matter.Composites,Constraint:Matter.Constraint,World:Matter.World,Runner:Matter.Runner,Bodies:Matter.Bodies,Events:Matter.Events,Svg:Matter.Svg,Vertices:Matter.Vertices,orderObj:[],Body:Matter.Body,fragment:[],svgCount:{current:0,tot:0},objFragment:{},bugTranslate:1,webglUtils:{error:function(a){console.log(a)},createProgram:function(a,b){var d=a.createProgram();b.forEach(function(b){a.attachShader(d,b)});a.linkProgram(d);if(!a.getProgramParameter(d,a.LINK_STATUS)){var c=a.getProgramInfoLog(d);
errFn("Error in program linking:"+c);a.deleteProgram(d);return null}return d},loadShader:function(a,b,c){c=a.createShader(c);a.shaderSource(c,b);a.compileShader(c);return a.getShaderParameter(c,a.COMPILE_STATUS)?c:(b=a.getShaderInfoLog(c),this.errFn("*** Error compiling shader '"+c+"':"+b),a.deleteShader(c),null)},createShaderFromScript:function(a,b,c){var d=document.getElementById(b);if(!d)throw"*** Error: unknown script element"+b;b=d.text;if(!c)if("x-shader/x-vertex"===d.type)var f=a.VERTEX_SHADER;
else if("x-shader/x-fragment"===d.type)f=a.FRAGMENT_SHADER;else if(f!==a.VERTEX_SHADER&&f!==a.FRAGMENT_SHADER)throw"*** Error: unknown shader type";return this.loadShader(a,b,c?c:f)},createProgramFromScripts:function(a,b){for(var d=[],c=["VERTEX_SHADER","FRAGMENT_SHADER"],f=0;f<b.length;++f)d.push(this.createShaderFromScript(a,b[f],a[c[f]]));return this.createProgram(a,d)},webglCreateLineShader:function(a,b,c){for(var d=0,f=c.length;d<f;d++){var h=c[d].prop,k=b.webglUtils.createProgramFromScripts(a,
c[d].shader);b[h].value={program:k}}},webglCreateTexShader:function(a,b,c){for(var d=0,f=c.length;d<f;d++){var h=c[d].prop,k=b.webglUtils.createProgramFromScripts(a,c[d].shader),q=a.getAttribLocation(k,"a_position"),r=a.getAttribLocation(k,"a_texcoord"),v=a.getUniformLocation(k,"u_matrix"),u=a.getUniformLocation(k,"u_textureMatrix"),m=a.getUniformLocation(k,"u_texture"),C=a.getUniformLocation(k,"u_alpha"),A=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,A);a.useProgram(k);a.uniform1f(C,1);a.bufferData(a.ARRAY_BUFFER,
new Float32Array([0,0,0,1,1,0,1,0,0,1,1,1]),a.STATIC_DRAW);var D=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,D);a.bufferData(a.ARRAY_BUFFER,new Float32Array([0,0,0,1,1,0,1,0,0,1,1,1]),a.STATIC_DRAW);a.enableVertexAttribArray(q);a.vertexAttribPointer(q,2,a.FLOAT,!1,0,0);a.enableVertexAttribArray(r);a.vertexAttribPointer(r,2,a.FLOAT,!1,0,0);b[h].value={program:k,positionLocation:q,texcoordLocation:r,matrixLocation:v,textureLocation:m,textureMatrixLocation:u,positionBuffer:A,texcoordBuffer:D,alphaLocation:C}}}},
webglM4:{orthographic:function(a,b,c,g,f,p,n){n=n||new Float32Array(16);n[0]=2/(b-a);n[1]=0;n[2]=0;n[3]=0;n[4]=0;n[5]=2/(g-c);n[6]=0;n[7]=0;n[8]=0;n[9]=0;n[10]=2/(f-p);n[11]=0;n[12]=(a+b)/(a-b);n[13]=(c+g)/(c-g);n[14]=(f+p)/(f-p);n[15]=1;return n},translation:function(a,b,c,g){g=g||new Float32Array(16);g[0]=1;g[1]=0;g[2]=0;g[3]=0;g[4]=0;g[5]=1;g[6]=0;g[7]=0;g[8]=0;g[9]=0;g[10]=1;g[11]=0;g[12]=a;g[13]=b;g[14]=c;g[15]=1;return g},translate:function(a,b,c,g,f){f=f||new Float32Array(16);var d=a[0],h=
a[1],k=a[2],l=a[3],v=a[4],u=a[5],m=a[6],C=a[7],A=a[8],D=a[9],E=a[10],W=a[11],J=a[12],t=a[13],G=a[14],P=a[15];a!==f&&(f[0]=d,f[1]=h,f[2]=k,f[3]=l,f[4]=v,f[5]=u,f[6]=m,f[7]=C,f[8]=A,f[9]=D,f[10]=E,f[11]=W);f[12]=d*b+v*c+A*g+J;f[13]=h*b+u*c+D*g+t;f[14]=k*b+m*c+E*g+G;f[15]=l*b+C*c+W*g+P;return f},scaling:function(a,b,c,g){g=g||new Float32Array(16);g[0]=a;g[1]=0;g[2]=0;g[3]=0;g[4]=0;g[5]=b;g[6]=0;g[7]=0;g[8]=0;g[9]=0;g[10]=c;g[11]=0;g[12]=0;g[13]=0;g[14]=0;g[15]=1;return g},scale:function(a,b,c,g,f){f=
f||new Float32Array(16);f[0]=b*a[0];f[1]=b*a[1];f[2]=b*a[2];f[3]=b*a[3];f[4]=c*a[4];f[5]=c*a[5];f[6]=c*a[6];f[7]=c*a[7];f[8]=g*a[8];f[9]=g*a[9];f[10]=g*a[10];f[11]=g*a[11];a!==f&&(f[12]=a[12],f[13]=a[13],f[14]=a[14],f[15]=a[15]);return f},zRotate:function(a,b,c){c=c||new Float32Array(16);var d=a[0],f=a[1],k=a[2],h=a[3],q=a[4],r=a[5],v=a[6],u=a[7],m=Math.cos(b);b=Math.sin(b);c[0]=m*d+b*q;c[1]=m*f+b*r;c[2]=m*k+b*v;c[3]=m*h+b*u;c[4]=m*q-b*d;c[5]=m*r-b*f;c[6]=m*v-b*k;c[7]=m*u-b*h;a!==c&&(c[8]=a[8],c[9]=
a[9],c[10]=a[10],c[11]=a[11],c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15]);return c}},layer:{fnEnvi:function(a,b){for(var d=0,c=b.layer.object;d<c.length;d++)"add"===a?(scope.Body.setPosition(c[d],{x:b.x+c[d].FixedPosition.x,y:b.y+c[d].FixedPosition.y}),scope.Composite.addBody(scope.engine.world,c[d])):"remove"===a&&scope.World.remove(scope.engine.world,c[d]);scope.orderObjectFn.value()},environment:function(a,b,c){b.appear&&!b.layer.init?(this.fnEnvi("add",{body:b,x:b.x,y:b.yMax(),layer:b.layer}),
b.layer.init=!0):!b.appear&&b.layer.init&&(this.fnEnvi("remove",{layer:b.layer}),b.layer.init=!1)},bgStorage:[],isVisible:function(a){var b=scope.browserHeightUpdate;return a.x<scope.browserWidthUpdate&&0<a.xMax()&&a.y<b&&0<a.yMax()},fnBackgr:function(a){for(var b=this.bgStorage,d=[],c=0;c<b.length;c++){var f=b[c];if(this.isVisible(f)){var p=f.neighbor,n;for(n in p){var q=p[n],r;a:{for(r=0;r<b.length;r++)if(b[r].label===q.label){r=!1;break a}switch(n){case "right":q.y=f.y;q.x=f.x+500;break;case "left":q.y=
f.y;q.x=f.x-500;break;case "top":q.y=f.y-500;q.x=f.x;break;case "bottom":q.y=f.y+500,q.x=f.x}r=this.isVisible(q)?!0:!1}r&&this.bgStorage.push(q)}0>=a.tickMap&&a.isTranslate&&f.translate({x:a.staticMoveX,y:a.staticMoveY});a.shakeLen&&(p=a.isShake.shakeCnt[0],f.translate({x:p.posX,y:p.posY}));f.update()}else d.push(c)}for(c=0;c<d.length;c++)this.bgStorage.splice(d[c],1)},background:function(a){for(var b=this.bgStorage.length=0;b<a.length;b++){var d=a[b];d.resetPos();if(this.isVisible(d)||!d.install||
d.visible)d.update(scope.context),this.bgStorage.push(d)}}},currentMap:"mapA",tickMap:0,tickMinute:6,staticGeometry:{storageMap:"",storagePassBG:[],storagePassBGAfterObject:[],storagePortal:"",storageSVGPathBuffer:"",storageSVGLineBuffer:"",storageLayer:"",storage:"",returnGeometry:function(a,b,c){a="svg"===c?this.storageSVGPathBuffer.get(a):"portal"===c?this.storagePortal.get(a):this.storage.get(a);for(c=0;c<a.length;c++)if(a[c].label===b)return a[c]},storageFn:function(a,b,c,g){function d(d,f,k){b.push({visible:!1,
imgType:a.type||"",attach:a.attach,neighbor:!!k&&k||"",range:d||0,x:0,y:0,install:!1,drawFn:"",width:0,height:0,spawn:"",additionalHeight:a.additionalHeight&&a.additionalHeight||0,render:{img:"",src:f},resetPos:function(){this.spawn&&(this.x=this.spawn.min.x+this.range-500,this.y=this.spawn.min.y-this.height+(this.additionalHeight?this.additionalHeight:0))},xMax:function(){return this.x+this.width},yMax:function(){return this.y+this.height},update:function(b){if(this.install)this.render.img=scope.getTexture(this.render,
this.render.src),this.drawFn.update({img:this.render.textures,context:scope.context,ver:"v1",posX:this.x,posY:this.y,geoWidth:this.width,geoHeight:this.height});else{this.render.img=scope.getTexture(this.render,this.render.src);if("svg"===this.imgType)var d=scope[this.attach].value.bounds;else-1!==this.attach.indexOf("staticWallOutter")?"staticWallOutterBottom"===this.attach&&(d=scope.staticWallOutter.value()[1].bounds):d=scope[this.attach].value.bounds;this.spawn=d;this.drawFn=new scope.draw.enviOrnaments;
a.background?this.height=this.width=500:(this.width=this.render.img.width,this.height=this.render.img.height);"svg"===this.imgType?(this.x=this.spawn.min.x,this.y=this.spawn.min.y):(this.x=this.spawn.min.x+this.range-(a.repeatX?a.repeatX:0),this.y=this.spawn.min.y-this.height+(a.additionalHeight?a.additionalHeight:0));this.install=!0}},translate:function(a){this.x+=a.x;this.y+=a.y},location:g,label:a.label?a.label:c})}if(a.repeat){for(var f=a.repeat,k,h=0,r=0;r<f.length;r++){k=a.scr+f[r];var v={top:a.indexRepeat+
1<=a.layer.length-1?g+a.layer[a.indexRepeat+1][r].split(".")[0]:"",bottom:0<=a.indexRepeat-1?g+a.layer[a.indexRepeat-1][r].split(".")[0]:"",left:0<=r-1?g+f[r-1].split(".")[0]:"",right:r+1<=f.length-1?g+f[r+1].split(".")[0]:""};a.label=g+f[r].split(".")[0];d(h+=a.repeatX,k,v)}r=0;for(f=b.length;r<f;r++)for(var u in b[r].neighbor)if(v=b[r].neighbor[u],""!==v)for(k=0;k<f;k++)v===b[k].label&&(b[r].neighbor[u]=b[k])}else d(a.range,a.src)},createEnviPoint:function(a,b){var d=b.label?b.label:scope.uniqueId();
if(b.type){var c=this.storageSVGPathBuffer.get(a);c=c instanceof Array?c:[];this.storageFn(b,c,d,a);this.storageSVGPathBuffer.set(a,c)}else c=this.storage.get(a),c=c instanceof Array?c:[],this.storageFn(b,c,d,a),this.storage.set(a,c);return this.returnGeometry(a,d,b.type?"svg":"envi")},createLayer:function(a){var b=this.storageLayer.get(a.location),d=scope.uniqueId();b=b instanceof Array?b:[];b.push({x:-1E3,y:-1E3,rangeX:a.rangeX,rangeY:a.rangeY,layer:a.layer,attach:a.attach,install:!1,width:a.width,
height:a.height,xMax:function(){return this.x+this.width},yMax:function(){return this.y+this.height},update:function(a){if(!this.install){if(/staticWallOutter/i.test(this.attach)){if("staticWallOutterBottom"===this.attach)var b=scope.staticWallOutter.value()[1].bounds}else b=scope[this.attach].value.bounds;this.x=b.min.x+this.rangeX-15;this.y=b.min.y-this.height+this.rangeY-30;this.install=!0}},translate:function(a){this.x+=a.x;this.y+=a.y},color:"red",location:a.location,label:a.label?a.label:d});
this.storageLayer.set(a.location,b);return b[b.length-1]},createPortal:function(a){var b=this.storagePortal.get(a.location),d=scope.uniqueId();b=b instanceof Array?b:[];b.push({x:-1E3,y:-1E3,attach:a.attach,range:a.range||0,install:!1,delay:!0,width:a.width,height:a.height,effect:"",xMax:function(){return this.x+this.width},yMax:function(){return this.y+this.height},update:function(b){if(!this.install){if(/staticWallOutter/i.test(this.attach)){if("staticWallOutterBottom"===this.attach)var d=scope.staticWallOutter.value()[1].bounds}else d=
scope[this.attach].value.bounds;this.x=d.min.x+this.range+(a.rangeX?a.rangeX:0);this.y=d.min.y-this.height+(a.rangeY?a.rangeY:0);this.effect=a.effect?scope[a.effect]?new scope[a.effect]:"":"";this.install=!0}this.isVisible&&(this.effect?this.effect.update(b,this):(b.beginPath(),b.fillStyle=this.color,b.fillRect(this.x,this.y,this.width,this.height)))},translate:function(a){this.x+=a.x;this.y+=a.y},color:a.color,location:a.location,isVisible:"undefined"===typeof a.isVisible&&!0||a.isVisible,locationTarget:a.targetLocation?
a.targetLocation:"",spawnTarget:a.spawnTarget?a.spawnTarget:"",forceGravity:a.forceGravity,label:d});this.storagePortal.set(a.location,b);return this.returnGeometry(a.location,d,"portal")},createStoratePassBG:function(a){this[a.storage].push(new function(){this.parent=a.parent;this.bind="undefined"!==typeof a.bind?a.bind:!1;this.target=a.target;this.bgPass=!0;this.remove=!1;this.x=a.x;this.y=a.y;this.fn=a.fn;this.fn.target=this;this.xMax=function(){return this.x};this.yMax=function(){return this.y};
this.translate=function(a){this.bind?(this.x=this.target.x,this.y=this.target.y):(this.x+=a.x,this.y+=a.y,this.parent&&(this.parent.x=this.x,this.parent.y=this.y))}})},createSVGPathBuffer:function(a){var b=this.storageSVGPathBuffer.get(a.location);b=b instanceof Array?b:[];b.push({additionalSize:a.additionalSize,parentLabel:a.parentLabel,parent:"",label:a.label,vertices:a.vertices,drawLine:"",drawLineState:a.drawLine,translate:function(a){for(var b=0,d=this.vertices,c=d.length;b<c;b++)d[b].x+=a.x,
d[b].y+=a.y;this.x+=a.x;this.y+=a.y;this.maxX+=a.x;this.maxY+=a.y},xMax:function(){return this.maxX},yMax:function(){return this.maxY},install:!1,update:function(){if(this.install)this.drawLineState&&this.drawLine.update();else{for(var a=0,b=scope.Composite.allBodies(scope.engine.world);a<b.length;a++)if(b[a].label===this.parentLabel){this.parent=b[a];break}this.drawLine=new scope.drawLine(this.parent,this.vertices,"LINE_LOOP","path",this.additionalSize);a=this.parent.bounds;this.parent.setVertiecsByPoint=
this.drawLine.setVertiecsByPoint;this.x=a.min.x;this.y=a.min.y;this.maxX=a.max.x;this.maxY=a.max.y;this.install=!0}}});this.storageSVGPathBuffer.set(a.location,b)},createSVGLineBuffer:function(a){var b=this.storageSVGLineBuffer.get(a.location);b=b instanceof Array?b:[];b.push({label:a.label,vertices:a.vertices,drawLine:"",position:"",x:0,y:0,xMax:function(){return this.maxX},yMax:function(){return this.maxY},setPosition:function(a){var b=a.x;a=a.y;for(var d=0,c=this.vertices,f=c.length;d<f;d++)c[d].x+=
b,c[d].y+=a;this.x+=b;this.y+=a;this.maxX+=b;this.maxY+=a;this.position.x+=b;this.position.y+=a},translate:function(a){for(var b=0,d=this.vertices,c=d.length;b<c;b++)d[b].x+=a.x,d[b].y+=a.y;this.x+=a.x;this.y+=a.y;this.maxX+=a.x;this.maxY+=a.y;this.position.x+=a.x;this.position.y+=a.y},install:!1,update:function(){if(this.install)this.drawLine.update();else{var b=this.vertices,d=scope.Vertices.centre(b);this.xMax=function(){return this.maxX};this.yMax=function(){return this.maxY};var c=scope.AI.boundVertexToIndex(b);
this.position=d;this.x=b[c.min.x].x;this.y=b[c.min.y].y;this.maxX=b[c.max.x].x;this.maxY=b[c.max.y].y;this.setPosition({x:a.position.x-(d.x-this.x),y:a.position.y-(d.y-this.y)});this.drawLine=new scope.drawLine(this,this.vertices,"LINE_STRIP","line");this.install=!0}}});this.storageSVGLineBuffer.set(a.location,b)},createMap:function(a){var b=this.storageMap.get(a.location),d=scope.uniqueId();b=b instanceof Array?b:[];b.push({character:"",x:-1E3,y:-1E3,visible:!0,install:!1,width:0,height:0,drawFn:"",
scaleMap:"",render:{textures:"",src:a.src},xMax:function(){return this.x+this.scaleX},yMax:function(){return this.y+this.scaleY},update:function(b){if(this.install){this.render.textures=scope.getTexture(this.render,this.render.src);var d=this.scaleMap;if(!d.close)for(this.drawFn.update({ver:"v3",image:this.render.textures,screenSizeX:scope.browserWidthUpdate,screenSizeY:scope.browserHeightUpdate,context:b,posX:this.x,posY:this.y,scaleSize:d.map,center:d.centerMap}),i=0,len=scope.orderObj.length;i<
len;i++){var c=scope.orderObj[i],f=c.rigBody;if(f){var g=(f=f.isStatic)?"attack"===c.staticBehave:!1;c.mapMark.update({ver:"v1",context:b,screenSizeX:scope.browserWidthUpdate,pos:c.position,color:c.isHero?"blue":f?"tower":"attack"===c.behave?"red":"orange",scaleSize:d.mark,center:d.centerMark,markNeedGlow:g});f&&(f=g,c.quest.mapMark.update({quest:!0,context:b,screenSizeX:scope.browserWidthUpdate,pos:c.position,characterPos:scope.characterControl.object.position,color:f?"arrowHit":"arrow",colorTarget:c.quest.target,
scaleSize:d.mark,center:d.centerMark,warning:f}))}}}else b=scope.getTexture(this.render,this.render.src),this.width=b.width,this.height=b.height,this.drawFn=new scope.draw.map,this.install=!0,this.y=this.x=0,this.mapContent=scope.staticAllMap.value[a.location].content,this.character=scope.oval.value.pions,this.scaleMap=scope.scaleMap.value},translate:function(a){this.x+=a.x;this.y+=a.y},location:a.location,label:d});this.storageMap.set(a.location,b)}},renderInit:function(){this.engine=this.Engine.create();
this.runner=this.Runner.create();this.levelHeight=this.browserHeightUpdate;this.stage=this.levelHeight/4;this.halfCenter=this.levelHeight/2;this.halfTopCenter=this.halfCenter/2;this.halfTopTop=this.halfCenter-this.halfCenter;this.halfBottom=this.halfCenter/2+this.halfCenter;this.halfBottomTop=this.halfCenter/2/2+this.halfCenter;this.halfBottomBottom=this.halfBottom+this.stage;this.halfBottomLvl2=-this.stage;this.halfCenterLvl2=-this.stage+-this.stage;this.halfTopCenterLvl2=-this.stage+-this.stage+
-this.stage;this.halfTopTopLvl2=-this.stage+-this.stage+2*-this.stage;this.halfBottomTopLvl2=(-this.stage+-this.stage)/2},resize:function(){scope.that(scope).invokeWith("_windowResize");scope.that(window).use("attachListener",["resize",function(){scope.that(scope).invokeWith("_windowResize")}])},applyGravity:function(a){if(a&&a.forceGravity&&!a.isStatic&&!a.isSleeping){var b=/staticOriPassBGBridge/i.test(a.label)?1:2;a.force.y+=a.mass*b*.001;a.force.x+=0*a.mass}},filterStrength:20,frameTime:0,lastLoop:new Date,
thisLoop:""},f=arguments,b=f.length;b--;)"function"===typeof f[b]&&(f[b].apply(null,[scope,a]),f[b].apply(null,[scope,c]),scope.staticGeometry.storage=new scope.storageState.value,scope.staticGeometry.storageLayer=new scope.storageState.value,scope.staticGeometry.storageSVGPathBuffer=new scope.storageState.value,scope.staticGeometry.storageSVGLineBuffer=new scope.storageState.value,scope.staticGeometry.storagePortal=new scope.storageState.value,scope.staticGeometry.storageMap=new scope.storageState.value,
scope.glTest={},scope.globalImagePair=new scope.storageState.value,scope.globalImage=new scope.storageState.value,scope.globalAudio=new scope.storageState.value,scope.intervalList={},scope.intervalListGlobal.value=scope.intervalList,scope.orthographic=scope.webglM4.orthographic(0,scope.canvas.width,scope.canvas.height,0,-1,1),scope.attachListener(window,"resize",function(){scope.browserWidthUpdate=scope.browserWidth();scope.browserHeightUpdate=scope.browserHeight();scope.context.viewport(0,0,scope.context.canvas.width,
scope.context.canvas.height+1);scope.orthographic=scope.webglM4.orthographic(0,scope.canvas.width,scope.canvas.height,0,-1,1);scope.objTranslate.value.isCenter.state=!0}),performance.now=performance.now||performance.mozNow||performance.msNow||performance.oNow||performance.webkitNow||Date.now,scope.webglUtils.webglCreateTexShader(scope.context,scope,[{prop:"glDrawV1nV2",shader:["drawImage-vertex-shader","drawImage-fragment-shader"]},{prop:"glDrawV3",shader:["drawImage-vertex-shader-2","drawImage-fragment-shader-2"]}]),
scope.webglUtils.webglCreateLineShader(scope.context,scope,[{prop:"glLine",shader:["line-vertex-shader","line-fragment-shader"]}]),scope.context.viewport(0,0,scope.context.canvas.width,scope.context.canvas.height+1),scope.context.clear(scope.context.COLOR_BUFFER_BIT),scope.geometries(),scope.initilizeObject(),scope.resize(),scope.statics(),scope.monster())};t.animation.prototype={play:function(){function a(k){requestAnimationFrame(a);f=k-d;f>b&&(d=k-f%b,c.blockRender||(c.drawing(),c.characterControl.update(),
c.monsterControl.update(),c.skillCasting(),c.setIntervalFn()))}var c=this,f;var b=1E3/c.fps;var d=window.performance.now();a()},drawing:function(){function a(a,b){if(a)for(var d=0;d<a.length;d++){var g=a[d];0>=c.tickMap&&v&&g.translate({x:u,y:m});if(g.x<C&&0<g.xMax()&&g.y<A&&0<g.yMax()||!g.install||g.visible){if(r){var k=q.shakeCnt[0];g.translate({x:k.posX,y:k.posY})}g.bgPass?g.fn.update(f,g.parent)&&(g.remove=!0):(g.appear=!0,g.update(f),g.layer&&c.layer.environment(c.currentMap,g))}else g.appear&&
(g.appear=!1,g.layer&&c.layer.environment(c.currentMap,g))}}var c=this,f=c.context,b=c.objDrawTranslate,d=c.activeMap.value,k=c.currentMap!==d,h=c.mainCharacter,g=c.orderObj;var l=b.staticObjStateX;var p=b.staticObjAllX;var n=b.staticObjStateY,q=b.isShake,r=q.shakeCnt.length,v=l||n,u=c.bugTranslate?"left"===l?b.staticObjMoveX:"right"===l?-b.staticObjMoveX:0:c.bugTranslate,m=c.bugTranslate?"up"===n?b.staticObjMoveY:"down"===n?-b.staticObjMoveY:0:c.bugTranslate,C=c.browserWidthUpdate,A=c.browserHeightUpdate,
D=!0;b=c.staticGeometry.storagePassBG;n=c.staticGeometry.storagePassBGAfterObject;c.Runner.tick(c.runner,c.engine,c.fps,{map:d});k&&(c.enviOrnaments=c.staticGeometry.storage.get(d),c.enviLayer=c.staticGeometry.storageLayer.get(d),c.enviMiniMap=c.staticGeometry.storageMap.get(d),c.storageSVGPathBuffer=c.staticGeometry.storageSVGPathBuffer.get(d),c.storageSVGLineBuffer=c.staticGeometry.storageSVGLineBuffer.get(d),c.textures(d),c.allMapContent=c.staticAllMap.value[d],c.currentMap=d,c.tickMap=10);if(-10<
c.tickMap){if(0===c.tickMap){v=p=l=!0;d=c.browserWidthUpdate/2;k=c.browserHeightUpdate/2;var E=h.position.x;h=h.position.y;var W,J;u=d-E;m=k-h}else if(-1===c.tickMap){var t=c.staticWallOutter.value(),G={overlapX:function(a){return a.bounds.min.x<C&&0<a.bounds.max.x},overlapY:function(a){return a.bounds.min.y<A&&0<a.bounds.max.y}},P=!1;d=c.browserWidthUpdate/2;k=c.browserHeightUpdate/2;E=h.position.x;h=h.position.y;for(var B=J=W=0,S=t.length;B<S;B++)/left/i.test(t[B].label)&&G.overlapX(t[B])?(W=d-
t[B].bounds.max.x-u-E,P=!0):/right/i.test(t[B].label)&&G.overlapX(t[B])?(W=d-Math.abs(t[B].bounds.min.x-u-E),P=!0):/bottom/i.test(t[B].label)&&G.overlapY(t[B])?(J=k-t[B].bounds.min.y-m+h,P=!0):/top/i.test(t[B].label)&&G.overlapY(t[B])&&(J=k-t[B].bounds.max.y-m-h,P=!0);P&&(v=p=l=!0,u=W,m=J)}c.tickMap--;c.layer.background(c.enviOrnaments);-9===c.tickMap&&(c.addClass(c.qs("loading-assets"),"hidden"),c.removeClass(c.id("nav"),"hidden"),c.removeClass(c.qs("nav-left"),"hidden"),c.removeClass(c.qs("header-nav"),
"hidden"),c.removeClass(c.qs("attack-right-nav"),"hidden"),c.removeClass(c.qs("auto-skill-nav"),"hidden"),c.removeClass(c.qs("auto-switch-nav"),"hidden"),c.removeClass(c.qs("switch-right-nav"),"hidden"),c.removeClass(c.qs("controller-appear"),"hidden"))}c.layer.fnBackgr({tickMap:c.tickMap,isTranslate:v,staticAllX:p,staticStateX:l,staticMoveX:u,staticMoveY:m,shakeLen:r,isShake:q});p=0;for(len=g.length;p<len;p++)if(l=g[p],d=l.rigBody,v&&0>=c.tickMap?(l.visible=l.bounds.min.x<C&&0<l.bounds.max.x&&l.bounds.min.y<
A&&0<l.bounds.max.y,c.Body.translate(g[p],{x:u,y:m})):l.visible||(l.visible=l.bounds.min.x<C&&0<l.bounds.max.x&&l.bounds.min.y<A&&0<l.bounds.max.y),l.visible||d){d&&!l.statParameters.mainCharacter&&(d.buff.update(),d.displayBar(),d.hitNumberFn());r&&(d=q.shakeCnt[0],c.Body.translate(g[p],{x:d.posX,y:d.posY}));if(D){a(b);for(D=0;D<b.length;D++)b[D].remove&&b.splice(D,1);D=!1}if(l.isSpriteRender||l.render.sprite&&l.render.sprite.texture)if("undefined"===typeof l.render.texture&&("itemWithAngle"===l.name?
l.render.textureFn=new c.draw.enviOrnaments:"item"===l.name?l.render.textureFn=new c.draw.generalDrawImage:(l.render.textureFn=new c.draw.monsterGeneral,l.render.prevState="idle"),l.render.texture="",l.render.renderObj={},l.opacity=1,l.isHero=/hero/i.test(l.label),l.isSpriteRender=l.render.sprite&&l.render.sprite.texture),d=l.render,k=d.sprite,E=c.getTexture(d,k.texture,!1,l.initialName),G=d.textureFn,h=d.renderObj,l.behave){if(W=l.statParameters.mainCharacter?"characterState":l.stateStorage,G=d.textureFn,
J=c[W].get(l.label),J="turn"===J?d.prevState:J,P=d.behaveRig[J],J){if(t=-1!==J.indexOf("textureNeedChange"))E=c.getTexture(d,k.texture,J,l.initialName),l.bitmap=J,c[W].set(l.label,d.prevState),P=d.behaveRig[d.prevState];h.context=f;h.ver="v3";h.positionX=l.position.x;h.positionY=l.position.y;h.image=E;h.sprite=k;h.additionalBoundsWidthValue=l.additionalBoundsWidthValue?l.additionalBoundsWidthValue:0;h.additionalBoundsHeightValue=l.additionalBoundsHeightValue;h.state=J;h.behaveRig=P;h.renderObj=d;
h.behave=l.behave;h.visible=l.visible;h.angleInRadians=l.angleInRadians?l.angleInRadians:0;!t&&(d.prevState=J);G.glProp&&(f.useProgram(G.glProp.program),f.uniform1f(G.glProp.alphaLocation,l.opacity));G.update(h)}}else"itemWithAngle"===l.name?(E=c.getTexture(d,k.texture),h.context=f,h.ver="v3",h.img=E,h.posX=0,h.posY=0,h.srcWidth=E.width,h.srcHeight=E.height,h.dstX=l.position.x-E.width/2,h.dstY=l.position.y-E.height/2,h.dstWidth=E.width,h.dstHeight=E.height,h.angleInRadians=l.angleInRadians?l.angleInRadians:
0,h.visible=!0):(E=c.getTexture(d,k.texture),h.image=E,h.gl=f,h.imagePosX=0,h.imagePosY=0,h.posX=l.position.x,h.posY=l.position.y,h.scaleBefore=0,h.scaleX=0,h.scaleY=0,h.offsetX=.1,h.offsetY=.1,h.visible=l.visible),G.update(h);l.src&&(E=c.allMapContent.textures,h=E.renderObj,h.isVisible=l.visible,h.label=l.label,h.context=f,h.posX=l.bounds.min.x,h.posY=l.bounds.min.y,h.fixedBounds={bool:l.fixedBounds&&!0||!1,value:l.fixedBounds},h.object=l,E.update(h));c.applyGravity(l)}else l.visible&&(l.visible=
!1);a(n);for(D=0;D<n.length;D++)n[D].remove&&n.splice(D,1);a(c.storageSVGPathBuffer);a(c.enviLayer);a(c.enviMiniMap);r&&q.shakeCnt[0].update()&&q.shakeCnt.splice(0,1)},textures:function(a){var c=this,f=c.path+"1px.png",b=c.staticAllMap.value[a].content,d={};if(c.staticAllMap.value[a].textures)return!0;for(var k in b)if(k in b){var h={};if(b[k]instanceof Array)for(var g=0;g<b[k].length;g++)if(/layer/i.test(k)&&b[k][g].layer)for(var l=0,p=b[k][g].layer.object;l<p.length;l++){var n=p[l].label;h[n]={textures:"",
src:p[l].src?p[l].src:f};c.extend(d,h)}else n=b[k][g].label,h[n]={textures:"",src:b[k][g].src?b[k][g].src:f},c.extend(d,h);else n=b[k].label,h[n]={textures:"",src:b[k].src?b[k].src:f},c.extend(d,h)}a=c.staticAllMap.value[a];a.textures=d;a.textures.renderObj={};a.textures.drawObj={};a.textures.drawImage=new c.draw.enviOrnaments;a.textures.update=function(a){if(this[a.label]){var b=this[a.label],d=this.drawObj;a.fixedBounds.bool&&(a.posY+=a.fixedBounds.value);a.isVisible&&(d.img=c.getTexture(b,b.src),
d.context=c.context,d.ver="v1",d.posX=a.posX,d.posY=a.posY,this.drawImage.update(d));c.bugTranslate=1}};d={}},loadGame:function(a,c){scope.canvas.width=scope.browserWidth();scope.canvas.height=scope.browserHeight()+1;scope.activeMap.value=a;scope.textures(a);scope.objDrawTranslate=scope.objTranslate.value;scope.mainCharacter=scope.oval.value;scope.allMapContent=scope.staticAllMap.value[a];scope.staticControl.installMapObject("mapA","remove");scope.staticControl.installMapObject(a,"add");scope.screenTransition("download",
a,function(){setTimeout(function(){scope.pushMsgText.value(m.lang.fn("gui","questAlert","detail"),200,"info",function(){scope.addClass(scope.qs("info-remaining"),"show")});setTimeout(function(){var a=localStorage.getItem("goldHero"),b=scope.characterControl.bossObject,d=function(){for(var a=b.pions,d=0,c=a.length;d<c;d++)if(/hero/i.test(a[d].label))return a[d]}(),c=0,h=0;a&&(a=JSON.parse(a),/armor/i.test(b.label)?(b.statParameters.gold=a.heroArmor,d.statParameters.gold=a.heroArcher):(b.statParameters.gold=
a.heroArcher,d.statParameters.gold=a.heroArmor),c=b.statParameters.gold,h=d.statParameters.gold);var g=c+m.lang.fn("gui","goldMining","addGold")+b.statParameters.name,l=h+m.lang.fn("gui","goldMining","addGold")+d.statParameters.name;scope.pushMsgText.value(g,200,"info",function(){scope.infoLogFn.value({title:"regular-title",text:{yellow:g}})});setTimeout(function(){scope.pushMsgText.value(l,200,"info",function(){scope.infoLogFn.value({title:"regular-title",text:{yellow:l}})})},4E3)},5E3)},3E3);scope.play()})},
setIntervalFn:function(){var a=scope.intervalList,c;for(c in a){var f=a[c];0<f.tick?f.tick--:f.always?(f.fn(),f.tick=f.tickUpdate):(f.fn(),delete a[c])}},monster:function(){var a=this;var c={interval:0,items:function(c,b,d){c.coin.spawnTotal=1;spawnX=b.position.x;spawnY=b.position.y;var f=new c.coin.create(spawnX+a.random(50,-50),spawnY+a.random(30,-30));b.rigBody.monsterParameters.coin&&(f.object.coinVal=b.rigBody.monsterParameters.coin);c.itemTemp.push(f);a.World.add(a.staticWorld.value,f.object);
if(d){b=0;for(var h=d.item.length;b<h;b++){f=d.item[b].itemName;var g=d.item[b].spawn,l=d.item[b].prob;texture=d.item[b].texture;100*Math.random()<=l&&(f=new c.item.create(spawnX+a.random(50,-50),spawnY+a.random(30,-30),f,texture),f.object.itemVal=a.random(g.max,g.min),c.itemTemp.push(f),a.World.add(a.staticWorld.value,f.object))}}},generateAIDataFrame:function(a,b){var d;a:for(d in m.frame.data)if(d===b){a.aiParams=m.frame.data[d];break a}console.log(this)},generateAIRuntime:function(a,b,d){var c=
0;b=this[b];a:for(;c<b.length;c++){var f=b[c].monsters;for(var g=0;g<f.length;g++)if(f[g].object.label===d)break a}a.aIParent=f},createAINpc:function(c){this.generateAIDataFrame(c,c.aiParams);this.generateAIRuntime(c,c.aIParent,c.objBoss.label);for(var b=c.spawn.x,d=c.spawn.y,f=c.aiParams[1],h=c.aiParams[2],g=c.aiParams[3],l=c.aiParams[4],p=c.aiParams[5],n=c.aIParent,q=c.forceGravity,r=c.spawnTotal,v=c.objBoss,u=[],m,C,A=0;A<r;A++)for(m=new (this["monster"+a.ucFirst(f)])({location:a.currentMap,objSpawn:v,
pitboss:!1}),C=a.staticGeneralMonster.value(f,h,g,l,p),q&&(C.forceGravity=!0),u.push({play:m,object:C,x:b,y:d}),v.pions||(v.pions=[]),c.objPawns.push(C),m=this.interval=0;m<r;m++){C=u[m].x;var D=u[m].y,E=u[m].object;a.World.add(a.staticWorld.value,E);u[m].play.update(this,C,D,E,this.interval+=10,this.items,v)}u.forEach(function(a){n.push(a)});u.length=0},spawnMonster:function(c,b,d,k,h,g,l,p,n,q){d=0;for(k=b.length;d<k;d++){var f=b[d];if(!f.freeze&&f.location===c)if(f.install)if(f.monsters.length)for(Q=
0;Q<f.monsters.length;Q++)f.monsters[Q].play.update()&&f.monsters.splice(Q,1);else{if(f.reSpawnTick--,0>f.reSpawnTick){f.reSpawnTick=f.reSpawnTickFixed;f.currentRespawn?f.currentRespawn++:f.currentRespawn=1;if(!f.respawnLimit||f.currentRespawn<f.respawnLimit)f.install=!1,console.log("pass "+d),console.log(f);!f.initWave&&f.currentRespawn>=f.respawnLimit&&f.objParent&&(f.objParent.wave.currentWave--,f.initWave=!0,console.log("frezz "+d),console.log(f));f=a.monsterControl;var v=a.qs("remaining-content"),
u=0,K=0,C=[],A=[];d=0;for(G=f.objSpawnMonster;d<G.length;d++)b=G[d],b.forEach(function(a){var b=document.createElement("li"),d=document.createElement("div"),c=document.createElement("div"),f="undefined"!==typeof a.freeze?a.freeze:!1;d.className=a.avatarClass;c.className="spawn-overflow";b.appendChild(d);addOverflow=!0;a.currentRespawn&&a.currentRespawn>=a.respawnLimit&&0===a.monsters.length&&!f&&(addOverflow=!1);/hero|tower/i.test(a.initialSpawn)?/tower/i.test(a.initialSpawn)&&(addOverflow&&K++,!addOverflow&&
b.appendChild(c),A.push(b)):(addOverflow&&u++,!addOverflow&&b.appendChild(c),C.push(b))});f=a.qs("remaining-box");var D=a.qs("eliminate-box");0>=u&&(v.innerHTML="",a.qs("button-remaining").setAttribute("init","reload"),a.text(a.qs("button-remaining"),m.lang.fn("gui","btnEndgame","detail")),a.removeClass(f,"hidden"),a.text(a.qs("msg-remaining"),u+" "+m.lang.fn("gui","htmlGUI","enemyText")),a.removeClass(D,m.lang.fn("gui","bgPop","towersLeft")),a.removeClass(D,m.lang.fn("gui","bgPop","enemiesLeft")),
a.addClass(D,m.lang.fn("gui","bgPop","win")),a.globalObjectGUI.value.audioBackground.fn("end"),C.forEach(function(a){v.appendChild(a)}));0>=K&&(v.innerHTML="",a.qs("button-remaining").setAttribute("init","reload"),a.text(a.qs("button-remaining"),m.lang.fn("gui","btnEndgame","detail")),a.removeClass(f,"hidden"),a.text(a.qs("msg-remaining"),K+" "+m.lang.fn("gui","htmlGUI","towText")),a.removeClass(D,m.lang.fn("gui","bgPop","towersLeft")),a.removeClass(D,m.lang.fn("gui","bgPop","enemiesLeft")),a.addClass(D,
m.lang.fn("gui","bgPop","lose")),A.forEach(function(a){v.appendChild(a)}),kongregate.services.isGuest()||kongregate.stats.submit("hard"===a.gameLevel?"scoresOnGameCompletedHard":"normal"===a.gameLevel?"scoresOnGameCompletedNormal":"scoresOnGameCompletedEasy",a.kongPoints.value));C.length=0;v.length=0}}else{f.name&&a.pushMsgText.value(m.lang.fn("gui","questAlertB","detail")+f.monsterLevel+", "+f.name+m.lang.fn("gui","questAlertC","detail"),150);D=f.objectSpawn.position.x;for(var E=f.objectSpawn.position.y,
t,J,ya=function(a){var b=this.variablesMonsterSpawn(c);a=a.split("monster").join("").toLowerCase();for(var d={},f=0,g=b.length;f<g;f++){var k=b[f];if(a===k[1].toLowerCase())return d.additionalBoundsValue=k[2],d.additionalBoundsWidthValue=k[3],d.additionalBoundsHeightValue=k[4],d.behaveRig=k[5],d}}.bind(this),G=0;G<f.spawnTotal;G++){t=new (this["monster"+a.ucFirst(h)])({location:f.location,objSpawn:f.objectSpawn,pitboss:f.pions?!0:!1});J=a.staticGeneralMonster.value(h,g,l,p,n);if(/dungeon/i.test(c)&&
!f.forceGravity)if("fixed"===f.position){var P=D;B=E}else{P=D+a.random(250,-250);var B=E+a.random(250,-250)}else P=D+=a.random(150,-150),B=E-100,f.forceGravity&&(J.forceGravity=!0,B=E);t.initialSpawn=q;f.monsters.push({play:t,object:J,x:P,y:B})}t=f.monsters;for(G=this.interval=0;G<f.spawnTotal;G++){B=t[G].x;var S=t[G].y,L=t[G].object;a.World.add(a.staticWorld.value,L);t[G].play.update(this,B,S,L,this.interval+=10,this.items);if(f.pions)for(var Q in f.pions){P=J;N=P.position.x;Z=P.position.y;monsterConstructor=
this[Q];staticMonsterConstructor=a.staticGeneralMonster.value;pionsSpawnTotal=f.pions[Q];temp=[];interval=5;B=h;B=Q.split("monster").join("");B=B.charAt(0).toLowerCase()+B.slice(1);for(S=0;S<pionsSpawnTotal;S++){L=new monsterConstructor({location:f.location,objSpawn:P,pitboss:!1});var M=ya(Q);M=staticMonsterConstructor(B,M.additionalBoundsValue,M.additionalBoundsWidthValue,M.additionalBoundsHeightValue,M.behaveRig);if(/dungeon/i.test(c))var N=D+a.random(250,-250),Z=E+a.random(250,-250);else N=D+=
a.random(150,-150),Z=E-100;temp.push({play:L,object:M,x:N+=a.random(250,-250),y:Z-100})}M=temp;for(N=0;N<pionsSpawnTotal;N++)B=M[N].x,S=M[N].y,L=M[N].object,a.World.add(a.staticWorld.value,L),M[N].play.update(this,B,S,L,interval+=10,this.items,P),f.monsters.push(M[N]);temp.length=0}}f.install=!0}}},objSpawnMonster:"",compile:function(c,b){this.activeMap=b;var d={},f;for(f in c){var h=c[f];d[f]=c[f];if(h instanceof Array)h.forEach(function(b,d){a[b.objectSpawn]&&(b.objectSpawn=a[b.objectSpawn].value)});
else for(var g in h)d[f]=a.components[g](d[f][g])}a.extend(this,d,!0);d=null;a.infoLogFn.value({title:"regular-title",text:{yellow:m.lang.fn("gui","questAlert","detail")}});setTimeout(function(){this.objSpawnMonster=function(){var a=[],b;for(b in this)/spawn/i.test(b)&&this[b]instanceof Array&&a.push(this[b]);return a}.call(this);var b=this;a.intervalList.waveInterval={tick:450,tickUpdate:250,always:!0,wave:{e:!1,d:!1,c:!1,b:!1,a:!1,s:!1,waveMax:/normal|hard/i.test(a.gameLevel)?2:1,currentWave:0},
fn:function(){if(this.wave.currentWave>=this.wave.waveMax)return!0;var d;a:for(d in this.wave)for(var c=0;c<b.objSpawnMonster.length;c++)for(var f=0;f<b.objSpawnMonster[c].length;f++){var g=b.objSpawnMonster[c][f];if(g.freeze&&g.monsterLevel.toLowerCase()===d&&-1!==g.monsterLevel.toLowerCase().indexOf(d)){/a|s/i.test(d)&&a.globalObjectGUI.value.audioBackground.fn("epic");this.wave.currentWave++;g.freeze=!1;g.objParent=this;break a}}}}}.bind(this),5);setTimeout(function(){this.update()}.bind(this),
10)},variablesMonsterSpawn:function(a){return m.frame[a]},monsterSpawnByMap:function(a,b,d){if(!this.filterDataFrame){var c=this.variablesMonsterSpawn(a);this.filterDataFrame=[];for(var f=0,g=c.length;f<g;f++){var l=c[f],p=l[0];this[p].length&&this.filterDataFrame.push(c[f])}}if(this.filterDataFrame.length)for(f=0,g=this.filterDataFrame.length;f<g;f++)l=this.filterDataFrame[f],p=l[0],this[p]&&this.spawnMonster(a,this[p],b,d,l[1],l[2],l[3],l[4],l[5],p)},update:function(){var c=a.characterControl.object;
this.monsterSpawnByMap(this.activeMap,c.position.x,c.position.y);if(this.itemTemp.length)for(var b=0;b<this.itemTemp.length;b++){var d=this.itemTemp[b];d.update(d.object,c)&&this.itemTemp.splice(b,1)}}};a.extend(c,new a.components.companions("monster"),!0);a.extend(c,new a.components.items,!0);a.monsterControl=c},skillCasting:function(){scope.tickMinute--;if(1>=scope.tickMinute){for(var a=scope.characterSkills.value.get(scope.oval.value.label),c=0,f=a.length;c<f;c++)if(!a[c].state){a[c].tickUpdate--;
var b=scope.qs("time-span-"+a[c].label),d=a[c],k=d.tickUpdate;var h=Math.floor(33*k/1E3);0>=k&&d.loading&&(d.loading.remove="true");60<=h?(d=Math.floor(h/60),h=d+","+(h-60*d)):h=0>h?1:h+1;b&&"block"!==b.style.display&&(b.style.display="block");b&&scope.text(b,h)}scope.tickMinute=30}},character:function(a){var c=this;a={object:c.oval.value,characterState:"characterState",staticWallOutter:c.staticWallOutter.value(),objTranslate:c.objTranslate.value,aggresive:[],activeMap:"",dungeonActive:!1,container:c.canvas,
moveSpeed:4.5,moveReplaceX:4.5,moveReplaceY:4.5,jumpSpeed:-22.5,mouseTempX:0,mouseTempY:0,mousePosX:0,mousePosY:0,moveStaticX:4.5,moveStaticY:4.5,moveLeft:!1,moveRight:!1,moveUp:!1,moveDown:!1,moveStrict:!1,jump:!1,preventControl:!1,isTranslateY:!0,isAttacking:!1,monsterTarget:"",monsterParameters:"",hitNumber:[],criticalParticle:{tick:100,tickUpdate:100,container:[],createGlowRing:function(){this.container.push(new c.createGrowRing({life:27,width:100,height:100,optionalX:0,optionalY:0,src:c.path+
"red-rings.png",growingMax:250,bind:new function(){var a=c.qs("background-right").getBoundingClientRect();this.x=a.x+a.width/2;this.y=a.y+a.height/2;this.visible=!0}}))},update:function(){var a=this.container;0>this.tick?(this.createGlowRing(),this.tick=this.tickUpdate):(this.tick--,10===this.tick&&50>this.tickUpdate&&c.playAudio("heartbeat"));for(var b=0;b<a.length;b++)a[b].draw()&&a.splice(b,1)}},loadingHpPotion:new c.loadingAct(25,"rgba( 255, 22, 22, 0.5 )"),hpTickState:!0,hpPotionUpdate:function(a){return this.loadingHpPotion.update(c.context,
0,0,a)},loadingMpPotion:new c.loadingAct(25,"rgba( 83, 83, 255, 0.5 )"),mpTickState:!0,mpPotionUpdate:function(a){return this.loadingMpPotion.update(c.context,0,0,a)},characterParameters:c.characterParameters.value,areaDamageFn:function(){for(var a=this.object.position,b=0,d=c.areaDmgPool.value.storage;b<d.length;b++)a.x>d[b].status.bounds.min.x&&a.x<d[b].status.bounds.max.x&&a.y>d[b].status.bounds.min.y&&a.y<d[b].status.bounds.max.y&&d[b].status.caster!==this.object.label&&d[b].status.monsterParameters.push(this.characterParameters)},
buffDelay:0,buffGUI:function(a,b,d){if("add"===a)a=document.createElement("div"),a.className="buff-skill "+d,a.id=b,b=document.createElement("span"),a.appendChild(b),c.buffBox.insertBefore(a,c.buffBox.firstChild);else if("remove"===a)for(d=c.slice(c.buffBox.getElementsByTagName("div")),a=0;a<d.length;a++)if(d[a].id===b){d[a].remove();break}},buffHeal:function(a){a=Math.round(parseInt(this.characterParameters.maxHealth)*(parseInt(a)/100)+c.random(15,0));this.hitNumber.push(new c.hitNumber("+"+a,"heal"));
this.characterParameters.health=this.characterParameters.health+a<this.characterParameters.maxHealth?this.characterParameters.health+a:Math.round(this.characterParameters.maxHealth);this.updateHpBar()},forceObjectToAttack:function(a){},monsterGetDamageFn:function(a,b,d,k,h){var f=c.monsterGetDamage.value.get(a);"undefined"===typeof f&&(c.monsterGetDamage.value.set(a,[]),f=c.monsterGetDamage.value.get(a));f.push({damage:d,attackerAbilities:h,status:b,attacker:k,attackerParameters:this.characterParameters})},
calculateMonsterDamageWithSkill:function(a,b){var d=a.magicDefenseMax,f=a.magicDefenseMin,h=c.random(this.characterParameters.attackRangeMax,this.characterParameters.attackRangeMin);d=c.random(d,f);h=h+Math.round(h*this.characterParameters[b].damage/100)-d;0<h?h:Math.round(c.random(100,50)/2);return h},convertAttackCharacterToDamage:function(){if("melee"===this.characterParameters.attackType)var a=this.characterParameters.attackMax,b=this.characterParameters.attackMin;else a=this.characterParameters.attackRangeMax,
b=this.characterParameters.attackRangeMin;var d=this.monsterParameters.defenseMax,k=this.monsterParameters.defenseMin;a=c.random(a,b);d=c.random(d,k);this.isAttacking&&(d=a-d,k=0<d?d:Math.round(c.random(100,50)/2),d=this.attackerAbilities(this.characterParameters),this.setHelpToSummon(this.monsterParameters.object.label),this.monsterGetDamageFn(this.monsterTarget,"attack",k,this.object.label,d))},helpTick:1E3,setHelpToSummon:function(a){var b=!0;if(this.object.pions&&this.object.pions.length)for(var d=
0,c=this.object.pions;d<c.length;d++)if(c[d].label===a){b=!1;break}b&&(this.helpTick=1E3,this.object.attacker=a,this.object.needHelp=!0)},characterGetDamage:c.characterGetDamage.value,convertAttackMonsterToDamage:function(){var a=this.characterGetDamage;if(a&&a.length)for(var b=0;b<a.length;b++){var d=a[b];if(this.isEnemyFn(d.object.label)){if("melee"===d.attackType)var k=d.attackMax,h=d.attackMin;else"long-range"===d.attackType&&(k=d.attackRangeMax,h=d.attackRangeMin);if(this.buff.register({seletedBuff:d.buffSkill,
paramsTarget:this.characterParameters,paramsAttacker:d})){var g=this.characterParameters.defenseMax,l=this.characterParameters.defenseMin,p=c.random(k,h);g=c.random(g,l);p-=g;p=0>=p?0:p;p=0<p?p:Math.round(c.random(100,50)/2);g=this.attackerAbilities(this.characterParameters);for(var n=l=!1,q=0,r=g.length;q<r;q++)"avoid"===g[q]?l=!0:"block"===g[q]&&(n=!0);n?(this.hitNumber.push(new c.hitNumber("block")),this.object.visible&&c.playAudio(["shiled-blocking"])):l?this.hitNumber.push(new c.hitNumber("miss")):
d.object.deleted||(this.setHelpToSummon(d.object.label),g=this.characterParameters.health-p,0>g?(this.characterParameters.health=0,this.updateHpBar(),c[this.characterState].set(this.object.label,"die"),this.moveStrict=!0,this.object.behave="die",d.object.rigBody.attacker=!1,d.object.rigBody.behaveState=!0,d.object.rigBody.behaveRandomFn(1),this.object.label!==this.bossObject.label?this.switchCharacter(this.bossObject):(p=c.qs("remaining-box"),g=c.qs("eliminate-box"),remainingContent=c.qs("remaining-content"),
remainingMsg=c.qs("msg-remaining"),remainingContent.innerHTML="",c.qs("button-remaining").setAttribute("init","reload"),c.text(c.qs("button-remaining"),m.lang.fn("gui","btnEndgame","detail")),c.text(remainingMsg,m.lang.fn("gui","leaderDied","detail")),c.removeClass(p,"hidden"),c.removeClass(g,m.lang.fn("gui","bgPop","towersLeft")),c.removeClass(g,m.lang.fn("gui","bgPop","enemiesLeft")),c.addClass(g,m.lang.fn("gui","bgPop","lose")),c.globalObjectGUI.value.audioBackground.fn("end"))):(g=this.abilityCritical(d,
p),l=0<g,p+=g,this.hitNumber.push(l?new c.hitNumber(p,"critical"):new c.hitNumber(p)),c.playAudio(["stab"]),this.characterParameters.health-=p,c.hitEffect({object:this.object,parent:"",alpha:!0}),this.characterParameters.health<this.characterParameters.maxHealthCure&&this.cureSelf(c.slotButtonHp,"healthpotion","hpTickState","hpPotionUpdate"),this.partyRandomHelp.update(this),this.updateHpBar(),this.characterParameters.health<this.characterParameters.maxHealth/2&&c.globalObjectGUI.value.audioBackground.fn("critical")));
this.characterParameters.health&&!c.monsterTarget&&(this.updateMonsterParamsAngGUI(d.object.label),this.isAttacking=!0);this.characterGetDamage.splice(b,1)}}}if(this.hitNumber.length)for(a=0;a<this.hitNumber.length;a++)this.hitNumber[a].update(c.context,this.object)&&this.hitNumber.splice(a,1)},cureSelf:function(a,b,d,k){var f=a.getElementsByTagName("div");if(f.length&&this[d]){f=f[0].getAttribute("label");var g=this.loot;a=c.qs("item-number",a);for(var l=0;l<g.length;l++)if(g[l]&&g[l].label===f&&
g[l].name===b){this[k]("reset");this[d]=!1;g[l].cooldown&&(this["hpPotionUpdate"===k?"loadingHpPotion":"loadingMpPotion"].tick=g[l].cooldown);"healthpotion"===b&&this.characterParameters.health<this.characterParameters.maxHealthCure?(g[l].quantity--,this.characterParameters.health=this.characterParameters.health+g[l].cure<this.characterParameters.maxHealth?this.characterParameters.health+g[l].cure:this.characterParameters.maxHealth):this.characterParameters.mp<this.characterParameters.maxMpCure&&
(g[l].quantity--,this.characterParameters.mp=this.characterParameters.mp+g[l].cure<this.characterParameters.maxMp?this.characterParameters.mp+g[l].cure:this.characterParameters.maxMp);c.text(a,g[l].quantity);if("healthpotion"===b){this.updateHpBar();this.characterParameters.health<this.characterParameters.maxHealth/2&&c.globalObjectGUI.value.audioBackground.fn("critical");var p=Math.round(this.characterParameters.health/this.characterParameters.maxHealth*100);p=30>p?20:50>p?30:60>p?40:70>p?55:100;
this.criticalParticle.tickUpdate=p}else"manapotion"===b&&this.updateMpBar();0>=g[l].quantity&&(g.splice(l,1),c.addClass(a,"hidden"),c.globalObjectGUI.value.attachMainPotions(!0),this[d]=!0)}}},cntActiveSkill:[],cntTickSkill:[],isSkillRegistered:function(a){for(var b=this.buffAffected,d=!0,c=0;c<b.length;c++)if(b[c].skill===a){d=!1;break}return d},characterSkills:c.characterSkills.value,skillUpdate:function(a){var b=this.characterSkills.initial,d=this.characterSkills.skills;if(b.state&&this.characterParameters.health){for(var f=
b.label,h=0;h<d.length;h++)if(d[h].label===f&&d[h].state&&!this.dirSwitch.forceAttackFrame&&(/intimidation/i.test(d[h].name)||this.isEnemyFn(c.monsterTarget))){var g=this,l=c.qs("time-span-"+d[h].label);if(!l)return!1;var p=c.sibling(l,"next");f={install:function(){d[h].loading||(d[h].loading=new c.loadingAct(25,"rgba( 0, 0, 0, 0.7 )",d[h].tick));d[h].loading.update(c.context,-1E3,-1E3,"reset");var a=c.characterSkills.value.get("initial");a.label="";a.state=!1;delete a.target;this.cureSelf(c.slotButtonMp,
"healthpotion","mpTickState","mpPotionUpdate");this.updateMpBar()}.bind(g),initLoading:function(){d[h].target=b.target;d[h].state=!1;g.cntTickSkill.push(d[h]);c.removeClass(p,"loading");g.latestDir=""},guiInitLoading:function(){p.style.display=l.style.display="block";c.addClass(p,"loading")}};/intimidation/i.test(d[h].name)||(this.isAttacking=!0);this.triggerUniqueSkill(f,d[h]);break}b.state=!1}d&&this.updateRegisterSkillFn(a);this.updateRegisterSkillTick()},updateRegisterSkillTick:function(){for(var a=
this.cntTickSkill,b=0;b<a.length;b++){var d=a[b];d.state?(d.tickUpdate=d.tick,a.splice(b,1)):d.target?(d.tickUpdate--,d.loading.update(c.context,x,y,d.tick)&&(d.state=!0,d.loading.remove=!1,d.tickUpdate=d.tickOriginal&&d.tickOriginal||d.tick,d.target="",(d=c.qs("time-span-"+d.label))&&(d.style.display="none"),a.splice(b,1))):0<d.tickUpdate?d.tickUpdate--:(d.state=!0,d.tickUpdate=d.tick,a.splice(b,1))}},activeAttacking:!1,latestDir:"right",monsterDir:function(){return this.monsterParameters.object.position.x<
this.object.position.x?"left":"right"},dirSwitch:{reset:function(){}},boundsWidthOperator:{left:1,right:1},changeLeftFn:function(a,b){if(b||!this.dirSwitch.forceAttackFrame&&(this.dirSwitch.left&&this.moveLeft&&!this.moveRight&&(!this.moveLeft||!this.moveRight)||a)){this.dirSwitch.left=!1;this.dirForBug.current=this.latestDir="left";this.moveSpeed=-this.moveReplaceX;this.object.additionalBoundsWidthValue=this.boundsWidthOperator.left*Math.abs(this.object.additionalBoundsWidthValue);var d=this.object.initialName+
"-left.png";this.objTranslate.firstLoadLeft=!1;c[this.characterState].set(this.object.label,"textureNeedChange|"+c.path+d)}},changeRightFn:function(a,b){if(b||!this.dirSwitch.forceAttackFrame&&(this.dirSwitch.right&&!this.moveLeft&&this.moveRight&&(!this.moveLeft||!this.moveRight)||a)){this.dirSwitch.right=!1;this.dirForBug.current=this.latestDir="right";this.moveSpeed=this.moveReplaceX;this.object.additionalBoundsWidthValue=this.boundsWidthOperator.right*Math.abs(this.object.additionalBoundsWidthValue);
var d=this.object.initialName+"-right.png";this.objTranslate.firstLoadRight=!1;c[this.characterState].set(this.object.label,"textureNeedChange|"+c.path+d)}},attackFrame:"",changeDir:function(a){"right"===a?"right"!==this.latestDir&&setTimeout(function(){this.changeRightFn(!0)}.bind(this),2):"left"!==this.latestDir&&setTimeout(function(){this.changeLeftFn(!0)}.bind(this),2)},loopDir:function(a){this.dirSwitch.dirBlock.state||(0<a?"right"!==this.latestDir&&setTimeout(function(){this.changeRightFn(!0)}.bind(this),
2):"left"!==this.latestDir&&setTimeout(function(){this.changeLeftFn(!0)}.bind(this),2))},objGlobalTranslate:new c.objGlobalTranslate,dungeonAttackRangeY:{max:0,min:c.random(180,100)},guiFight:"iconNeutral",idleBugTick:0,dirForBug:{previous:"",current:""},findTargetToAttack:function(){monsterReg=c.globalAnimation.value.monsterTarget;findEnemy=function(){for(var a=this.createAreaDamagePool({target:this.object,width:c.browserWidth(),height:c.browserHeight(),caster:this.object.label}),d=[];a.length;){var f=
a.pop().object;this.isEnemyFn(f.label)&&d.push(f)}d.length&&(a=c.AI.sortestEnemy(d,this.object),this.updateMonsterParamsAngGUI(a[0].label),monsterReg=!0)}.bind(this);monsterReg?(monsterReg=this.isEnemyFn(monsterReg),monsterReg||(c.monsterTarget="",monsterReg=!1,findEnemy())):findEnemy();if(!c.monsterTarget)c.pushMsgText.value(m.lang.fn("gui","attackAlert","detail"),100);else if(!(this.moveLeft||this.moveRight||this.moveUp||this.moveDown)){var a=c.qs("attack-right-nav");!this.isAttacking&&monsterReg?
(c.addClass(a,"iconAttack"),c.removeClass(a,"iconNeutral"),this.isAttacking=!0,this.guiFight=a.className):this.isAttacking&&c.isMobile()&&(c.addClass(a,"iconNeutral"),c.removeClass(a,"iconAttack"),c[this.characterState].set(this.object.label,"idle"),this.isAttacking=!1,this.guiFight=a.className)}},performAttacking:function(a,b,d){if(this.characterParameters.health){var f=this.dirSwitch,h=!this.moveLeft&&!this.moveRight&&!this.moveUp&&!this.moveDown;if(this.isAttacking&&a&&this.monsterParameters&&
this.isEnemyFn(a)&&h){h=f.tempTarget;var g=this.monsterParameters.object,l=Math.round(g.position.x-d.x),p=Math.round(g.position.y-d.y),n="melee"===this.characterParameters.attackType;f.normal&&(/iconNeutral/i.test(this.guiFight)&&(c.removeClass(c.qs("attack-right-nav"),"iconNeutral"),c.addClass(c.qs("attack-right-nav"),"iconAttack"),this.guiFight=c.qs("attack-right-nav").className),f.normal=!1,f.reset(),f.selectedFrame="",this.object.behave="attack",this.loopDir(l));g=n?this.meleeMovement({object:this.object,
target:g,range:this.dungeonAttackRange,distanceY:this.dungeonAttackRangeY.min,speed:this.moveReplaceX,forceGravity:this.object.forceGravity,objTranslate:b,dirSwitch:f}):this.rangeMovement({object:this.object,target:g,targetDummy:h,distanceY:this.dungeonAttackRangeY,distanceX:this.dungeonAttackRange,distX:l,distY:p,dirSwitch:f,objTranslate:b,speed:this.moveStaticX});(p=this.dirSwitch.forceAttackFrame)?g.init=!0:this.monsterParameters.health||(this.isAttacking=!1,c.monsterTarget="",c[this.characterState].set(this.object.label,
"idle"));p=!p;this.dirSwitch.forceAttackFrame?g.init=!0:(this.velocity=g.y,b.staticObjMoveX=Math.abs(g.x),b.staticObjMoveY=Math.abs(g.y),b.objPhysCollide=!1);this.performAttackFrame(g,this.dirSwitch.selectedFrame)&&this.convertAttackCharacterToDamage();p&&(n?g.init?this.latestDir="":this.loopDir(l):f.mainTurn||g.init||(l=Math.round(h.position.x-d.x),this.loopDir(l)));f.previousTarget!==a&&(this.dirForBug.previous!==this.dirForBug.current&&(p&&setTimeout(function(){f.reset()},150),this.dirForBug.previous=
this.dirForBug.current),f.dirBlock.reset(),f.previousTarget=a)}else!f.normal&&(f.tempTarget={position:{x:0,y:0},init:!0},b.charaTranslate=!0,f.normal=!0,f.reset(),this.object.behave="walk",f.dirBlock&&f.dirBlock.reset(),this.dirSwitch.forceAttackFrame||c.monsterParameters.value.get(a)||(c.monsterTarget="",c.addClass(c.qs("monster-bar"),"hidden"),c[this.characterState].set(this.object.label,"idle")),/iconAttack/i.test(this.guiFight)&&(c.removeClass(c.qs("attack-right-nav"),"iconAttack"),c.addClass(c.qs("attack-right-nav"),
"iconNeutral"),this.guiFight=c.qs("attack-right-nav").className),this.moveLeft||this.moveRight||this.moveUp||this.moveDown)&&(this.dirSwitch.selectedFrame="",f.reset()),!this.dirSwitch.forceAttackFrame&&h&&0>=this.idleBugTick?(b=c[this.characterState],d=b.get(this.object.label),"idle"!==d&&b.set(this.object.label,"idle"),this.idleBugTick=5):this.idleBugTick--;this.isAttacking&&!this.dirSwitch.forceAttackFrame&&""===a&&(this.isAttacking=!1,c[this.characterState].set(this.object.label,"idle"),f.reset())}else d=
c[this.characterState].get(this.object.label),/idle|die/i.test(d)||c[this.characterState].set(this.object.label,"idle"),this.moveLeft=this.moveRight=this.moveUp=this.moveDown=!1,b.moveUp=!1,b.moveDown=!1,b.moveLeft=!1,b.moveRight=!1,b.staticObjStateX=!1,b.staticObjStateY=!1},removeAnimateSkill:function(a,b){return""===a||b!==a},pointingAnimate:{drawFn:new c.draw.generalDrawImage,drawLoadingMb:new c.loadingAct(10,"rgba( 255, 22, 22, 0.8 )",25),active:!1,install:!1,imagePosY:-30,imagePosX:0,scaleBefore:0,
scaleX:0,scaleY:0,offsetX:.1,offsetY:.1,posX:310,posY:310,target:{state:!1,object:"",objectTarget:"",visible:!1,behave:""},renderWalk:{textures:"",src:c.path+"point-walk.png"},renderAttack:{textures:"",src:c.path+"point-attack.png"},updateLoadingMb:function(a){var b=a.position;if(this.drawLoadingMb.update(c.context,b.x,b.y-a.additionalBoundsValue-45))return this.startEventMb(a),!0},mouseInTargetFn:function(a,b){var d=a.additionalBoundsValue?a.additionalBoundsValue:0;return a.bounds.min.x-d/3<b.x&&
a.bounds.max.x+d/3>b.x&&a.bounds.min.y-d<b.y&&a.bounds.max.y>b.y},targetCompanion:{dirX:0,sekleton:"",sekletonTarget:""},initMb:!1,startEventMb:function(a){this.initMb||(this.targetCompanion.dirX=a.position.x,this.cursorStartEventFn(a.position),this.initMb=!0)},endEventMb:function(a){this.cursorEndEventFn(a)},moveEventMb:function(a,b){this.initMb&&this.cursorMoveEventFn(a,b)},cursorStartEventFn:function(a){for(var b=c.Composite.allBodies(c.engine.world),d=0;d<b.length;d++){var f=b[d],h=this.mouseInTargetFn(f,
a);if(/sekleton/i.test(f.label)&&h){this.targetCompanion.sekleton=f;this.target.object=f;this.active=!0;this.target.behave="walk";break}}},cursorMoveEventFn:function(a,b){this.posX=a.x;this.posY=a.y;var d=this.target,f=this.target.objectTarget,h=d.object instanceof Object&&this.mouseInTargetFn(d.object,a);if(""===d.object||h)this.target.visible=!1;else{d.visible=!0;if(b)d.objectTarget=b;else{h=c.Composite.allBodies(c.engine.world);for(var g=0;g<h.length;g++){var l=h[g],p=l.label,n=this.mouseInTargetFn(l,
a);if(f.label!==p&&/monster|dragon/i.test(p)&&!/sekleton/i.test(p)&&n&&p!==d.label){d.objectTarget=l;break}}}""!==f&&this.mouseInTargetFn(f,a)?(d.render="renderAttack",d.state=!0):(d.render="renderWalk",d.state=!1)}},cursorEndEventFn:function(a){if(""!==this.targetCompanion.sekleton){for(var b=c.Composite.allBodies(c.engine.world),d=this.mouseInTargetFn(this.targetCompanion.sekleton,a),f,h=this.targetCompanion.sekleton,g=0;g<b.length;g++){f=b[g];mouseInTarget=this.mouseInTargetFn(f,a);if(/monster/i.test(f.label)&&
f.label!==h.label&&!d&&mouseInTarget){h.rigBody.character=f;h.rigBody.loopDir(Math.round(f.position.x-h.rigBody.object.position.x),!0);h.rigBody.attacker=f.label;h.rigBody.object.behave=h.rigBody.behave="attack";h.rigBody.turnState=c.random(600,500);break}if(g===b.length-1&&!d){h.rigBody.loopDir(a.x-this.targetCompanion.dirX,!0);h.rigBody.objectPointing.position.x=a.x;h.rigBody.objectPointing.position.y=a.y;h.rigBody.behave="pointing";h.rigBody.turnState=c.random(600,500);break}}this.active=!1;this.target.object=
"";this.target.objectTarget="";this.targetCompanion.sekleton=""}},update:function(a){this.install||(c.getTexture(this.renderWalk,this.renderWalk.src),c.getTexture(this.renderAttack,this.renderAttack.src),this.install=!0);var b=this.target.objectTarget;this.target.state&&b instanceof Object&&(this.posX=b.position.x,this.posY=b.bounds.min.y-b.additionalBoundsValue);this.target.visible&&this.drawFn.update({context:a,image:this[this.target.render].textures,posX:this.posX,posY:this.posY,imagePosY:this.imagePosY,
imagePosX:this.imagePosX,scaleX:this.scaleX,scaleY:this.scaleY,offsetX:this.offsetX,offsetY:this.offsetY,scaleBefore:this.scaleBefore})}},footstep:{tick:0,tickStep:8,fn:function(){c.playAudio("footstep")}},trajectoryCheck:function(){if(this.trajectoriesUpdate.length){var a=this.monsterDir(),b=this.object.position,d=this.trajectoriesUpdate,c=this.object.statParameters.trajectoryProp;if(c){if("right"===a){var h=b.y-c.posY;var g=b.x+c.posX;b=110}else g=b.x-c.posX,h=b.y-c.posY,b=250;for(c=0;c<d.length;c++)d[c].update(g,
h,b,a,this.monsterParameters.object)&&d.splice(c,1)}}},update:function(){var a=this.object.position,b=this.object,d=this.objTranslate,k=c.monsterTarget,h=this.dirSwitch;if(d.isCenter.state)var g=this.moveReplaceX,l=this.moveReplaceY;else{if(isNaN(d.staticObjMoveX)||isNaN(d.staticObjMoveY))d.staticObjMoveX=this.moveReplaceX,d.staticObjMoveY=this.moveReplaceY;g=d.staticObjMoveX;l=d.staticObjMoveY}this.trajectoryCheck();this.performAttacking(k,d,a);this.criticalParticle.update();0<=h.delayDir&&(h.delayDir--,
0===h.delayDir&&"walk"!==c[this.characterState].get(this.object.label)&&c[this.characterState].set(this.object.label,"walk"));0<this.helpTick&&(this.helpTick--,0===this.helpTick&&(b.attacker=!1,b.needHelp=!1));this.skillUpdate(k);this.specialItems.updateRegisterItemFn();this.buff.update();0<this.characterParameters.health&&this.characterParameters.health<this.characterParameters.maxHealthCure&&this.cureSelf(c.slotButtonHp,"healthpotion","hpTickState","hpPotionUpdate");!this.hpTickState&&this.hpPotionUpdate()&&
(this.hpTickState=!0);this.characterParameters.mp<this.characterParameters.maxMpCure&&this.cureSelf(c.slotButtonMp,"manapotion","mpTickState","mpPotionUpdate");!this.mpTickState&&this.mpPotionUpdate()&&(this.mpTickState=!0);this.convertAttackMonsterToDamage();this.moveUp&&this.dungeonActive&&!b.forceGravity&&c.Body.translate(b,{x:0,y:-l});this.moveDown&&this.dungeonActive&&c.Body.translate(b,{x:0,y:l});this.moveLeft&&(this.changeDir("left"),c.Body.translate(b,{x:-g,y:0}));this.moveRight&&(this.changeDir("right"),
c.Body.translate(b,{x:g,y:0}));this.jump&&!this.preventControl&&(h.jump&&(c[this.characterState].set(b.label,"jump"),h.jump=!1),c.Body.translate(b,{x:0,y:this.jumpSpeed}));this.screenCheck()},rigBodyAI:{state:!1},switchCharacterAuto:function(){if(this.bossObject)for(var a=[this.bossObject].concat(this.bossObject.pions),b=this.object.label,d=0,c=a.length;d<c;d++){var h=a[d];if(/hero/i.test(h.label)&&h.label!==b)return this.switchCharacter(h),!0}return!1},switchCharacter:function(a){var b=a.rigBody,
d=this.rigBodyAI;"function"===typeof b.cureSelf.reset&&b.cureSelf.reset();d.state?(d.object.rigBody=this.rigBodyAI.rigBody,d.object.render.behaveRig=this.rigBodyAI.behaveRig,d.object.stateStorage=this.rigBodyAI.stateStorage,d.object.statParameters=this.rigBodyAI.statParameters,d.object.rigBody.monsterParameters=this.rigBodyAI.statParameters,d.object.rigBody.pointMove=a,d.object.rigBody.replaceObjectSpawnByRand.selectedObjSpawn=a,d.rigBody.skill.active=this.cntTickSkill,d.rigBody.cntActiveSkill=this.cntActiveSkill,
d.rigBody.dirSwitch=this.rigBodyAI.dirSwitch,d.rigBody.dirSwitch.reset(),d.rigBody.attackFrame=this.rigBodyAI.attackFrame,d.rigBody.rigState=!0,d.rigBody.moveSpeedAttack=this.moveReplaceX,d.rigBody.moveSpeedNormal=this.moveReplaceX,d.rigBody.moveSpeed=0<=this.moveSpeed?this.moveReplaceX:-this.moveReplaceX,d.rigBody.cureSelf.gui=!0,d.rigBody.cureSelf.updateBar("hp-inner-line-bar"),d.rigBody.cureSelf.updateBar("mp-inner-line-bar"),d.rigBody.cureSelf.updateAvatar(),c.globalObjectGUI.value.checkBagLocation("default",
c.characterInventoryBag.value.get(this.rigBodyAI.rigBody.object.label),"bag"),this.isAttacking?d.rigBody.forceObjectToAttack(this.monsterParameters.object,!0):d.rigBody.behaveRandomFn(1)):(this.rigBodyAI.state=!0,c.World.remove(c.engine.world,this.object));d.object=a;d.stateStorage=a.stateStorage;d.statParameters=a.statParameters;d.rigBody=b;d.cntTickSkill=b.skill.active;d.cntActiveSkill=b.cntActiveSkill;d.dirSwitch=b.dirSwitch;d.attackFrame=b.attackFrame;d.behaveRig=b.object.render.behaveRig;b.skill.reset(b,
b.cntStateSkill);this.attackFrame=b.attackFrame;c.oval.value=a;this.object=c.mainCharacter=a;b.object.render.behaveRig&&(this.object.render.behaveRig=b.object.render.behaveRig);this.bossObject=b.pitboss?a:b.boss;b.pitboss?(c.removeClass(c.qs("chara-leader"),"hidden"),c.addClass(c.qs("chara-leader-small"),"hidden")):(c.addClass(c.qs("chara-leader"),"hidden"),c.removeClass(c.qs("chara-leader-small"),"hidden"));this.object.stateStorage=this.characterState;c.Body.setPosition(this.object,{x:a.position.x,
y:a.position.y});this.initialSpawn=b.initialSpawn;this.aggresive=b.aggresive;this.characterParameters.mainCharacter=!1;this.loot=c.characterInventoryBag.value.get(this.object.label);this.dungeonAttackRangeY=b.dungeonAttackRangeY;this.dungeonAttackRange=b.dungeonAttackRange;this.BoundsWidthOperator=b.BoundsWidthOperator;this.avatar=b.avatar;this.buff=b.buff;this.dirSwitch=b.dirSwitch;this.characterParameters=a.statParameters;this.characterParameters.mainCharacter=!0;c.characterParameters.value=this.characterParameters;
this.cntTickSkill=b.skill.active;this.cntActiveSkill=b.cntActiveSkill;this.object.statParameters=this.characterParameters;this.object.statParameters.object=this.object;this.object.rigBody=this;this.moveReplaceX=b.moveSpeedAttack;this.moveReplaceY=b.moveSpeedAttack-.222*b.moveSpeedAttack;this.moveStaticX=b.moveSpeedAttack;this.moveStaticY=b.moveSpeedAttack-.222*b.moveSpeedAttack;this.moveSpeed=0<=this.moveSpeed?b.moveSpeedAttack:-b.moveSpeedAttack;c.objTranslate.value.isCenter.state=!0;this.latestDir=
"";this.moveLeft||this.moveRight||this.moveUp||this.moveDown?c[this.object.stateStorage].set(this.object.label,"walk"):c[this.characterState].set(this.object.label,"idle");c.characterGetDamage.value.get(a.label)||c.characterGetDamage.value.set(a.label,[]);this.characterGetDamage=c.characterGetDamage.value.get(this.object.label);c.characterSkills.value.get(this.object.label)||c.characterSkills.value.set(this.object.label,b.cntStateSkill);this.characterSkills={skills:c.characterSkills.value.get(this.object.label),
initial:c.characterSkills.value.get("initial")};c.globalObjectGUI.value.fetchLoot();c.globalObjectGUI.value.fetchSkill();c.globalObjectGUI.value.attachMainPotions(!0);c.isMobile()&&c.globalObjectGUI.value.GUImobile.replaceSkills("detached");this.updateHpBar();this.updateMpBar();this.updateAvatar();b.rigState=!1},updateMonsterParamsAngGUI:function(a){(this.monsterParameters=c.monsterParameters.value.get(c.monsterTarget?c.monsterTarget:a))&&(this.monsterParameters.object.monsterTarget=!1);(this.monsterParameters=
c.monsterParameters.value.get(a))&&(this.monsterParameters.object.monsterTarget=!0);this.monsterTarget=c.monsterTarget=a;if(this.monsterParameters&&this.isEnemyFn(a)){this.dirSwitch.reset();if(a=this.monsterParameters.monsterLevel){switch(this.monsterParameters.monsterLevel.toLowerCase()){case "a":case "s":status="red";break;case "b":case "c":status="orange";break;default:status="green"}c.text(c.getFirstChild(c.qs("box-m-level")),a);c.removeClass(c.qs("box-m-level"),"hidden")}else c.addClass(c.qs("box-m-level"),
"hidden");c.qs("circle-bar-stat").className="circle-bar-stat "+status}},event:function(){var a=this;c.Events.on(c.engine,"collisionStart",function(b){b=b.pairs;for(var d=0,f=b.length;d!=f;++d){var h=b[d],g=h.bodyA,l=h.bodyB,p=g.parent,n=l.parent;g="Body"!==g.label||g.outterWall?g.label:g.parent.label;l="Body"!==l.label||l.outterWall?l.label:l.parent.label;/static|oval/i.test(g)&&/static|oval/i.test(l)&&(a.jump||c.characterMobileControl.value.jump)&&(a.jump=!1,c.characterMobileControl.value.jump=!1,
a.dirSwitch.jump=!0,a.moveLeft||a.moveRight||c.characterMobileControl.value.moveLeft?c[a.characterState].set(a.object.label,"walk"):c[a.characterState].set(a.object.label,"idle"));if(/buffer/i.test(g)||/buffer/i.test(l))if(p.drawLine&&p.setVertiecsByPoint){var m=n.rigBody;m.dirSwitch.dirBlock.sortedVerts.length=0;/back|attack/i.test(m.behave)?p.setVertiecsByPoint.getTarget(n):p.setVertiecsByPoint.getTargetByRandDestPoint(n)}else n.drawLine&&(m=p.rigBody,m.dirSwitch.dirBlock.sortedVerts.length=0,/back|attack/i.test(m.behave)?
n.setVertiecsByPoint.getTarget(p):n.setVertiecsByPoint.getTargetByRandDestPoint(p));if(a.object.label===l||a.object.label===g)a.objTranslate.objPhysCollide=!0;/staticWall|monster/i.test(g)&&/staticWall|monster/i.test(l)&&/dungeon/i.test(c.activeMap.value)&&(/monster/i.test(l)&&(c[h.bodyB.stateStorage].set(l,"turn"),h.bodyB.outterWall=g),/monster/i.test(g)&&(c[h.bodyB.stateStorage].set(g,"turn"),h.labelA.outterWall=l))}});c.Events.on(c.mouseConstraint.value,"mousedown",function(b){var d=b.mouse.position,
f=c.Composite.allBodies(c.engine.world);b=[];for(var h=0;h<f.length;h++){var g=f[h];var l=a.pointingAnimate.mouseInTargetFn(g,d);/monster/i.test(g.label)&&!/hero/i.test(g.label)&&l?b.push(g):/npc/i.test(g.label)&&l&&g.visible?(g.touch&&c.removeClass(c.qs("box-dialog"),"hidden"),c.updateMessageText.value(g.label),g.touch&&c.characterUpdateQuest.value(g.label)):!c.isMobile()&&/hero/i.test(g.label)&&g.label!==a.object.label&&l&&a.switchCharacter(g)}if(b.length)if(1===b.length&&b[0].rigBody.isStatic)a.updateMonsterParamsAngGUI(b[0].label);
else for(;b.length;){d=c.random(b.length-1,0);f=b[d];if(!f.rigBody.isStatic){a.updateMonsterParamsAngGUI(f.label);break}b.splice(d,1)}else c.monsterTarget&&(a.monsterParameters=c.monsterParameters.value.get(c.monsterTarget),a.monsterParameters&&(a.monsterParameters.object.monsterTarget=!1)),c.monsterTarget="",c.addClass(c.qs("monster-bar"),"hidden")})},keyDown:function(){var a=this;c.attachListener(document.body,"keydown",function(b){if(!this.preventControl&&c.characterParameters.value.health){var d=
c[a.characterState].storage[0].status;switch(b.keyCode){case 87:a.moveUp=!0;c.objTranslate.value.moveUp=!0;"up"!==c.characterStatus.value&&(c.characterStatus.value="up");"walk"===d||a.jump||c[a.characterState].set(a.object.label,"walk");a.dirSwitch.delayDir=2;break;case 83:a.moveDown=!0;c.objTranslate.value.moveDown=!0;"down"!==c.characterStatus.value&&(c.characterStatus.value="down");"walk"===d||a.jump||c[a.characterState].set(a.object.label,"walk");a.dirSwitch.delayDir=2;break;case 70:a.findTargetToAttack();
break;case 65:a.moveLeft=!0;c.objTranslate.value.moveLeft||(c.objTranslate.value.moveLeft=!0);"left"!==c.characterStatus.value&&(c.characterStatus.value="left");a.dirSwitch.delayDir=2;break;case 68:a.moveRight=!0;c.objTranslate.value.moveRight||(c.objTranslate.value.moveRight=!0);"right"!==c.characterStatus.value&&(c.characterStatus.value="right");a.dirSwitch.delayDir=2;break;case 32:""!==c.monsterTarget||a.dungeonActive&&!a.object.forceGravity||(a.jump=!0,c.characterStatus.value="jump")}a.objTranslate.isCenter.state||
(a.objTranslate.staticObjMoveX=a.moveStaticX=a.moveReplaceX,a.objTranslate.staticObjMoveY=a.moveStaticY=a.moveReplaceY)}})},keyUp:function(){function a(){b.moveUp||b.moveDown||b.moveLeft||b.moveRight||b.jump||c[b.characterState].set(b.object.label,"idle")}var b=this;c.attachListener(document.body,"keyup",function(d){if(c.characterParameters.value.health&&!this.preventControl)switch(d.keyCode){case 87:b.moveUp=!1;c.objTranslate.value.moveUp=!1;a();c.characterStatus.value="idle";break;case 83:b.moveDown=
!1;c.objTranslate.value.moveDown=!1;a();c.characterStatus.value="idle";break;case 65:b.moveLeft=!1;a();c.characterStatus.value="idle";c.objTranslate.value.moveLeft=!1;break;case 68:b.moveRight=!1,a(),c.objTranslate.value.moveRight=!1,c.characterStatus.value="idle"}}.bind(this))},velocity:0,translating:!1,screenCheck:function(){var a=c.activeMap.value,b=this.objTranslate;this.activeMap!==a&&(this.staticWallOutter=c.staticWallOutter.value(),this.activeMap=a,this.block=c.inrender?c.inrender():!1,/dungeon/i.test(a)?
(b.staticObjMoveX=this.moveStaticX,b.staticObjMoveY=this.moveStaticY,this.dungeonActive=!0):(this.moveStaticY=3,b.staticObjMoveY=this.moveStaticY,this.dungeonActive=!1));if(!c.isSwitchMapActive&&this.characterParameters.health){var d=c.browserWidthUpdate,k=c.browserHeightUpdate,h=this.object.position,g=this.staticWallOutter[3].position,l=this.staticWallOutter[2].position,p=this.staticWallOutter[1].position,n=this.staticWallOutter[0].position,m=b.staticObjStateY,r=b.staticObjStateX;a=b.isCenter;var v=
d/2,u=k/2,K=b.staticObjMoveY,C=Math.abs(u-Math.floor(h.y));a.init=!0;(!this.isTranslateY||!this.jump)&&10>C&&m?(b.staticObjStateY="",!this.dungeonActive&&b.moveDown&&(b.moveDown=!1),!this.dungeonActive&&b.moveUp&&(b.moveUp=!1)):this.isTranslateY&&this.jump||!(10<u-h.y)?this.isTranslateY&&this.jump||!(0>u-0-h.y)?(this.isTranslateY||this.jump)&&m&&(b.staticObjStateY=""):p.y-30>=k+10?(b.staticObjStateY="down",b.moveDown=!0,this.dungeonActive||(b.moveDown=!0,this.moveStaticY+=.2,b.staticObjMoveY=0<this.object.moveStaticY.y?
b.staticObjMoveY+.2:Math.floor(this.moveStaticY))):(a.init=!1,m&&(b.staticObjStateY="")):0>n.y+30?(b.staticObjStateY="up",this.dungeonActive||(b.moveUp=!0,4!==K&&(b.staticObjMoveY=4),this.moveStaticY=9)):(a.init=!1,m&&(b.staticObjStateY=""));k=Math.abs(v-Math.floor(h.x));0<k&&10>=k?(b.staticObjStateX="",b.moveLeft&&(b.moveLeft=!1),b.moveRight&&(b.moveRight=!1)):10<v-h.x?0>g.x+30?b.staticObjStateX="left":(a.init=!1,r&&(b.staticObjStateX="")):0>v-0-h.x&&(l.x-30>=d+10?(b.staticObjStateX="right",b.moveRight=
!0,b.staticObjAllX=!0):(a.init=!1,r&&(b.staticObjStateX="")));a.state&&(d=v-h.x,g=u-h.y,h=c.moveVector2dWithVelocity(h,{x:v,y:u},Math.abs((Math.abs(d)>Math.abs(g)?d:g)/10)),30<=d||30<=g||-30>=d||-30>=g?(30<=d&&(b.staticObjMoveX=h.x),30<=g&&(b.staticObjMoveY=h.y),-30>=d&&(b.staticObjMoveX=Math.abs(h.x)),-30>=g&&(b.staticObjMoveY=Math.abs(h.y))):(b.staticObjMoveX=this.moveReplaceX,b.staticObjMoveY=this.moveReplaceY,a.state=!1))}},onMove:function(){var a=this;c.attachListener(a.container,c.CursorStartEvent,
function(a){});c.attachListener(a.container,c.CursorEndEvent,function(a){});c.attachListener(a.container,c.CursorLeaveEvent,function(a){});c.attachListener(a.container,c.CursorMoveEvent,function(b){a.mousePosX=b.clientX;a.mousePosY=b.clientY})},avatar:"chara.png",updateAvatar:function(){c.css(c.qs("chara-url"),{background:"transparent url("+c.path+this.avatar+") no-repeat top center","background-size":"100% auto"})},updateMpBar:function(){c.text(c.qs("mp-indicator-text"),Math.round(this.characterParameters.mp)+
" / "+Math.round(this.characterParameters.maxMp));c.qs("mp-circle-bar").className="c100 blue mp-circle-bar p"+Math.floor(this.characterParameters.mp/this.characterParameters.maxMp*100)},updateHpBar:function(){c.text(c.qs("hp-indicator-text"),Math.round(this.characterParameters.health)+" / "+Math.round(this.characterParameters.maxHealth));c.qs("hp-circle-bar").className="h100 red hpBox hp-circle-bar p"+Math.round(this.characterParameters.health/this.characterParameters.maxHealth*100)},initControl:function(){this.object.statParameters=
this.characterParameters;this.onMove();this.keyUp();this.keyDown();this.event();this.updateHpBar();this.updateMpBar();c[this.characterState].set(this.object.label,"idle");c.characterMobileControl.value.charObj=this}};c.extend(a,new c.components.buff,!0);c.extend(a,new c.components.companions("chara"),!0);c.extend(a,new c.components.objPropertyFn("chara"),!0);c.extend(a,new c.physicsComponent.itemTrajectoryComponent,!0);c.extend(a,new c.AI.pathFinding,!0);c.extend(a,new c.AI.attackBehaviour("chara"),
!0);c.extend(a,new c.AI.skillBehaviour({character:!0},a),!0);c.extend(a,new c.AI.playerProperies,!0);c.extend(a.attackFrame,new c.components.attackFrameAttribute,!0);c.characterControl=a;c.oval.value.rigBody=a;c.text(c.qs("mp-indicator-text"),a.mp+" / "+a.maxMp);c.text(c.qs("hp-indicator-text"),a.health+" / "+a.maxHealth);a.initControl()},statics:function(){var a=this;var c={staticWallOutter:a.staticWallOutter.value(),object:a.oval.value,activeMap:"",isInPortalFn:function(a){var b=this.object.position;
return a.x<b.x&&a.y<b.y&&a.xMax()>b.x&&a.yMax()>b.y&&a.isVisible},installMapObject:function(c,b){var d=a.staticAllMap.value[c].content,f=a.monsterParameters.value.storage;"add"===b&&(f.length=0,a.monsterGetDamage.value.storage.length=0);var h=function(b,c,d){if(/monster/i.test(b))if("add"===c)a.monsterParameters.value.set(b,d);else for(c=0,d=f.length;c<d;c++)f[c]&&f[c].name===b&&a.monsterParameters.value.remove(b)},g;for(g in d)if(g in d){var l=d[g];if(d[g]instanceof Array)for(var p=0;p<l.length;p++)if("add"===
b)if(l[p].layer&&!localStorage.getItem("load")&&l[p].appear)for(var n=0,m=l[p].layer.object;n<m.length;n++)a.World.add(a.engine.world,m[n]);else a.World.add(a.engine.world,l[p]),l[p].rigBody&&h(l[p].label,"add",l[p].rigBody.monsterParameters);else if(l[p].layer&&!localStorage.getItem("load")&&l[p].appear)for(n=0,m=l[p].layer.object;n<m.length;n++)a.World.remove(a.engine.world,m[n]);else a.World.remove(a.engine.world,l[p]),h(l[p].label,"remove");else"add"===b?(a.World.add(a.engine.world,l),l.rigBody&&
h(l.label,"add",l.rigBody.monsterParameters)):(a.World.remove(a.engine.world,l),h(l.label,"remove"))}}};a.staticControl=c},geometries:function(){var a=this,c,f={createWall:function(b,d){d&&"large"===d?heightBottom=c=heightLeft=heightRight=6E3:d&&"medium"===d?(heightRight=6E3,heightLeft=3E3,heightBottom=c=6E3):heightBottom=c=heightLeft=heightRight=3E3;var f=a.Bodies.rectangle(heightRight,-(heightRight/2)+a.browserHeightUpdate,50,heightRight,{isStatic:!0}),h=a.Bodies.rectangle(0,-(heightLeft/2)+a.browserHeightUpdate,
50,heightLeft,{isStatic:!0}),g=a.Bodies.rectangle(h.bounds.min.x+c/2,h.bounds.min.y+50,c,50,{isStatic:!0}),l=a.Bodies.rectangle(heightBottom/2,h.bounds.max.y+50,heightBottom,50,{isStatic:!0});g.label="staticWallTop"+b;l.label="staticWallBottom"+b;f.label="staticWallRight"+b;h.label="staticWallLeft"+b;return[g,l,f,h]},createLayer:function(b,c){return a.staticGeometry.createLayer({label:b,rangeX:c.x,rangeY:c.y,attach:"staticWallOutterBottom",layer:{object:c.layer,init:!1,firstLoad:!1},install:!1,width:3E3,
height:3E3,location:c.location})},createBackground:function(b,c,f,h){for(var d=["a_133.png a_134.png a_135.png a_136.png a_137.png a_138.png a_139.png a_140.png a_141.png a_142.png a_143.png a_144.png".split(" "),"a_121.png a_122.png a_123.png a_124.png a_125.png a_126.png a_127.png a_128.png a_129.png a_130.png a_131.png a_132.png".split(" "),"a_109.png a_110.png a_111.png a_112.png a_113.png a_114.png a_115.png a_116.png a_117.png a_118.png a_119.png a_120.png".split(" "),"a_97.png a_98.png a_99.png a_100.png a_101.png a_102.png a_103.png a_104.png a_105.png a_106.png a_107.png a_108.png".split(" "),
"a_85.png a_86.png a_87.png a_88.png a_89.png a_90.png a_91.png a_92.png a_93.png a_94.png a_95.png a_96.png".split(" "),"a_73.png a_74.png a_75.png a_76.png a_77.png a_78.png a_79.png a_80.png a_81.png a_82.png a_83.png a_84.png".split(" "),"a_61.png a_62.png a_63.png a_64.png a_65.png a_66.png a_67.png a_68.png a_69.png a_70.png a_71.png a_72.png".split(" "),"a_49.png a_50.png a_51.png a_52.png a_53.png a_54.png a_55.png a_56.png a_57.png a_58.png a_59.png a_60.png".split(" "),"a_37.png a_38.png a_39.png a_40.png a_41.png a_42.png a_43.png a_44.png a_45.png a_46.png a_47.png a_48.png".split(" "),
"a_25.png a_26.png a_27.png a_28.png a_29.png a_30.png a_31.png a_32.png a_33.png a_34.png a_35.png a_36.png".split(" "),"a_13.png a_14.png a_15.png a_16.png a_17.png a_18.png a_19.png a_20.png a_21.png a_22.png a_23.png a_24.png".split(" "),"a_01.png a_02.png a_03.png a_04.png a_05.png a_06.png a_07.png a_08.png a_09.png a_10.png a_11.png a_12.png".split(" ")],l=h?500:0,k=h=h?h:0;k<b+h;k++)a.staticGeometry.createEnviPoint(f,{background:!0,scr:a.path+c,indexRepeat:k,layer:d,range:0,attach:"staticWallOutterBottom",
repeat:d[k],repeatX:500,additionalHeight:k?l-=500:0})},createSVGBuffer:function(b,c,f,h){a.svgCount.tot++;a.transport({url:b,type:"GET",requestHeader:{"Content-Type":"image/svg+xml"},callback:function(b){var d=[];a.svgCount.current++;b=(new DOMParser).parseFromString(b,"image/svg+xml");d.push(a.Svg.pathToVertices(b.getElementsByTagName("path")[0],150));b=a.Bodies.fromVertices(h.x,h.y,d,{isStatic:!0},!0);b.verticesOrigin=d[0];b.name=b.label=f;b.drawLine=new a.drawLine(b,b.verticesOrigin,"LINE_LOOP",
"buffer");a.activeMap.value===c&&a.World.add(a.engine.world,b);a.staticAllMap.value[c].content.staticOriGroupSVG.push(b)}})},createSVGPathBuffer:function(b,c,f,h,g){a.transport({url:b,type:"GET",requestHeader:{"Content-Type":"image/svg+xml"},callback:function(b){b=(new DOMParser).parseFromString(b,"image/svg+xml");a.staticGeometry.createSVGPathBuffer({drawLine:!1,location:c,additionalSize:g,parentLabel:h,label:f,vertices:a.Svg.pathToVertices(b.getElementsByTagName("path")[0],150)})}})},createSVGLineBuffer:function(b,
c,f,h){a.transport({url:b,type:"GET",requestHeader:{"Content-Type":"image/svg+xml"},callback:function(b){b=(new DOMParser).parseFromString(b,"image/svg+xml");a.staticGeometry.createSVGLineBuffer({location:c,position:h,label:f,vertices:a.Svg.pathToVertices(b.getElementsByTagName("path")[0],150)})}})},createNPC:function(b){var c=a.Bodies.rectangle(b.x,b.y,60,60,{isStatic:!0,render:{sprite:{texture:b.texture}}});c.name=c.label=b.label;c.additionalBoundsValue=b.additionalBoundsValue;c.additionalBoundsHeightValue=
b.additionalBoundsHeightValue;c.additionalBoundsWidthValue=b.additionalBoundsWidthValue;c.behaveState=b.behaveState;c.touch=b.touch;c.isVisible=b.isVisible;c.quest={update:[],mapMark:new a.draw.mapMark,target:b.target};return c},createPoint:function(b){var c=a.Bodies.rectangle(b.x,b.y,1,1,{isStatic:!0});c.name=c.label=b.label;c.src=b.texture;c.fixedBounds=!!b.fixedBounds&&b.fixedBounds||0;c.isVisible="undefined"===typeof b.isVisible&&!0||b.isVisible;c.quest={update:[],mapMark:new a.draw.mapMark,target:b.target};
return c}};a.fragment=[function(){var b=a.Bodies.rectangle(500,a.halfBottom,128,25,{isStatic:!0});b.label="staticBoxPreventJumpSpawnA";b.src=a.path+"grass/grassHalf.png";var c=a.Bodies.rectangle(3100,a.halfBottom,128,25,{isStatic:!0});c.label="staticSpawnPhaseOneB";c.src=a.path+"grass/grassHalf.png";var k=a.Bodies.rectangle(3300,a.halfCenter,256,25,{isStatic:!0});k.label="staticBoxSmallB";k.src=a.path+"grass/staticBoxSmallB.png";var h=a.Bodies.rectangle(3500,a.halfTopCenter,128,25,{isStatic:!0});
h.label="staticSpawnPhaseOneC";h.src=a.path+"grass/grassHalf.png";for(var g=200,l=3500,p=[],n=0;3>n;n++)if(l+=g,1===n){var m=a.Bodies.rectangle(l,a.halfTopTop,600,50,{isStatic:!0});m.label="staticBoxPreventJumpMapAA";m.src=a.path+"grass/preventJumpA.png";l+=100}else if(2===n){var r=a.Bodies.rectangle((l+=g)+400-75,a.levelHeight,300,50,{isStatic:!0});r.moveSate=!0;r.label="staticBoxPreventJumpUpDownA";r.switchTo="up";r.moveEnd=a.halfTopTop;r.moveStart=a.levelHeight;r.src=a.path+"grass/rollUp.png";
var v=a.Bodies.rectangle(l+=g/2-25,a.halfCenter,200,a.levelHeight+50,{isStatic:!0});v.label="staticBoxUpA";v.src=a.path+"grass/hill.png";var u=a.Bodies.rectangle(l+=2*g+50,a.levelHeight-50,50,50,{isStatic:!0});u.label="staticBoxrollPairA";u.triggerTo="staticBoxPreventJumpUpDownA";u.switchState=!0;p.push(u);var K=a.Bodies.rectangle(l,a.halfTopTop+a.halfBottomLvl2,85,50,{isStatic:!0});K.label="staticBoxLvlB3a";K.src=a.path+"grass/grassHalfSmall.png";p.push(K);K=a.Bodies.rectangle(l-g,a.halfCenterLvl2,
85,50,{isStatic:!0});K.label="staticBoxLvlB3b";K.src=a.path+"grass/grassHalfSmall.png";p.push(K);u=a.Bodies.rectangle(l,a.halfTopCenterLvl2,85,50,{isStatic:!0});u.label="staticBoxLvlB3c";u.src=a.path+"grass/grassHalfSmall.png";var C=a.Bodies.rectangle(l-3*g,a.halfCenterLvl2,200,50,{isStatic:!0});C.label="staticBoxLvlB3d";C.src=a.path+"grass/grassMed.png";var A=a.Bodies.rectangle(l+=g+400+25,a.halfTopTopLvl2,850,50,{isStatic:!0});A.label="staticBoxPreventJumpMapAB6";A.src=a.path+"grass/grass850.png"}g=
200;var D=3500,t=100;l=[];for(n=0;21>n;n++)if(5===n){var W=a.Bodies.rectangle(D+g-125,a.halfTopTop+a.halfBottomLvl2/2,50,a.halfBottomLvl2-50,{isStatic:!0});W.label="staticBoxPreventJumpMapAB2";W.src=a.path+"grass/grassHill.png"}else if(3<n){if(16===n){var J=a.Bodies.rectangle((D+g)/2,a.halfBottomLvl2,2600,50,{isStatic:!0});J.label="staticBoxPreventJumpMapAB3";J.src=a.path+"grass/preventJumpC.png"}17===n&&(K=a.Bodies.rectangle(t,a.halfTopCenter,200,50,{isStatic:!0}),K.label="staticBoxPreventJumpMapAB4",
K.src=a.path+"grass/grassMed.png",l.push(K));if(19===n){var ya=a.Bodies.rectangle(t+=4*g,a.halfTopTop+a.halfBottomLvl2/2,10,10,{isStatic:!0});ya.label="staticBoxPreventJump-"+n}}else{if(3===n){var G=a.Bodies.rectangle(D+g,a.halfTopTop,600,50,{isStatic:!0});G.label="staticBoxPreventJumpMapAB1";G.src=a.path+"grass/preventJumpB.png"}D-=g}g=0;a.staticGeometry.createEnviPoint("mapA",{src:a.path+"ornaments/grassSmallLeft.png",range:g+=400,attach:"staticWallOutterBottom"});a.staticGeometry.createEnviPoint("mapA",
{src:a.path+"ornaments/fence.png",range:g+=1200,attach:"staticWallOutterBottom"});a.staticGeometry.createEnviPoint("mapA",{src:a.path+"ornaments/grassSmallLeft.png",range:g+=100,attach:"staticWallOutterBottom"});a.staticGeometry.createEnviPoint("mapA",{src:a.path+"ornaments/bush.png",range:g+=2300,attach:"staticWallOutterBottom"});a.staticGeometry.createEnviPoint("mapA",{src:a.path+"ornaments/foliagePack.png",range:g+=1200,attach:"staticWallOutterBottom"});a.staticGeometry.createEnviPoint("mapA",
{src:a.path+"ornaments/flwrC.png",range:g+100,attach:"staticWallOutterBottom"});a.staticGeometry.createEnviPoint("mapA",{src:a.path+"ornaments/grassSamllB.png",range:150,attach:"staticBoxSmallB"});g=0;a.staticGeometry.createEnviPoint("mapA",{src:a.path+"ornaments/foliagePack.png",range:g+=130,attach:"staticBoxPreventJumpMapAB1"});a.staticGeometry.createEnviPoint("mapA",{src:a.path+"ornaments/mushroomRedSmall.png",range:g+=40,attach:"staticBoxPreventJumpMapAB1"});a.staticGeometry.createEnviPoint("mapA",
{src:a.path+"ornaments/grassSmallC.png",range:g+40,attach:"staticBoxPreventJumpMapAB1"});g=0;a.staticGeometry.createEnviPoint("mapA",{src:a.path+"ornaments/fence.png",range:g+=600,attach:"staticBoxPreventJumpMapAB3"});a.staticGeometry.createEnviPoint("mapA",{src:a.path+"ornaments/tree-big.png",range:g+=100,attach:"staticBoxPreventJumpMapAB3"});a.staticGeometry.createEnviPoint("mapA",{src:a.path+"ornaments/tree-small.png",range:g+=150,attach:"staticBoxPreventJumpMapAB3"});a.staticGeometry.createEnviPoint("mapA",
{src:a.path+"ornaments/grassSmallE.png",range:g+=750,attach:"staticBoxPreventJumpMapAB3"});a.staticGeometry.createEnviPoint("mapA",{src:a.path+"ornaments/grassSmallD.png",range:g+200,attach:"staticBoxPreventJumpMapAB3"});a.staticGeometry.createEnviPoint("mapA",{src:a.path+"ornaments/grassSmallD.png",range:50,attach:"staticSpawnPhaseOneH"});g=0;a.staticGeometry.createEnviPoint("mapA",{src:a.path+"ornaments/mushroomRedSmall.png",range:g+=150,attach:"staticBoxPreventJumpMapAA"});a.staticGeometry.createEnviPoint("mapA",
{src:a.path+"ornaments/mushroomRedMed.png",range:g+50,attach:"staticBoxPreventJumpMapAA"});a.staticGeometry.createEnviPoint("mapA",{src:a.path+"ornaments/bush.png",range:50,attach:"staticBoxUpA"});g=0;a.staticGeometry.createEnviPoint("mapA",{src:a.path+"ornaments/bush.png",range:g+=50,attach:"staticBoxPreventJumpMapAB6"});a.staticGeometry.createEnviPoint("mapA",{src:a.path+"ornaments/stoneA.png",range:g+=50,attach:"staticBoxPreventJumpMapAB6"});a.staticGeometry.createEnviPoint("mapA",{src:a.path+
"ornaments/foliagePackB.png",range:g+50,attach:"staticBoxPreventJumpMapAB6"});g=a.staticGeometry.createPortal({width:200,height:200,range:100,color:a.rgbRandom(1),effect:"glowPortal",attach:"staticBoxPreventJumpMapAB3",location:"mapA",targetLocation:"mapB"});n=a.staticGeometry.createPortal({width:200,height:200,range:500,color:a.rgbRandom(1),effect:"glowPortal",attach:"staticWallOutterBottom",location:"mapA",targetLocation:"mapAADungeonA"});K=a.staticGeometry.createPortal({width:200,height:200,range:700,
attach:"staticWallOutterBottom",color:a.rgbRandom(1),effect:"glowPortal",location:"mapA",targetLocation:"mapDungeonH"});a.staticAllMap.value.mapA.content={staticWallOuttermapA:f.createWall("mapA","medium"),staticSpawnPhaseOneA:b,staticSpawnPhaseOneB:c,staticSpawnPhaseOneC:h,staticSpawnPhaseOneD:ya,staticSpawnPhaseOneG:u,staticSpawnPhaseOneH:C,staticOriPortalMapA:g,staticOriPortalMapAA:n,staticOriPortalMapATemp:K,staticBoxSmallJumpC:p,staticBoxSmallJumpD:l,staticSpawnPhaseOneF:W,staticBoxPreventJumpMapAB6:A,
staticBoxPreventJumpMapAA:m,staticBoxPreventJumpMapAB1:G,staticBoxPreventJumpMapAB3:J,staticBoxPreventJumpUpDownA:r,staticBoxUpA:v,staticBoxSmallB:k};return a.staticAllMap.value.mapA.content}(),function(){var b=a.path+"ornaments/h/",c=a.browserHeightUpdate,k=c-3E3;f.createBackground(6,"ornaments/h/","mapDungeonD",6);a.staticGeometry.createMap({location:"mapDungeonD",src:b+"map.png"});var h=f.createPoint({label:"staticOriDngDPassStB",texture:a.path+"1px.png",x:1960,y:k+1185,target:"help"}),g=f.createPoint({label:"staticOriDngDPassStC",
texture:a.path+"1px.png",x:3106,y:k+2185,target:"help"}),l=f.createPoint({label:"staticOriDngDPassStD",texture:a.path+"1px.png",x:3790,y:k+1183,target:"help"}),p=f.createPoint({label:"staticOriDngDPassSpawnA",texture:a.path+"1px.png",x:355,y:k+1482,target:"help"}),n=f.createPoint({label:"staticOriDngDPassSpawnB",texture:a.path+"1px.png",x:750,y:k+2719,target:"help"}),m=f.createPoint({label:"staticOriDngDPassSpawnC",texture:a.path+"1px.png",x:5285,y:k+2059,target:"help"}),r=f.createPoint({label:"staticOriDngDPassSpawnD",
texture:a.path+"1px.png",x:5285,y:k+2059,target:"help"});f.createPoint({label:"staticOriDngDPassSpawnE",texture:a.path+"1px.png",x:5218,y:k+1088,target:"help"});f.createSVGBuffer(b+"buffer-a.svg","mapDungeonD","staticOriDngDBufferA",{x:2053,y:k+2705});f.createSVGPathBuffer(b+"path-buffer-a.svg","mapDungeonD","staticOriDngDPathBufferA","staticOriDngDBufferA",{x:0,y:-30});f.createSVGBuffer(b+"buffer-b.svg","mapDungeonD","staticOriDngDBufferB",{x:301,y:k+2245});f.createSVGBuffer(b+"buffer-c.svg","mapDungeonD",
"staticOriDngDBufferC",{x:1007,y:k+1438});f.createSVGBuffer(b+"buffer-d.svg","mapDungeonD","staticOriDngDBufferD",{x:857,y:k+375});f.createSVGBuffer(b+"buffer-e.svg","mapDungeonD","staticOriDngDBufferE",{x:3488,y:k+435});f.createSVGBuffer(b+"buffer-f.svg","mapDungeonD","staticOriDngDBufferF",{x:2408,y:k+1730});f.createSVGBuffer(b+"buffer-g.svg","mapDungeonD","staticOriDngDBufferG",{x:3601,y:k+1320});f.createSVGBuffer(b+"buffer-h.svg","mapDungeonD","staticOriDngDBufferH",{x:3780,y:k+2435});f.createSVGPathBuffer(b+
"path-buffer-h.svg","mapDungeonD","staticOriDngDPathBufferH","staticOriDngDBufferH");f.createSVGBuffer(b+"buffer-i.svg","mapDungeonD","staticOriDngDBufferI",{x:5257,y:k+2519});f.createSVGBuffer(b+"buffer-j.svg","mapDungeonD","staticOriDngDBufferJ",{x:4850,y:k+1627});f.createSVGPathBuffer(b+"path-buffer-j.svg","mapDungeonD","staticOriDngDPathBufferJ","staticOriDngDBufferJ");f.createSVGBuffer(b+"buffer-k.svg","mapDungeonD","staticOriDngDBufferK",{x:5319,y:k+540});f.createSVGPathBuffer(b+"path-buffer-b.svg",
"mapDungeonD","staticOriDngDPathBufferB","staticOriDngDBufferB",{x:50,y:0});f.createSVGPathBuffer(b+"path-buffer-c.svg","mapDungeonD","staticOriDngDPathBufferC","staticOriDngDBufferC");f.createSVGPathBuffer(b+"path-buffer-d.svg","mapDungeonD","staticOriDngDPathBufferD","staticOriDngDBufferD");f.createSVGPathBuffer(b+"path-buffer-e.svg","mapDungeonD","staticOriDngDPathBufferE","staticOriDngDBufferE",{x:-10,y:40});f.createSVGPathBuffer(b+"path-buffer-f.svg","mapDungeonD","staticOriDngDPathBufferF",
"staticOriDngDBufferF");f.createSVGPathBuffer(b+"path-buffer-g.svg","mapDungeonD","staticOriDngDPathBufferG","staticOriDngDBufferG");f.createSVGPathBuffer(b+"path-buffer-i.svg","mapDungeonD","staticOriDngDPathBufferI","staticOriDngDBufferI");f.createSVGPathBuffer(b+"path-buffer-k.svg","mapDungeonD","staticOriDngDPathBufferK","staticOriDngDBufferK",{x:0,y:-10});a.staticAllMap.value.mapDungeonD.content={staticWallOuttermapDungeonD:f.createWall("mapDungeonD","medium"),staticOriDngDPassSpawnA:p,staticOriDngDPassSpawnB:n,
staticOriDngDPassSpawnC:m,staticOriDngDPassSpawnD:r,staticOriDngDPassStB:h,staticOriDngDPassStC:g,staticOriDngDPassStD:l,staticOriGroupSVG:[],staticSpawnLabel:["staticOriDngDPassSpawnA","staticOriDngDPassSpawnB","staticOriDngDPassSpawnC","staticOriDngDPassSpawnD"],groupLayer:[f.createLayer("staticOriDPassLayerA",{x:0,y:0,location:"mapDungeonD",layer:function(){var d=a.Bodies.rectangle(377,k+1965,202,215,{isStatic:!0});d.src=b+"hs-a.png";d.fixedBounds=0;var g=a.Bodies.rectangle(502,k+1735,115,95,{isStatic:!0});
g.src=b+"obs-a.png";var f=a.Bodies.rectangle(860,k+1200,244,343,{isStatic:!0});f.src=b+"hs-keeper.png";f.fixedBounds=0;var h=a.Bodies.rectangle(1258,k+1386,135,209,{isStatic:!0});h.src=b+"tre-a.png";var l=a.Bodies.rectangle(389,k+985,83,147,{isStatic:!0});l.src=b+"obs-b.png";var p=a.Bodies.rectangle(1777,k+1875,224,117,{isStatic:!0});p.src=b+"tre-b.png";p.fixedBounds=-40;var n=a.Bodies.rectangle(1286,k+2898,82,104,{isStatic:!0});n.src=b+"obs-c.png";var m=a.Bodies.rectangle(1520,k+2698,55,79,{isStatic:!0});
m.src=b+"obs-d.png";var q=a.Bodies.rectangle(2216,k+2468,225,315,{isStatic:!0});q.src=b+"hs-keeper-b.png";var r=a.Bodies.rectangle(2240,k+1748,90,157,{isStatic:!0});r.src=b+"tre-c.png";var G=a.Bodies.rectangle(2437,k+1667,156,210,{isStatic:!0});G.src=b+"hs-b.png";var t=a.Bodies.rectangle(2774,k+1497,119,208,{isStatic:!0});t.src=b+"tre-d.png";d=[d,g,f,h,l,p,n,m,q,r,G,t];g=0;for(f=d.length;g<f;g++)d[g].name=d[g].label="staticOriDPass"+a.uniqueId(),d[g].FixedPosition={x:d[g].position.x,y:d[g].position.y-
c},d[g].fixedBounds||(d[g].fixedBounds=25);return d}()}),f.createLayer("staticOriDPassLayerB",{x:3E3,y:0,location:"mapDungeonD",layer:function(){var d=a.Bodies.rectangle(538,k+1237,118,151,{isStatic:!0});d.src=b+"tre-e.png";var g=a.Bodies.rectangle(902,k+986,55,78,{isStatic:!0});g.src=b+"obs-e.png";var f=a.Bodies.rectangle(1320,k+846,156,210,{isStatic:!0});f.src=b+"hs-c.png";var h=a.Bodies.rectangle(1324,k+1041,119,208,{isStatic:!0});h.src=b+"tre-d.png";var l=a.Bodies.rectangle(1194,k+1058,55,78,
{isStatic:!0});l.src=b+"obs-f.png";var p=a.Bodies.rectangle(550,k+1749,224,117,{isStatic:!0});p.src=b+"tre-b.png";p.fixedBounds=-40;var n=a.Bodies.rectangle(656,k+2403,186,208,{isStatic:!0});n.src=b+"tre-f.png";var m=a.Bodies.rectangle(1219,k+2383,119,208,{isStatic:!0});m.src=b+"tre-d.png";var q=a.Bodies.rectangle(915,k+2282,225,315,{isStatic:!0});q.src=b+"hs-keeper-b.png";var r=a.Bodies.rectangle(2067,k+2416,224,117,{isStatic:!0});r.src=b+"tre-b.png";r.fixedBounds=-40;var t=a.Bodies.rectangle(2324,
k+2364,156,210,{isStatic:!0});t.src=b+"hs-c.png";var P=a.Bodies.rectangle(1484,k+1684,82,104,{isStatic:!0});P.src=b+"obs-c.png";var B=a.Bodies.rectangle(1681,k+1562,224,315,{isStatic:!0});B.src=b+"hs-keeper-c.png";var S=a.Bodies.rectangle(2373,k+1410,225,315,{isStatic:!0});S.src=b+"hs-keeper-b.png";var L=a.Bodies.rectangle(2109,k+1087,76,71,{isStatic:!0});L.src=b+"obs-g.png";var Q=a.Bodies.rectangle(2246,k+296,119,208,{isStatic:!0});Q.src=b+"tre-d.png";var M=a.Bodies.rectangle(2581,k+464,156,210,
{isStatic:!0});M.src=b+"hs-c.png";var N=a.Bodies.rectangle(2777,k+550,90,157,{isStatic:!0});N.src=b+"tre-c.png";var Z=a.Bodies.rectangle(199,k+2199,83,147,{isStatic:!0});Z.src=b+"obs-b.png";d=[d,g,f,h,l,p,n,m,q,r,t,P,B,S,L,Q,M,N,Z];g=0;for(f=d.length;g<f;g++)d[g].name=d[g].label="staticOriDPass"+a.uniqueId(),d[g].FixedPosition={x:d[g].position.x,y:d[g].position.y-c},d[g].fixedBounds||(d[g].fixedBounds=25);return d}()})]};return a.staticAllMap.value.mapDungeonD.content}(),function(){var b=a.path+"ornaments/j/",
c=a.browserHeightUpdate,k=c-3E3;f.createBackground(6,"/ornaments/j/","mapDungeonF",6);a.staticGeometry.createMap({location:"mapDungeonF",src:b+"map.png"});var h=f.createPoint({label:"staticOriDngFPassStA",texture:a.path+"1px.png",x:1673,y:k+1548,target:"help"}),g=f.createPoint({label:"staticOriDngFPassStB",texture:a.path+"1px.png",x:3543,y:k+1815,target:"help"}),l=f.createPoint({label:"staticOriDngFPassSpawnA",texture:a.path+"1px.png",x:5362,y:k+628,target:"help"}),p=f.createPoint({label:"staticOriDngFPassSpawnB",
texture:a.path+"1px.png",x:5319,y:k+2454,target:"help"}),n=f.createPoint({label:"staticOriDngFPassSpawnC",texture:a.path+"1px.png",x:2971,y:k+1973,target:"help"}),m=f.createPoint({label:"staticOriDngFPassSpawnD",texture:a.path+"1px.png",x:562,y:k+2562,target:"help"});f.createSVGBuffer(b+"buffer-a.svg","mapDungeonF","staticOriDngFBufferA",{x:438,y:k+1058});f.createSVGPathBuffer(b+"path-buffer-a.svg","mapDungeonF","staticOriDngFPathBufferA","staticOriDngFBufferA",{x:0,y:0});f.createSVGBuffer(b+"buffer-b.svg",
"mapDungeonF","staticOriDngFBufferB",{x:1030,y:k+954});f.createSVGPathBuffer(b+"path-buffer-b.svg","mapDungeonF","staticOriDngFPathBufferB","staticOriDngFBufferB",{x:0,y:0});f.createSVGBuffer(b+"buffer-c.svg","mapDungeonF","staticOriDngFBufferC",{x:1400,y:k+1150});f.createSVGPathBuffer(b+"path-buffer-c.svg","mapDungeonF","staticOriDngFPathBufferC","staticOriDngFBufferC",{x:0,y:0});f.createSVGBuffer(b+"buffer-d.svg","mapDungeonF","staticOriDngFBufferD",{x:1288,y:k+2072});f.createSVGPathBuffer(b+"path-buffer-d.svg",
"mapDungeonF","staticOriDngFPathBufferD","staticOriDngFBufferD",{x:0,y:0});f.createSVGBuffer(b+"buffer-e.svg","mapDungeonF","staticOriDngFBufferE",{x:2327,y:k+974});f.createSVGPathBuffer(b+"path-buffer-e.svg","mapDungeonF","staticOriDngFPathBufferE","staticOriDngFBufferE",{x:0,y:0});f.createSVGBuffer(b+"buffer-f.svg","mapDungeonF","staticOriDngFBufferF",{x:2203,y:k+401});f.createSVGPathBuffer(b+"path-buffer-f.svg","mapDungeonF","staticOriDngFPathBufferF","staticOriDngFBufferF",{x:0,y:0});f.createSVGBuffer(b+
"buffer-g.svg","mapDungeonF","staticOriDngFBufferG",{x:3123,y:k+958});f.createSVGPathBuffer(b+"path-buffer-g.svg","mapDungeonF","staticOriDngFPathBufferG","staticOriDngFBufferG",{x:0,y:0});f.createSVGBuffer(b+"buffer-h.svg","mapDungeonF","staticOriDngFBufferH",{x:3796,y:k+964});f.createSVGPathBuffer(b+"path-buffer-h.svg","mapDungeonF","staticOriDngFPathBufferH","staticOriDngFBufferH",{x:0,y:0});f.createSVGBuffer(b+"buffer-i.svg","mapDungeonF","staticOriDngFBufferI",{x:2850,y:k+1627});f.createSVGPathBuffer(b+
"path-buffer-i.svg","mapDungeonF","staticOriDngFPathBufferI","staticOriDngFBufferI",{x:0,y:0});f.createSVGBuffer(b+"buffer-j.svg","mapDungeonF","staticOriDngFBufferJ",{x:2716,y:k+2305});f.createSVGPathBuffer(b+"path-buffer-j.svg","mapDungeonF","staticOriDngFPathBufferJ","staticOriDngFBufferJ",{x:0,y:0});f.createSVGBuffer(b+"buffer-k.svg","mapDungeonF","staticOriDngFBufferK",{x:3252,y:k+2378});f.createSVGPathBuffer(b+"path-buffer-k.svg","mapDungeonF","staticOriDngFPathBufferK","staticOriDngFBufferK",
{x:0,y:0});f.createSVGBuffer(b+"buffer-l.svg","mapDungeonF","staticOriDngFBufferL",{x:4065,y:k+2160});f.createSVGPathBuffer(b+"path-buffer-l.svg","mapDungeonF","staticOriDngFPathBufferL","staticOriDngFBufferL",{x:0,y:0});f.createSVGBuffer(b+"buffer-m.svg","mapDungeonF","staticOriDngFBufferM",{x:4685,y:k+2160});f.createSVGPathBuffer(b+"path-buffer-m.svg","mapDungeonF","staticOriDngFPathBufferM","staticOriDngFBufferM",{x:5,y:-5});f.createSVGBuffer(b+"buffer-n.svg","mapDungeonF","staticOriDngFBufferN",
{x:4411,y:k+1517});f.createSVGPathBuffer(b+"path-buffer-n.svg","mapDungeonF","staticOriDngFPathBufferN","staticOriDngFBufferN",{x:0,y:5});f.createSVGBuffer(b+"buffer-o.svg","mapDungeonF","staticOriDngFBufferO",{x:4821,y:k+1158});f.createSVGPathBuffer(b+"path-buffer-o.svg","mapDungeonF","staticOriDngFPathBufferO","staticOriDngFBufferO",{x:0,y:0});f.createSVGBuffer(b+"buffer-p.svg","mapDungeonF","staticOriDngFBufferP",{x:5047,y:k+1025});f.createSVGPathBuffer(b+"path-buffer-p.svg","mapDungeonF","staticOriDngFPathBufferP",
"staticOriDngFBufferP",{x:0,y:-4});f.createSVGBuffer(b+"buffer-q.svg","mapDungeonF","staticOriDngFBufferQ",{x:4554,y:k+301});f.createSVGPathBuffer(b+"path-buffer-q.svg","mapDungeonF","staticOriDngFPathBufferQ","staticOriDngFBufferQ",{x:0,y:-4});f.createSVGBuffer(b+"buffer-r.svg","mapDungeonF","staticOriDngFBufferR",{x:3778,y:k+413});f.createSVGPathBuffer(b+"path-buffer-r.svg","mapDungeonF","staticOriDngFPathBufferR","staticOriDngFBufferR",{x:0,y:5});a.staticAllMap.value.mapDungeonF.content={staticWallOuttermapDungeonF:f.createWall("mapDungeonF",
"medium"),staticOriDngFPassStA:h,staticOriDngFPassStB:g,staticOriDngFPassSpawnA:l,staticOriDngFPassSpawnB:p,staticOriDngFPassSpawnC:n,staticOriDngFPassSpawnD:m,staticSpawnLabel:["staticOriDngFPassSpawnA","staticOriDngFPassSpawnB","staticOriDngFPassSpawnD"],staticOriGroupSVG:[],groupLayer:[f.createLayer("staticOriFPassLayerA",{x:0,y:0,location:"mapDungeonF",layer:function(){var d=a.Bodies.rectangle(515,c-3E3+2084,157,277,{isStatic:!0});d.src=b+"treeA.png";var g=a.Bodies.rectangle(1334,c-3E3+2617,121,
215,{isStatic:!0});g.src=b+"treeC.png";var f=a.Bodies.rectangle(1408,c-3E3+2543,120,217,{isStatic:!0});f.src=b+"treeD.png";var h=a.Bodies.rectangle(2096,c-3E3+2407,138,224,{isStatic:!0});h.src=b+"treeB.png";var l=a.Bodies.rectangle(2844,c-3E3+2584,159,278,{isStatic:!0});l.src=b+"treeE.png";var k=a.Bodies.rectangle(2659,c-3E3+2339,121,215,{isStatic:!0});k.src=b+"treeC.png";var p=a.Bodies.rectangle(2736,c-3E3+2257,159,282,{isStatic:!0});p.src=b+"treeF.png";var n=a.Bodies.rectangle(2837,c-3E3+2202,159,
282,{isStatic:!0});n.src=b+"treeF.png";var m=a.Bodies.rectangle(2599,c-3E3+1870,109,119,{isStatic:!0});m.src=b+"bfA.png";m.fixedBounds=25;var q=a.Bodies.rectangle(2784,c-3E3+1608,205,270,{isStatic:!0});q.src=b+"houseA.png";q.fixedBounds=45;var t=a.Bodies.rectangle(2911,c-3E3+1582,110,121,{isStatic:!0});t.src=b+"bfC.png";t.fixedBounds=25;var G=a.Bodies.rectangle(2313,c-3E3+1556,159,278,{isStatic:!0});G.src=b+"treeE.png";var P=a.Bodies.rectangle(1112,c-3E3+1711,138,224,{isStatic:!0});P.src=b+"treeB.png";
var B=a.Bodies.rectangle(1487,c-3E3+1969,282,289,{isStatic:!0});B.src=b+"houseB.png";B.fixedBounds=45;var S=a.Bodies.rectangle(1278,c-3E3+2075,101,115,{isStatic:!0});S.src=b+"bfB.png";S.fixedBounds=25;var L=a.Bodies.rectangle(1243,c-3E3+2169,109,119,{isStatic:!0});L.src=b+"bfA.png";L.fixedBounds=25;var Q=a.Bodies.rectangle(1799,c-3E3+2296,101,115,{isStatic:!0});Q.src=b+"bfB.png";Q.fixedBounds=25;var M=a.Bodies.rectangle(2025,c-3E3+2147,110,121,{isStatic:!0});M.src=b+"bfC.png";Q.fixedBounds=25;var N=
a.Bodies.rectangle(1731,c-3E3+1885,109,119,{isStatic:!0});N.src=b+"bfA.png";var Z=a.Bodies.rectangle(400,c-3E3+1088,159,278,{isStatic:!0});Z.src=b+"treeE.png";var ca=a.Bodies.rectangle(499,c-3E3+1031,109,119,{isStatic:!0});ca.src=b+"bfA.png";ca.fixedBounds=25;var da=a.Bodies.rectangle(534,c-3E3+937,101,115,{isStatic:!0});da.src=b+"bfB.png";da.fixedBounds=25;var X=a.Bodies.rectangle(1030,c-3E3+853,282,289,{isStatic:!0});X.src=b+"houseC.png";X.fixedBounds=45;var ea=a.Bodies.rectangle(1283,c-3E3+1100,
110,121,{isStatic:!0});ea.src=b+"bfC.png";ea.fixedBounds=25;var sa=a.Bodies.rectangle(1411,c-3E3+1078,188,332,{isStatic:!0});sa.src=b+"treeG.png";var Y=a.Bodies.rectangle(1503,c-3E3+1138,138,224,{isStatic:!0});Y.src=b+"treeB.png";var ia=a.Bodies.rectangle(1619,c-3E3+1120,109,119,{isStatic:!0});ia.src=b+"bfA.png";ia.fixedBounds=25;var ja=a.Bodies.rectangle(1889,c-3E3+1287,109,119,{isStatic:!0});ja.src=b+"bfA.png";ja.fixedBounds=25;var aa=a.Bodies.rectangle(2465,c-3E3+1153,110,121,{isStatic:!0});aa.src=
b+"bfC.png";aa.fixedBounds=25;var la=a.Bodies.rectangle(2763,c-3E3+1276,109,119,{isStatic:!0});la.src=b+"bfA.png";la.fixedBounds=25;var ma=a.Bodies.rectangle(2895,c-3E3+918,110,121,{isStatic:!0});ma.src=b+"bfC.png";ma.fixedBounds=25;var U=a.Bodies.rectangle(2651,c-3E3+1041,110,121,{isStatic:!0});U.src=b+"bfC.png";U.fixedBounds=25;var na=a.Bodies.rectangle(2569,c-3E3+914,159,278,{isStatic:!0});na.src=b+"treeE.png";var ba=a.Bodies.rectangle(2428,c-3E3+874,109,119,{isStatic:!0});ba.src=b+"bfA.png";ba.fixedBounds=
25;var fa=a.Bodies.rectangle(2157,c-3E3+763,290,329,{isStatic:!0});fa.src=b+"houseD.png";fa.fixedBounds=55;var ka=a.Bodies.rectangle(1864,c-3E3+894,110,121,{isStatic:!0});ka.src=b+"bfC.png";ka.fixedBounds=25;var ha=a.Bodies.rectangle(2371,c-3E3+387,159,278,{isStatic:!0});ha.src=b+"treeE.png";var ua=a.Bodies.rectangle(2301,c-3E3+264,159,278,{isStatic:!0});ua.src=b+"treeE.png";var qa=a.Bodies.rectangle(2175,c-3E3+300,192,332,{isStatic:!0});qa.src=b+"treeH.png";var ra=a.Bodies.rectangle(757,c-3E3+345,
159,278,{isStatic:!0});ra.src=b+"treeE.png";d=[d,g,f,h,l,k,p,n,m,q,t,G,P,B,S,L,Q,M,N,Z,ca,da,X,ea,sa,Y,ia,ja,aa,la,ma,U,na,ba,fa,ka,ha,ua,qa,ra];g=0;for(f=d.length;g<f;g++)d[g].name=d[g].label="staticOriEPass"+a.uniqueId(),d[g].FixedPosition={x:d[g].position.x,y:d[g].position.y-c},d[g].fixedBounds||(d[g].fixedBounds=5);return d}()}),f.createLayer("staticOriFPassLayerB",{x:3E3,y:0,location:"mapDungeonF",layer:function(){var d=a.Bodies.rectangle(95,c-1426,109,119,{isStatic:!0});d.src=b+"bfA.png";d.fixedBounds=
25;var g=a.Bodies.rectangle(155,c-1196,110,121,{isStatic:!0});g.src=b+"bfC.png";g.fixedBounds=25;var f=a.Bodies.rectangle(257,c-702,121,215,{isStatic:!0});f.src=b+"treeC.png";var h=a.Bodies.rectangle(336,c-658,121,215,{isStatic:!0});h.src=b+"treeC.png";var l=a.Bodies.rectangle(1008,c-538,157,277,{isStatic:!0});l.src=b+"treeA.png";var k=a.Bodies.rectangle(1696,c-402,121,215,{isStatic:!0});k.src=b+"treeC.png";var p=a.Bodies.rectangle(1770,c-328,120,217,{isStatic:!0});p.src=b+"treeD.png";var n=a.Bodies.rectangle(2589,
c-861,157,277,{isStatic:!0});n.src=b+"treeI.png";var m=a.Bodies.rectangle(1992,c-1234,138,244,{isStatic:!0});m.src=b+"treeJ.png";var q=a.Bodies.rectangle(1456,c-1601,192,332,{isStatic:!0});q.src=b+"treeH.png";var t=a.Bodies.rectangle(1364,c-1541,138,244,{isStatic:!0});t.src=b+"treeJ.png";var G=a.Bodies.rectangle(791,c-1389,159,278,{isStatic:!0});G.src=b+"treeE.png";var P=a.Bodies.rectangle(1115,c-908,110,121,{isStatic:!0});P.src=b+"bfC.png";P.fixedBounds=25;var B=a.Bodies.rectangle(1090,c-816,109,
119,{isStatic:!0});B.src=b+"bfA.png";B.fixedBounds=25;var S=a.Bodies.rectangle(1398,c-608,109,119,{isStatic:!0});S.src=b+"bfA.png";S.fixedBounds=25;var L=a.Bodies.rectangle(1885,c-743,110,121,{isStatic:!0});L.src=b+"bfC.png";L.fixedBounds=25;var Q=a.Bodies.rectangle(1843,c-835,101,115,{isStatic:!0});Q.src=b+"bfD.png";Q.fixedBounds=25;var M=a.Bodies.rectangle(1617,c-976,282,289,{isStatic:!0});M.src=b+"houseC.png";M.fixedBounds=45;var N=a.Bodies.rectangle(126,c-2079,205,270,{isStatic:!0});N.src=b+"houseF.png";
N.fixedBounds=45;var Z=a.Bodies.rectangle(256,c-2062,109,119,{isStatic:!0});Z.src=b+"bfA.png";Z.fixedBounds=25;var ca=a.Bodies.rectangle(241,c-1738,110,121,{isStatic:!0});ca.src=b+"bfC.png";ca.fixedBounds=25;var da=a.Bodies.rectangle(639,c-1792,109,119,{isStatic:!0});da.src=b+"bfA.png";da.fixedBounds=25;var X=a.Bodies.rectangle(1205,c-1762,110,121,{isStatic:!0});X.src=b+"bfC.png";X.fixedBounds=25;var ea=a.Bodies.rectangle(1843,c-1817,110,121,{isStatic:!0});ea.src=b+"bfC.png";ea.fixedBounds=25;var sa=
a.Bodies.rectangle(2704,c-1857,159,278,{isStatic:!0});sa.src=b+"treeE.png";var Y=a.Bodies.rectangle(2519,c-2050,101,115,{isStatic:!0});Y.src=b+"bfD.png";Y.fixedBounds=25;var ia=a.Bodies.rectangle(2347,c-2600,159,278,{isStatic:!0});ia.src=b+"treeE.png";var ja=a.Bodies.rectangle(1703,c-2787,188,332,{isStatic:!0});ja.src=b+"treeG.png";var aa=a.Bodies.rectangle(1577,c-2823,159,278,{isStatic:!0});aa.src=b+"treeE.png";var la=a.Bodies.rectangle(1507,c-2700,159,278,{isStatic:!0});la.src=b+"treeE.png";var ma=
a.Bodies.rectangle(815,c-2708,192,332,{isStatic:!0});ma.src=b+"treeH.png";var U=a.Bodies.rectangle(723,c-2648,134,224,{isStatic:!0});U.src=b+"treeJ.png";var na=a.Bodies.rectangle(117,c-2480,159,278,{isStatic:!0});na.src=b+"treeE.png";var ba=a.Bodies.rectangle(535,c-2031,159,278,{isStatic:!0});ba.src=b+"treeE.png";var fa=a.Bodies.rectangle(676,c-2071,110,121,{isStatic:!0});fa.src=b+"bfC.png";fa.fixedBounds=25;var ka=a.Bodies.rectangle(947,c-2182,290,329,{isStatic:!0});ka.src=b+"houseG.png";ka.fixedBounds=
55;var ha=a.Bodies.rectangle(1153,c-2137,110,121,{isStatic:!0});ha.src=b+"bfC.png";ha.fixedBounds=25;var ua=a.Bodies.rectangle(1294,c-2122,101,115,{isStatic:!0});ua.src=b+"bfD.png";ua.fixedBounds=25;var qa=a.Bodies.rectangle(1874,c-1889,109,119,{isStatic:!0});qa.src=b+"bfA.png";qa.fixedBounds=25;var ra=a.Bodies.rectangle(2074,c-2092,282,289,{isStatic:!0});ra.src=b+"houseB.png";ra.fixedBounds=45;d=[d,g,f,h,l,k,p,n,m,q,t,G,P,B,S,L,Q,M,N,Z,ca,da,X,ea,sa,Y,ia,ja,aa,la,ma,U,na,ba,fa,ka,ha,ua,qa,ra];g=
0;for(f=d.length;g<f;g++)d[g].name=d[g].label="staticOriFPass"+a.uniqueId(),d[g].FixedPosition={x:d[g].position.x,y:d[g].position.y-c},d[g].fixedBounds||(d[g].fixedBounds=5);return d}()})]};return a.staticAllMap.value.mapDungeonF.content}(),function(){var b=a.path+"ornaments/k/",c=a.browserHeightUpdate,k=c-6E3,h=f.createPoint({label:"staticOriDngGPassStA",texture:a.path+"1px.png",x:1026,y:k+4451,target:"help"}),g=f.createPoint({label:"staticOriDngGPassSpawnA",texture:a.path+"1px.png",x:694,y:k+5510,
target:"help"}),l=f.createPoint({label:"staticOriDngGPassSpawnB",texture:a.path+"1px.png",x:2541,y:k+5603,target:"help"}),p=f.createPoint({label:"staticOriDngGPassSpawnB",texture:a.path+"1px.png",x:2490,y:k+3965,target:"help"});f.createSVGBuffer(b+"buffer-a.svg","mapDungeonG","staticOriDngGBufferA",{x:306,y:k+4975});f.createSVGPathBuffer(b+"path-buffer-a.svg","mapDungeonG","staticOriDngGPathBufferA","staticOriDngGBufferA",{x:10,y:0});f.createSVGBuffer(b+"buffer-b.svg","mapDungeonG","staticOriDngGBufferB",
{x:1215,y:k+4955});f.createSVGPathBuffer(b+"path-buffer-b.svg","mapDungeonG","staticOriDngGPathBufferB","staticOriDngGBufferB",{x:-10,y:10});f.createSVGBuffer(b+"buffer-c.svg","mapDungeonG","staticOriDngGBufferC",{x:1760,y:k+5335});f.createSVGPathBuffer(b+"path-buffer-c.svg","mapDungeonG","staticOriDngGPathBufferC","staticOriDngGBufferC",{x:0,y:0});f.createSVGBuffer(b+"buffer-d.svg","mapDungeonG","staticOriDngGBufferD",{x:333,y:k+5426});f.createSVGPathBuffer(b+"path-buffer-d.svg","mapDungeonG","staticOriDngGPathBufferD",
"staticOriDngGBufferD",{x:0,y:0});f.createSVGBuffer(b+"buffer-e.svg","mapDungeonG","staticOriDngGBufferE",{x:625,y:k+3057});f.createSVGPathBuffer(b+"path-buffer-e.svg","mapDungeonG","staticOriDngGPathBufferE","staticOriDngGBufferE",{x:0,y:0});f.createSVGBuffer(b+"buffer-h.svg","mapDungeonG","staticOriDngGBufferH",{x:2919,y:k+4625});f.createSVGPathBuffer(b+"path-buffer-h.svg","mapDungeonG","staticOriDngGPathBufferH","staticOriDngGBufferH",{x:0,y:0});f.createBackground(6,"/ornaments/k/","mapDungeonG");
a.staticGeometry.createMap({location:"mapDungeonG",src:b+"map.png"});a.staticAllMap.value.mapDungeonG.content={staticWallOuttermapDungeonG:f.createWall("mapDungeonG","small"),staticOriDngGPassStA:h,staticOriDngGPassSpawnA:g,staticOriDngGPassSpawnB:l,staticOriDngGPassSpawnC:p,staticOriGroupSVG:[],staticSpawnLabel:["staticOriDngGPassSpawnA","staticOriDngGPassSpawnB","staticOriDngGPassSpawnC"],groupLayer:[f.createLayer("staticOriGPassLayerA",{x:0,y:0,location:"mapDungeonG",layer:function(){var d=a.Bodies.rectangle(92,
c-6E3+5263,139,224,{isStatic:!0});d.src=b+"treeA.png";var g=a.Bodies.rectangle(110,c-6E3+5084,192,333,{isStatic:!0});g.src=b+"treeB.png";var f=a.Bodies.rectangle(132,c-6E3+5E3,192,333,{isStatic:!0});f.src=b+"treeB.png";var h=a.Bodies.rectangle(224,c-6E3+5057,141,264,{isStatic:!0});h.src=b+"treeC.png";var l=a.Bodies.rectangle(343,c-6E3+5063,51,127,{isStatic:!0});l.src=b+"stoneE.png";var k=a.Bodies.rectangle(256,c-6E3+5789,148,198,{isStatic:!0});k.src=b+"stoneA.png";k.fixedBounds=45;var p=a.Bodies.rectangle(383,
c-6E3+5319,336,337,{isStatic:!0});p.src=b+"stoneC.png";p.fixedBounds=45;var m=a.Bodies.rectangle(587,c-6E3+5066,91,125,{isStatic:!0});m.src=b+"sign.png";var t=a.Bodies.rectangle(876,c-6E3+5190,170,207,{isStatic:!0});t.src=b+"stoneD.png";var E=a.Bodies.rectangle(1317,c-6E3+5575,192,332,{isStatic:!0});E.src=b+"treeD.png";var W=a.Bodies.rectangle(1443,c-6E3+5539,158,278,{isStatic:!0});W.src=b+"treeE.png";var J=a.Bodies.rectangle(1513,c-6E3+5662,158,278,{isStatic:!0});J.src=b+"treeE.png";var ya=a.Bodies.rectangle(1489,
c-6E3+5876,76,82,{isStatic:!0});ya.src=b+"stoneB.png";var G=a.Bodies.rectangle(1900,c-6E3+5802,158,278,{isStatic:!0});G.src=b+"treeE.png";var P=a.Bodies.rectangle(2002,c-6E3+5732,99,85,{isStatic:!0});P.src=b+"stoneF.png";var B=a.Bodies.rectangle(2566,c-6E3+5881,118,110,{isStatic:!0});B.src=b+"treeM.png";B.fixedBounds=45;var S=a.Bodies.rectangle(2831,c-6E3+5709,122,215,{isStatic:!0});S.src=b+"treeI.png";var L=a.Bodies.rectangle(2751,c-6E3+5632,120,217,{isStatic:!0});L.src=b+"treeH.png";var Q=a.Bodies.rectangle(2658,
c-6E3+5173,135,235,{isStatic:!0});Q.src=b+"treeL.png";var M=a.Bodies.rectangle(2560,c-6E3+5068,122,215,{isStatic:!0});M.src=b+"treeI.png";var N=a.Bodies.rectangle(2445,c-6E3+5203,158,282,{isStatic:!0});N.src=b+"treeK.png";var Z=a.Bodies.rectangle(2381,c-6E3+5010,158,282,{isStatic:!0});Z.src=b+"treeK.png";var ca=a.Bodies.rectangle(2166,c-6E3+5038,218,245,{isStatic:!0});ca.src=b+"stoneG.png";ca.fixedBounds=45;var da=a.Bodies.rectangle(1853,c-6E3+5182,448,438,{isStatic:!0});da.src=b+"houseA.png";da.fixedBounds=
60;var X=a.Bodies.rectangle(1588,c-6E3+4925,158,282,{isStatic:!0});X.src=b+"treeJ.png";var ea=a.Bodies.rectangle(1543,c-6E3+4998,120,217,{isStatic:!0});ea.src=b+"treeH.png";var sa=a.Bodies.rectangle(1429,c-6E3+5026,158,278,{isStatic:!0});sa.src=b+"treeE.png";var Y=a.Bodies.rectangle(89,c-6E3+4717,51,127,{isStatic:!0});Y.src=b+"stoneE.png";Y.fixedBounds=25;var ia=a.Bodies.rectangle(164,c-6E3+4552,191,172,{isStatic:!0});ia.src=b+"treeQ.png";var ja=a.Bodies.rectangle(296,c-6E3+4607,174,156,{isStatic:!0});
ja.src=b+"stoneI.png";ja.fixedBounds=25;var aa=a.Bodies.rectangle(651,c-6E3+4483,143,167,{isStatic:!0});aa.src=b+"treeN.png";var la=a.Bodies.rectangle(742,c-6E3+4205,160,205,{isStatic:!0});la.src=b+"treeP.png";var ma=a.Bodies.rectangle(798,c-6E3+4212,106,128,{isStatic:!0});ma.src=b+"treeO.png";var U=a.Bodies.rectangle(556,c-6E3+4017,160,205,{isStatic:!0});U.src=b+"treeP.png";var na=a.Bodies.rectangle(358,c-6E3+4263,131,205,{isStatic:!0});na.src=b+"stoneJ.png";na.fixedBounds=25;var ba=a.Bodies.rectangle(139,
c-6E3+4196,314,254,{isStatic:!0});ba.src=b+"stoneK.png";ba.fixedBounds=25;var fa=a.Bodies.rectangle(157,c-6E3+4122,313,261,{isStatic:!0});fa.src=b+"stoneL.png";fa.fixedBounds=25;var ka=a.Bodies.rectangle(173,c-6E3+3981,106,126,{isStatic:!0});ka.src=b+"treeR.png";var ha=a.Bodies.rectangle(94,c-6E3+3891,139,244,{isStatic:!0});ha.src=b+"treeA.png";var ua=a.Bodies.rectangle(113,c-6E3+3714,192,333,{isStatic:!0});ua.src=b+"treeB.png";var qa=a.Bodies.rectangle(133,c-6E3+3629,192,333,{isStatic:!0});qa.src=
b+"treeB.png";var ra=a.Bodies.rectangle(225,c-6E3+3688,141,246,{isStatic:!0});ra.src=b+"treeC.png";var V=a.Bodies.rectangle(1025,c-6E3+4854,148,129,{isStatic:!0});V.src=b+"treeS.png";V.fixedBounds=25;var Ba=a.Bodies.rectangle(1266,c-6E3+4790,104,122,{isStatic:!0});Ba.src=b+"treeR.png";var Ca=a.Bodies.rectangle(1301,c-6E3+4588,159,205,{isStatic:!0});Ca.src=b+"treeU.png";var za=a.Bodies.rectangle(1681,c-6E3+4637,159,192,{isStatic:!0});za.src=b+"treeT.png";za.fixedBounds=25;var Da=a.Bodies.rectangle(2079,
c-6E3+4407,160,205,{isStatic:!0});Da.src=b+"treeP.png";var Aa=a.Bodies.rectangle(2390,c-6E3+4682,188,172,{isStatic:!0});Aa.src=b+"treeX.png";Aa.fixedBounds=25;var Ka=a.Bodies.rectangle(2927,c-6E3+4519,336,337,{isStatic:!0});Ka.src=b+"stoneM.png";Ka.fixedBounds=25;var La=a.Bodies.rectangle(2903,c-6E3+3744,76,82,{isStatic:!0});La.src=b+"stoneB.png";var Ia=a.Bodies.rectangle(2452,c-6E3+3771,243,239,{isStatic:!0});Ia.src=b+"ruinD.png";Ia.fixedBounds=40;var xa=a.Bodies.rectangle(2385,c-6E3+3857,181,129,
{isStatic:!0});xa.src=b+"ruinC.png";xa.fixedBounds=40;var va=a.Bodies.rectangle(2003,c-6E3+4083,197,228,{isStatic:!0});va.src=b+"treeW.png";var ta=a.Bodies.rectangle(1752,c-6E3+3888,197,122,{isStatic:!0});ta.src=b+"root.png";ta.fixedBounds=40;var T=a.Bodies.rectangle(1578,c-6E3+4006,199,109,{isStatic:!0});T.src=b+"ruinB.png";T.fixedBounds=40;var R=a.Bodies.rectangle(1302,c-6E3+4271,143,168,{isStatic:!0});R.src=b+"treeV.png";var w=a.Bodies.rectangle(978,c-6E3+3956,157,106,{isStatic:!0});w.src=b+"ruinA.png";
w.fixedBounds=30;var H=a.Bodies.rectangle(2761,c-6E3+3396,230,276,{isStatic:!0});H.src=b+"treeAA.png";H.fixedBounds=25;var wa=a.Bodies.rectangle(2614,c-6E3+3141,120,217,{isStatic:!0});wa.src=b+"treeH.png";var oa=a.Bodies.rectangle(2688,c-6E3+3067,122,215,{isStatic:!0});oa.src=b+"treeI.png";var pa=a.Bodies.rectangle(2155,c-6E3+3240,106,128,{isStatic:!0});pa.src=b+"treeO.png";var I=a.Bodies.rectangle(1808,c-6E3+3463,160,205,{isStatic:!0});I.src=b+"treeP.png";var Ea=a.Bodies.rectangle(1263,c-6E3+3408,
218,246,{isStatic:!0});Ea.src=b+"stoneN.png";Ea.fixedBounds=35;var Ja=a.Bodies.rectangle(1592,c-6E3+2980,158,278,{isStatic:!0});Ja.src=b+"treeE.png";var Fa=a.Bodies.rectangle(838,c-6E3+2966,307,295,{isStatic:!0});Fa.src=b+"houseB.png";Fa.fixedBounds=70;var Ga=a.Bodies.rectangle(481,c-6E3+2963,296,282,{isStatic:!0});Ga.src=b+"houseC.png";Ga.fixedBounds=70;d=[d,g,f,h,l,k,p,m,t,E,W,J,ya,G,P,B,S,L,Q,M,N,Z,ca,da,X,ea,sa,Y,ia,ja,aa,la,ma,U,na,ba,fa,ka,ha,ua,qa,ra,V,Ba,Ca,za,Da,Aa,Ka,La,Ia,xa,va,ta,T,R,
w,H,wa,oa,pa,I,Ea,Ja,Fa,Ga];g=0;for(f=d.length;g<f;g++)d[g].name=d[g].label="staticOriGPass"+a.uniqueId(),d[g].FixedPosition={x:d[g].position.x,y:d[g].position.y-c},d[g].fixedBounds||(d[g].fixedBounds=15);return d}()})]};return a.staticAllMap.value.mapDungeonG.content}(),function(){var b=a.path+"ornaments/l/",c=a.browserHeightUpdate,k=c-6E3;f.createBackground(6,"/ornaments/l/","mapDungeonH");a.staticGeometry.createMap({location:"mapDungeonH",src:b+"map.png"});var h=f.createPoint({label:"staticOriDngHPassStB",
texture:a.path+"1px.png",x:3477,y:k+4196,target:"help"}),g=f.createPoint({label:"staticOriDngHPassStC",texture:a.path+"1px.png",x:2755,y:k+5036,target:"help"}),l=f.createPoint({label:"staticOriDngHPassStD",texture:a.path+"1px.png",x:1625,y:k+4645,target:"help"}),p=f.createPoint({isVisible:!0,label:"staticOriDngHPassSpawnA",texture:a.path+"1px.png",x:5092,y:k+5401,target:"help"}),n=f.createPoint({isVisible:!0,label:"staticOriDngHPassSpawnB",texture:a.path+"1px.png",x:5049,y:k+3728,target:"help"}),
m=f.createPoint({isVisible:!0,label:"staticOriDngHPassSpawnC",texture:a.path+"1px.png",x:2095,y:k+4368,target:"help"}),r=f.createPoint({isVisible:!0,label:"staticOriDngHPassSpawnD",texture:a.path+"1px.png",x:655,y:k+3921,target:"help"});f.createSVGBuffer(b+"buffer-a.svg","mapDungeonH","staticOriDngHBufferA",{x:1143,y:k+4919});f.createSVGPathBuffer(b+"path-buffer-a.svg","mapDungeonH","staticOriDngHPathBufferA","staticOriDngHBufferA",{x:-10,y:0});f.createSVGBuffer(b+"buffer-b.svg","mapDungeonH","staticOriDngHBufferB",
{x:521,y:k+4325});f.createSVGPathBuffer(b+"path-buffer-b.svg","mapDungeonH","staticOriDngHPathBufferB","staticOriDngHBufferB",{x:0,y:0});f.createSVGBuffer(b+"buffer-c.svg","mapDungeonH","staticOriDngHBufferC",{x:447,y:k+3754});f.createSVGPathBuffer(b+"path-buffer-c.svg","mapDungeonH","staticOriDngHPathBufferC","staticOriDngHBufferC",{x:0,y:0});f.createSVGBuffer(b+"buffer-d.svg","mapDungeonH","staticOriDngHBufferD",{x:1914,y:k+5239});f.createSVGPathBuffer(b+"path-buffer-d.svg","mapDungeonH","staticOriDngHPathBufferD",
"staticOriDngHBufferD",{x:0,y:10});f.createSVGBuffer(b+"buffer-e.svg","mapDungeonH","staticOriDngHBufferE",{x:2750,y:k+5636});f.createSVGPathBuffer(b+"path-buffer-e.svg","mapDungeonH","staticOriDngHPathBufferE","staticOriDngHBufferE",{x:0,y:0});f.createSVGBuffer(b+"buffer-d.svg","mapDungeonH","staticOriDngHBufferF",{x:3201,y:k+5115});f.createSVGPathBuffer(b+"path-buffer-d.svg","mapDungeonH","staticOriDngHPathBufferF","staticOriDngHBufferF",{x:0,y:10});f.createSVGBuffer(b+"buffer-f.svg","mapDungeonH",
"staticOriDngHBufferG",{x:2784,y:k+4500});f.createSVGPathBuffer(b+"path-buffer-f.svg","mapDungeonH","staticOriDngHPathBufferG","staticOriDngHBufferG",{x:0,y:0});f.createSVGBuffer(b+"buffer-g.svg","mapDungeonH","staticOriDngHBufferH",{x:3835,y:k+3331});f.createSVGPathBuffer(b+"path-buffer-g.svg","mapDungeonH","staticOriDngHPathBufferH","staticOriDngHBufferH",{x:-4,y:-7});f.createSVGBuffer(b+"buffer-b.svg","mapDungeonH","staticOriDngHBufferI",{x:4285,y:k+3970});f.createSVGPathBuffer(b+"path-buffer-b.svg",
"mapDungeonH","staticOriDngHPathBufferI","staticOriDngHBufferI",{x:0,y:0});f.createSVGBuffer(b+"buffer-e.svg","mapDungeonH","staticOriDngHBufferJ",{x:4424,y:k+5240});f.createSVGPathBuffer(b+"path-buffer-e.svg","mapDungeonH","staticOriDngHPathBufferJ","staticOriDngHBufferJ",{x:0,y:0});f.createSVGBuffer(b+"buffer-h.svg","mapDungeonH","staticOriDngHBufferK",{x:4922,y:k+4460});f.createSVGPathBuffer(b+"path-buffer-h.svg","mapDungeonH","staticOriDngHPathBufferK","staticOriDngHBufferK",{x:0,y:0});a.staticAllMap.value.mapDungeonH.content=
{staticWallOuttermapDungeonH:f.createWall("mapDungeonH","medium"),staticOriDngHPassStB:h,staticOriDngHPassStC:g,staticOriDngHPassStD:l,staticOriDngHPassSpawnA:p,staticOriDngHPassSpawnB:n,staticOriDngHPassSpawnC:m,staticOriDngHPassSpawnD:r,staticOriGroupSVG:[],staticSpawnLabel:["staticOriDngHPassSpawnA","staticOriDngHPassSpawnB","staticOriDngHPassSpawnD"],groupLayer:[f.createLayer("staticOriHPassLayerA",{x:0,y:0,location:"mapDungeonH",layer:function(){var d=a.Bodies.rectangle(248,c-6E3+4718,276,356,
{isStatic:!0});d.src=b+"treeA.png";var g=a.Bodies.rectangle(583,c-6E3+5299,276,356,{isStatic:!0});g.src=b+"treeA.png";var f=a.Bodies.rectangle(1454,c-6E3+5736,266,343,{isStatic:!0});f.src=b+"treeC.png";var h=a.Bodies.rectangle(2702,c-6E3+5645,242,312,{isStatic:!0});h.src=b+"treeB.png";var l=a.Bodies.rectangle(2880,c-6E3+5542,266,343,{isStatic:!0});l.src=b+"treeC.png";var k=a.Bodies.rectangle(2099,c-6E3+5219,242,312,{isStatic:!0});k.src=b+"treeB.png";k.fixedBounds=45;var p=a.Bodies.rectangle(1920,
c-6E3+5116,266,343,{isStatic:!0});p.src=b+"treeC.png";p.fixedBounds=45;var n=a.Bodies.rectangle(1304,c-6E3+5196,91,125,{isStatic:!0});n.src=b+"sign.png";var m=a.Bodies.rectangle(1128,c-6E3+4822,339,339,{isStatic:!0});m.src=b+"stone.png";var q=a.Bodies.rectangle(2924,c-6E3+4527,201,295,{isStatic:!0});q.src=b+"treeD.png";var r=a.Bodies.rectangle(2872,c-6E3+4370,276,356,{isStatic:!0});r.src=b+"treeA.png";var t=a.Bodies.rectangle(2690,c-6E3+4376,242,312,{isStatic:!0});t.src=b+"treeB.png";var B=a.Bodies.rectangle(1496,
c-6E3+4266,266,343,{isStatic:!0});B.src=b+"treeC.png";var S=a.Bodies.rectangle(1255,c-6E3+3846,276,356,{isStatic:!0});S.src=b+"treeA.png";var L=a.Bodies.rectangle(695,c-6E3+4310,242,312,{isStatic:!0});L.src=b+"treeB.png";var Q=a.Bodies.rectangle(597,c-6E3+4246,242,312,{isStatic:!0});Q.src=b+"treeB.png";var M=a.Bodies.rectangle(471,c-6E3+4321,201,295,{isStatic:!0});M.src=b+"treeD.png";var N=a.Bodies.rectangle(507,c-6E3+3639,459,324,{isStatic:!0});N.src=b+"houseA.png";N.fixedBounds=60;var Z=a.Bodies.rectangle(1613,
c-6E3+3406,134,90,{isStatic:!0});Z.src=b+"ruinM.png";var ca=a.Bodies.rectangle(1720,c-6E3+3233,275,258,{isStatic:!0});ca.src=b+"treeF.png";var da=a.Bodies.rectangle(2159,c-6E3+3712,247,292,{isStatic:!0});da.src=b+"treeE.png";var X=a.Bodies.rectangle(2581,c-6E3+3825,157,101,{isStatic:!0});X.src=b+"ruinL.png";var ea=a.Bodies.rectangle(2610,c-6E3+3307,149,199,{isStatic:!0});ea.src=b+"stoneA.png";ea.fixedBounds=45;var sa=a.Bodies.rectangle(2846,c-6E3+3077,99,85,{isStatic:!0});sa.src=b+"stoneB.png";var Y=
a.Bodies.rectangle(2927,c-6E3+3859,63,113,{isStatic:!0});Y.src=b+"ruinC.png";var ia=a.Bodies.rectangle(2762,c-6E3+3964,70,113,{isStatic:!0});ia.src=b+"ruinK.png";var ja=a.Bodies.rectangle(2538,c-6E3+4154,63,113,{isStatic:!0});ja.src=b+"ruinC.png";var aa=a.Bodies.rectangle(2340,c-6E3+4058,128,199,{isStatic:!0});aa.src=b+"ruinJ.png";var la=a.Bodies.rectangle(2151,c-6E3+4001,80,180,{isStatic:!0});la.src=b+"ruinA.png";var ma=a.Bodies.rectangle(1990,c-6E3+4106,80,179,{isStatic:!0});ma.src=b+"ruinB.png";
var U=a.Bodies.rectangle(1858,c-6E3+4226,63,113,{isStatic:!0});U.src=b+"ruinC.png";var na=a.Bodies.rectangle(1702,c-6E3+4307,129,200,{isStatic:!0});na.src=b+"ruinD.png";var ba=a.Bodies.rectangle(1783,c-6E3+4406,80,179,{isStatic:!0});ba.src=b+"ruinB.png";var fa=a.Bodies.rectangle(1946,c-6E3+4478,80,180,{isStatic:!0});fa.src=b+"ruinA.png";var ka=a.Bodies.rectangle(2075,c-6E3+4561,71,113,{isStatic:!0});ka.src=b+"ruinE.png";var ha=a.Bodies.rectangle(2194,c-6E3+4619,63,113,{isStatic:!0});ha.src=b+"ruinI.png";
var V=a.Bodies.rectangle(2036,c-6E3+4737,70,113,{isStatic:!0});V.src=b+"ruinK.png";var qa=a.Bodies.rectangle(1909,c-6E3+4809,129,200,{isStatic:!0});qa.src=b+"ruinD.png";var ra=a.Bodies.rectangle(2074,c-6E3+4914,80,179,{isStatic:!0});ra.src=b+"ruinB.png";var Ha=a.Bodies.rectangle(2263,c-6E3+5032,80,179,{isStatic:!0});Ha.src=b+"ruinF.png";var Ba=a.Bodies.rectangle(2494,c-6E3+4887,80,179,{isStatic:!0});Ba.src=b+"ruinF.png";var Ca=a.Bodies.rectangle(2584,c-6E3+4830,63,113,{isStatic:!0});Ca.src=b+"ruinI.png";
var za=a.Bodies.rectangle(2679,c-6E3+4713,80,179,{isStatic:!0});za.src=b+"ruinB.png";var Da=a.Bodies.rectangle(2780,c-6E3+4623,128,199,{isStatic:!0});Da.src=b+"ruinJ.png";var Aa=a.Bodies.rectangle(2559,c-6E3+4284,128,199,{isStatic:!0});Aa.src=b+"ruinJ.png";d=[d,g,f,h,l,k,p,n,m,q,r,t,B,S,L,Q,M,N,Z,ca,da,X,ea,sa,Y,ia,ja,aa,la,ma,U,na,ba,fa,ka,ha,V,qa,ra,Ha,Ba,Ca,za,Da,Aa];g=0;for(f=d.length;g<f;g++)d[g].name=d[g].label="staticOriGPass"+a.uniqueId(),d[g].FixedPosition={x:d[g].position.x,y:d[g].position.y-
c},d[g].fixedBounds||(d[g].fixedBounds=25);return d}()}),f.createLayer("staticOriHPassLayerB",{x:3E3,y:0,location:"mapDungeonH",layer:function(){var d=c+-6E3,g=a.Bodies.rectangle(200,d+5022,266,343,{isStatic:!0});g.src=b+"treeC.png";var f=a.Bodies.rectangle(379,d+5125,242,312,{isStatic:!0});f.src=b+"treeB.png";var h=a.Bodies.rectangle(693,d+5602,188,243,{isStatic:!0});h.src=b+"treeH.png";var l=a.Bodies.rectangle(2037,d+5736,266,343,{isStatic:!0});l.src=b+"treeC.png";var k=a.Bodies.rectangle(2772,
d+5240,267,356,{isStatic:!0});k.src=b+"treeA.png";var p=a.Bodies.rectangle(2303,d+4815,266,343,{isStatic:!0});p.src=b+"treeC.png";var n=a.Bodies.rectangle(2188,d+5196,91,125,{isStatic:!0});n.src=b+"signB.png";var m=a.Bodies.rectangle(1571,d+5116,266,343,{isStatic:!0});m.src=b+"treeC.png";var q=a.Bodies.rectangle(1393,d+5219,201,259,{isStatic:!0});q.src=b+"treeD.png";var r=a.Bodies.rectangle(1950,d+4333,339,339,{isStatic:!0});r.src=b+"stoneC.png";r.fixedBounds=40;var t=a.Bodies.rectangle(2644,d+3400,
99,85,{isStatic:!0});t.src=b+"stoneD.png";var B=a.Bodies.rectangle(2236,d+3846,267,356,{isStatic:!0});B.src=b+"treeA.png";var S=a.Bodies.rectangle(1879,d+3406,134,90,{isStatic:!0});S.src=b+"ruinN.png";var L=a.Bodies.rectangle(1771,d+3233,275,258,{isStatic:!0});L.src=b+"treeI.png";var Q=a.Bodies.rectangle(1481,d+3939,201,259,{isStatic:!0});Q.src=b+"treeD.png";var M=a.Bodies.rectangle(1356,d+3864,267,356,{isStatic:!0});M.src=b+"treeA.png";var N=a.Bodies.rectangle(1258,d+3928,242,312,{isStatic:!0});
N.src=b+"treeB.png";var Z=a.Bodies.rectangle(1078,d+3180,267,356,{isStatic:!0});Z.src=b+"treeA.png";var ca=a.Bodies.rectangle(906,d+3319,201,259,{isStatic:!0});ca.src=b+"treeD.png";var da=a.Bodies.rectangle(708,d+3221,201,259,{isStatic:!0});da.src=b+"treeD.png";var X=a.Bodies.rectangle(239,d+3143,251,281,{isStatic:!0});X.src=b+"treeJ.png";var ea=a.Bodies.rectangle(56,d+4619,129,200,{isStatic:!0});ea.src=b+"ruinD.png";var V=a.Bodies.rectangle(233,d+4707,80,179,{isStatic:!0});V.src=b+"ruinB.png";var Y=
a.Bodies.rectangle(411,d+4817,63,113,{isStatic:!0});Y.src=b+"ruinC.png";var ia=a.Bodies.rectangle(570,d+4673,80,180,{isStatic:!0});ia.src=b+"ruinA.png";var ja=a.Bodies.rectangle(696,d+4557,80,180,{isStatic:!0});ja.src=b+"ruinA.png";var aa=a.Bodies.rectangle(837,d+4438,80,179,{isStatic:!0});aa.src=b+"ruinB.png";var la=a.Bodies.rectangle(964,d+4366,71,113,{isStatic:!0});la.src=b+"ruinE.png";var ma=a.Bodies.rectangle(1040,d+4242,128,119,{isStatic:!0});ma.src=b+"ruinJ.png";var U=a.Bodies.rectangle(855,
d+4206,63,113,{isStatic:!0});U.src=b+"ruinI.png";var na=a.Bodies.rectangle(662,d+4084,80,179,{isStatic:!0});na.src=b+"ruinB.png";var ba=a.Bodies.rectangle(528,d+3996,129,200,{isStatic:!0});ba.src=b+"ruinD.png";var fa=a.Bodies.rectangle(688,d+3883,80,179,{isStatic:!0});fa.src=b+"ruinF.png";var ka=a.Bodies.rectangle(543,d+3831,63,113,{isStatic:!0});ka.src=b+"ruinI.png";var ha=a.Bodies.rectangle(383,d+3734,80,179,{isStatic:!0});ha.src=b+"ruinF.png";d=a.Bodies.rectangle(145,d+3723,80,179,{isStatic:!0});
d.src=b+"ruinB.png";g=[g,f,h,l,k,p,n,m,q,r,t,B,S,L,Q,M,N,Z,ca,da,X,ea,V,Y,ia,ja,aa,la,ma,U,na,ba,fa,ka,ha,d];f=0;for(h=g.length;f<h;f++)g[f].name=g[f].label="staticOriDPass"+a.uniqueId(),g[f].FixedPosition={x:g[f].position.x,y:g[f].position.y-c},g[f].fixedBounds||(g[f].fixedBounds=15);return g}()})]};return a.staticAllMap.value.mapDungeonH.content}(),function(){return{createItem:function(b,c,f,h){"Ness Scale"===b&&(b="drop-item");item=a.Bodies.rectangle(0,0,c,f,{isStatic:!0,render:{sprite:{texture:a.path+
b+".png"}}});item.label="itemPass_"+b+"_"+a.uniqueId();item.name=h?"itemWithAngle":"item";item.inverseInertia=0;return item}}}(),function(){return{staticAreaDmg:function(b,c,f){b=a.Bodies.rectangle(b.x,b.y,c,f,{isStatic:!0,collisionFilter:{category:4},render:{sprite:{texture:a.path+"1px.png"}}});b.monsterParameters=[];b.label="areaDmg-"+a.uniqueId();b.inverseInertia=0;b.name="areaDmg";b.visible=!0;b.pass=!0;return b}}}(),function(){return{staticGeneralMonster:function(b,c,f,h,g){var d=[];for(k in g)d.push(k);
if(d.length){var k=a.path+b+"-right.png";g={behave:d,behaveRig:g,sprite:{texture:k}}}else k=a.path+b+"-right.png",g={behave:["idle"],behaveRig:{idle:{totalOfFrames:1,speed:10}},sprite:{texture:k}};g=a.Bodies.rectangle(0,0,60,70,{collisionFilter:{category:4},render:g});g.label="monster-"+b+"-"+a.uniqueId();g.inverseInertia=0;g.name="monster-"+b;g.initialName=b;g.additionalBoundsValue=c;g.additionalBoundsHeightValue=h;g.additionalBoundsWidthValue=f;g.visible=!0;g.mapMark=new a.draw.mapMark;g.stateStorage=
"monster"+b.charAt(0).toUpperCase()+b.slice(1)+"State";a[g.stateStorage]=new a.storageState.value;d.length&&a.getTexture(g.render,k,!1,b);return g}}}(),function(){var b=a.Bodies.rectangle(a.browserWidthUpdate/2,a.browserHeightUpdate/2,60,70,{friction:1,collisionFilter:{mask:1}});b.label="oval";b.behave="idle";b.stateStorage="characterState";a[b.stateStorage]=new a.storageState.value;b.initialName="warrior-character";b.additionalBoundsHeightValue=25;b.additionalBoundsWidthValue=0;b.pions=[];b.totalOfFrames=
25;b.additionalBoundsValue=60;b.mapMark=new a.draw.mapMark;b.name="character";b.inverseInertia=0;return{oval:b}}()]},initilizeObject:function(){for(var a=this,c=Matter.MouseConstraint,f=Matter.Mouse.create(a.canvas),b=a.engine.world,d=0,k=a.fragment;d<k.length;d++)for(var h in k[d])h in k[d]&&(/staticWall|staticOri/i.test(h)?"staticWallOuttermapA"===h&&a.World.add(b,k[d][h]):a.World.add(b,k[d][h]),a.objFragment[h]=k[d][h]);b.gravity.y=0;b.gravity.x=0;c=c.create(a.engine,{mouse:f,constraint:{stiffness:.2,
render:{visible:!0}}});a.extend(a.objFragment,{staticDrawImage:{fn:new a.draw.enviOrnaments,hpMedTexture:new function(){this.render={textures:"",src:a.path+"hp-medium-bar.png"};this.textures=a.getTexture(this.render,this.render.src)},hpMedConver:new function(){this.render={textures:"",src:a.path+"hp-medium-cover.png"};this.textures=a.getTexture(this.render,this.render.src)},hpMedTick:new function(){this.render={textures:"",src:a.path+"hp-medium-tick.png"};this.textures=a.getTexture(this.render,this.render.src)}},
staticWallOutter:"",areaDmgPool:new a.storageState.value,monsterAttribute:function(b,c,d){if(0<=b&&5>b){if("soul"===c)return b=a.random(13,7),d?2*b:b;if("exp"===c)return b=a.random(45,31),d?2*b:b}else if(5<=b&&10>b){if("soul"===c)return b=a.random(17,11),d?2*b:b;if("exp"===c)return b=a.random(84,63),d?2*b:b}else if(10<=b&&13>b){if("soul"===c)return b=a.random(21,9),d?2*b:b;if("exp"===c)return b=a.random(155,105),d?2*b:b}else if(13<=b&&16>b){if("soul"===c)return b=a.random(28,15),d?2*b:b;if("exp"===
c)return b=a.random(185,135),d?2*b:b}else if(16<=b&&19>b){if("soul"===c)return b=a.random(35,23),d?2*b:b;if("exp"===c)return b=a.random(235,175),d?2*b:b}else if(19<=b&&21>b){if("soul"===c)return b=a.random(45,33),d?2*b:b;if("exp"===c)return b=a.random(237,185),d?2*b:b}else if(21<=b&&23>b){if("soul"===c)return b=a.random(21,15),d?2*b:b;if("exp"===c)return b=a.random(215,165),d?2*b:b}else if(23<=b&&25>b){if("soul"===c)return b=a.random(42,34),d?2*b:b;if("exp"===c)return b=a.random(295,215),d?2*b:b}else if(25<=
b&&27>b){if("soul"===c)return b=a.random(58,43),d?2*b:b;if("exp"===c)return b=a.random(435,375),d?2*b:b}else if(27<=b&&30>b){if("soul"===c)return b=a.random(91,73),d?2*b:b;if("exp"===c)return b=a.random(565,495),d?2*b:b}},registerMagicBoxItem:new a.storageState.value,itemShop:new a.storageState.value,characterQuest:new a.storageState.value,characterSkills:new a.storageState.value,characterGetDamage:new a.storageState.value,characterInventoryBag:new a.storageState.value,characterParameters:"",characterStatus:"",
caracterSkillToogleFn:function(b){var c=a.characterSkills.value.get(a.oval.value.label),d=a.characterParameters.value.mp,g=[],f=[],h=a.buffGUI.value.storage,k=!0;for(m in h)/lightningShock/i.test(h[m].name)&&(k=!1);if(k){h=0;for(k=c.length;h<k;h++){var m=c[h];if(d<m.mp&&!m.disable&&m.tick<m.tickUpdate||!m.state||b)m.disable=!0,g.push(m);else if(d<m.mp&&!m.disable&&m.tick===m.tickUpdate)m.disable=!0,g.push(m);else if(d>=m.mp&&m.disable&&m.tick===m.tickUpdate||b)m.disable=!1,f.push(m)}g.length&&a.disableSkill.value("disable",
g);f.length&&a.disableSkill.value("enable",f)}},disableSkill:function(b,c){for(var d=a.slice(a.qsAll("disable-skill")),g=0;g<d.length;g++)if(c)for(var f=d[g].parentNode.getAttribute("label"),h=0;h<c.length;h++)f===c[h].label&&("enable"===b?(a.sibling(d[g],"previous").innerHTML="",d[g].style.display="none"):d[g].style.display="block");else"enable"===b?(a.sibling(d[g],"previous").innerHTML="",d[g].style.display="none"):d[g].style.display="block"},characterMobileControl:{status:"",charObj:"",top:!1,
left:!1,bottom:!1,right:!1,jump:!1,firstTouch:!1},characterLevel:function(b,c){var d=a.characterParameters.value,g=[d],f=function(b,d){var g={attributLvl:{mage:{statA:{attackRange:2,attack:1,hp:4.2,mp:4.7,magicDefense:8,defense:3},statB:{attackRange:12,attack:8,hp:5.7,mp:5.8,magicDefense:16,defense:12},statC:{attackRange:17,attack:12,hp:6.8,mp:6.3,magicDefense:24,defense:22},statD:{attackRange:24,attack:18,hp:8.8,mp:9.3,magicDefense:31,defense:21},statE:{attackRange:36,attack:28,hp:10.8,mp:10.3,magicDefense:41,
defense:41}},warrior:{statA:{attackRange:1,attack:6,hp:5,mp:70,magicDefense:3,defense:13},statB:{attackRange:5,attack:21,hp:7.4,mp:35,magicDefense:6,defense:17},statC:{attackRange:9,attack:37,hp:9.7,mp:15,magicDefense:9,defense:25},statD:{attackRange:13,attack:47,hp:10.7,mp:13,magicDefense:12,defense:22},statE:{attackRange:23,attack:41,hp:12.7,mp:10,magicDefense:22,defense:29}},archer:{statA:{attackRange:6,attack:3,hp:4.1,mp:70,magicDefense:7,defense:13},statB:{attackRange:24,attack:6,hp:4.7,mp:35,
magicDefense:11,defense:15},statC:{attackRange:41,attack:12,hp:7.7,mp:15,magicDefense:13,defense:17},statD:{attackRange:53,attack:19,hp:9.4,mp:12,magicDefense:24,defense:19}}},instantceFormula:function(b){var c=a.isMobile()?a.qs("items-equipment-mb"):a.qs("passive-magic"),d=a.slice(c.getElementsByTagName("li")),g=a.characterInventoryBag.value.get(a.oval.value.label);c=[];for(var f=0,h=d.length;f<h;f++){var l=d[f].getElementsByTagName("div");if(l.length)for(var k=0;k<g.length;k++)l[0].getAttribute("label")===
g[k].label&&c.push(g[k])}c=a.uniqueArray(c);if(c.length)for(f=0,d=b.originalParams;f<c.length;f++)if(c[f].effect)for(h in g=c[f].effect,g)switch(h){case "attack":b.attackRangeMax+=d.attackRangeMax*g[h].value/100;b.attackRangeMin+=d.attackRangeMin*g[h].value/100;b.attackMax+=d.attackMax*g[h].value/100;b.attackMin+=d.attackMin*g[h].value/100;break;case "defense":b.defenseMax+=d.defenseMax*g[h].value/100;b.defenseMin+=d.defenseMin*g[h].value/100;break;case "magicDefense":b.magicDefenseMax+=d.magicDefenseMax*
g[h].value/100,b.magicDefenseMin+=d.magicDefenseMin*g[h].value/100}},changeCharStat:function(b,c,g){var f=d.originalParams?d.originalParams:d;b=this.attributLvl[b][c];percentageKill=g?1:a.randomFloat(.99,.8);d.attackRangeMax=f.attackRangeMax+=Math.round(b.attackRange*percentageKill);d.attackRangeMin=f.attackRangeMin+=Math.round(b.attackRange*percentageKill);d.attackMax=f.attackMax+=Math.round(b.attack*percentageKill);d.attackMin=f.attackMin+=Math.round(b.attack*percentageKill);d.magicDefenseMax=f.magicDefenseMax+=
Math.round(b.magicDefense*percentageKill);d.magicDefenseMin=f.magicDefenseMin+=Math.round(b.magicDefense*percentageKill);d.defenseMax=f.defenseMax+=Math.round(b.defense*percentageKill);d.defenseMin=f.defenseMin+=Math.round(b.defense*percentageKill);d.maxHealth=f.maxHealth+=Math.round(Math.round(b.hp/100*f.maxHealth)*percentageKill);d.maxMp=f.maxMp+=Math.round(Math.round(b.mp/100*f.maxMp)*percentageKill);d.originalParams&&this.instantceFormula(d)}},f=d.name===a.oval.value.label?"mage":"Blood Lich Warrior"===
d.name?"warrior":"archer",h=d.name===c;0<=b&&3>b?g.changeCharStat(f,"statA",h):3<=b&&7>b?g.changeCharStat(f,"statA",h):7<=b&&13>b?g.changeCharStat(f,"statB",h):13<=b&&15>b?g.changeCharStat(f,"statC",h):15<=b&&18>b?g.changeCharStat(f,"statD",h):18<=b&&25>=b?g.changeCharStat(f,"statE",h):""},h=[25,50,75,100,125,150,175,200,225,250],l=[300,350,400,450,500,550,600,650,700,750],k=[750,1050,1350,1700,4200,4700,5200,5700,6200,6700],m=function(a,b,c,d){var g=0;for(b=c.length+b;g<b;g++)if(d.tot+=c[g],g+1===
a.level){d.tot=10===g+1?d.tot+l[0]:20===g+1?d.tot+k[0]:d.tot+c[g+1];break}},t=function(a,b){10>=a.level?m(a,0,h,b):10<a.level&&20>=a.level?m(a,a.level,h.concat(l),b):20<a.level&&30>=a.level&&m(a,a.level,h.concat(l).concat(k),b)},A=d.object.pions,D=a.characterInventoryBag.value.get(a.oval.value.label),E=[];if(A.length)a:for(d=0;d<A.length;d++)for(var W=A[d].rigBody.itemLabel,J=0,V=D.length;J<V;J++)if(D[J].label===W){E.push(D[J].familiar);continue a}g=g.concat(E);d=0;for(J=g.length;d<J;d++)A=g[d],E=
g[d].name===a.oval.value.label?!0:!1,D={tot:0},b&&(W=A.name===c?1:a.randomFloat(.85,.65),W=Math.round(b.exp*W),A.expTemp+=W,E&&(a.text(a.qs("addedExp"),"+"+W),$(".addedExp").show(),$(".addedExp").fadeOut(4500),a.text(a.qs("currentExp"),A.expTemp),a.infoLogFn.value({title:"regular-title",text:{white:"Got",chocolate:" +"+W+" ",skyBlue:"Exp"}}))),E&&(a.text(a.qs("level"),A.level),a.text(a.qs("currentExp"),A.expTemp)),t(A,D),A.expTemp>A.exp+D.tot&&(A.exp=A.expTemp,A.level++,E&&A.skillPoint++,f(A.level,
A)),E&&(E=(A.expTemp-A.exp)/D.tot*100,a.css(a.qs("exp-bar"),{width:Math.round(E)+"%"}),a.text(a.qs("nextEpx"),A.exp+D.tot),a.text(a.qs("level"),A.level))},updateGoldtoLocalStorageHero:function(b,c){var d=localStorage.getItem("goldHero")?JSON.parse(localStorage.getItem("goldHero")):{heroArcher:0,heroArmor:0};/archer/i.test(c.label)?d.heroArcher=b:/armor/i.test(c.label)&&(d.heroArmor=b);localStorage.setItem("goldHero",a.JSONstringfy(d))},addGoldToHero:function(b){if(!/hero/i.test(b.object.label)&&/hero/i.test(b.character.label)&&
!b.isStatic){var c=0,d=b.monsterParameters.name;switch(b.monsterParameters.monsterLevel.toLowerCase()){case "e":c=a.random(50,20);break;case "d":c=a.random(120,50);break;case "c":c=a.random(210,150);break;case "b":c=a.random(500,350);break;case "a":c=a.random(1E3,750);break;case "s":c=a.random(2500,2E3)}a.kongPoints.value+=c;b.character.statParameters.gold+=c;a.playAudio("Pickup_Gold_04");a.infoLogFn.value({title:"regular-title",text:{chocolate:b.character.statParameters.name,white:m.lang.fn("gui",
"accuredItem","detail")+c+" G "+m.lang.fn("gui","accuredItemB","detail"),gold:d}});a.updateGoldtoLocalStorageHero.value(b.character.statParameters.gold,b.character)}},items:"",pickUpDropItem:function(b){var c=b.parent,d=b.initial;b=b.value;a.items.value[c][d]&&a.characterInventoryBag.value.get(a.oval.value.label).push(new a.items.value[c][d]({quantity:b}))},characterDropItem:function(b){a.characterInventoryBag.value.get(a.oval.value.label);var c=a.oval.value.position,d=a.random(1,0)?"left":"right";
var g=b.displayName?b.displayName:b.name;var f=c.x+("left"===d?a.random(1,0)?a.random(-50,-100):a.random(50,100):a.random(1,0)?a.random(50,100):a.random(-50,-100));c=c.y+("left"===d?a.random(1,0)?a.random(-50,-100):a.random(50,100):a.random(1,0)?a.random(50,100):a.random(-50,-100));g=new a.monsterControl.item.create(f,c,g,{name:"Ness Scale",width:74,height:68},b.root);g.object.itemVal=b.quantity;a.monsterControl.itemTemp.push(g);a.World.add(a.staticWorld.value,g.object)},controlGUICheck:function(){var b=
a.slice(a.qsAll(".med-divice-nav"));if(a.isMobile()){a.qs(".nav-left-b").style.display="block";for(var c in b)b[c].style.display="block";a.qs("hidden-menu").style.display="block";a.removeClass(a.qs("mini-map-mobile"),"hidden");a.addClass(a.qs("menu-map-mobile"),"hidden");a.qs("nav-bottom").style.display="none";a.qs("nav-bottom-mobile").style.display="block";a.qs("info-menu").style.display="none";a.qs("nav-info-text").style.display="none";a.qs("info-text").style.display="none";a.qs("menu-map").style.display=
"none"}else{a.qs("nav-left-b").style.display="none";for(c in b)b[c].style.display="none";a.qs("hidden-menu").style.display="none";a.qs("nav-bottom").style.display="block";a.qs("nav-bottom-mobile").style.display="none";a.addClass(a.qs("mini-map-mobile"),"hidden");a.addClass(a.qs("menu-map-mobile"),"hidden");a.qs("info-menu").style.display="block";a.qs("nav-info-text").style.display="block";a.qs("info-text").style.display="block";a.qs("menu-map").style.display="block"}},orderObjectFn:function(){for(var b=
a.Composite.allBodies(a.engine.world),c=[],d=[],f=[],h=0,k=b.length;h<k;h++){var m=b[h].bounds.max.y;/PassBG/i.test(b[h].label)?f.push(m):c.push(m)}c.sort(function(a,b){return a-b});a.orderObj=c;f.sort(function(a,b){return a-b});d=f;h=0;k=b.length;a:for(;h<k;h++){m=b[h].bounds.max.y;for(var u=0,t=c;u<t.length;u++)if(m===t[u]&&!/PassBG/i.test(b[h].label)){a.orderObj[u]=b[h];continue a}u=0;for(t=f;u<t.length;u++)if(m===t[u]&&/PassBG/i.test(b[h].label)){d[u]=b[h];continue a}}c=d.concat(a.orderObj);b=
"";for(h=0;h<c.length;h++)/controlRigh/i.test(c[h].label)&&(b=c[h],c.splice(h,1),c.unshift(b));a.orderObj=c},mouseConstraint:c,buffGUI:new a.storageState.value,guiSupportAvailable:[],globalCharacterState:"",globalLoadGame:a.loadGame,globalEngine:a.engine,globalWorld:a.World,globalBody:a.Body,globalObjectGUI:"",globalSaveLoad:function(){},globalSaveGame:"",globalLoopingAudio:new a.storageState.value,globalAnimation:a,monsterParameters:new a.storageState.value,monsterGetDamage:new a.storageState.value,
pushMsgText:function(b,c,d,f){var g=document.createElement("div"),h=document.createElement("div"),k="msg-"+a.uniqueId(),l=a.intervalList,p=!1,m=0,n=[];for(t in l)/mimic/i.test(t)&&(m++,n.push(l[t]),2<=m&&(p=!0));p&&(n[0].tick=0);n.length=0;d=d?d:"";l=a.qs("info-important").getElementsByTagName("div");var t=0;for(p=l.length;t<p;t++)/close-msg/i.test(l[t].className)||a.addClass(l[t],"pop-up-text-move");h.className="close-msg";g.className="pop-up-text "+d+" "+k;a.text(g,b);g.appendChild(h);a.qs("info-important").appendChild(g);
a.attachListener(h,"click",function(){/pop-up-text-move/i.test(a.qs(k).className)?a.addClass(a.qs(k),"pop-up-text-out pop-up-text-move"):a.addClass(a.qs(k),"pop-up-text-out")});a.intervalList[k]={name:"msg-text",classNm:k,tick:10,fn:function(){a.qs(this.classNm)&&a.addClass(a.qs(this.classNm),"pop-up-text-in")}};a.intervalList[k+"_mimic"]={name:"msg-text",classNm:k,tick:c,fn:function(){/pop-up-text-move/i.test(a.qs(this.classNm).className)?a.addClass(a.qs(this.classNm),"pop-up-text-out pop-up-text-move"):
a.addClass(a.qs(this.classNm),"pop-up-text-out");setTimeout(function(b){b&&b();a.qs(this.classNm).remove()}.bind(this,f),450)}}},infoLog:new a.storageState.value,infoLogFn:function(b){a.infoLog.value.set(a.uniqueId(),b);b=a.infoLog.value.storage;var c=b.length,d=a.qs("wrap-box-text"),f=a.qs("wrap-box-text-mobile");f.innerHTML=d.innerHTML="";a.css(d,{transform:"0px, 0px,0px"});a.css(f,{transform:"0px, 0px,0px"});50<c&&(b.splice(0,1),c--);for(;c--;){var g=document.createElement("span");g.className=
b[c].status.title;for(var h in b[c].status.text){var k=g,m=h,t=b[c].status.text[h],C=document.createElement("abbr");C.className=m;a.text(C,t);k.appendChild(C)}d.appendChild(g);f.appendChild(g.cloneNode(!0))}b=a.slice(a.qs("nav-info-text").getElementsByTagName("div"));h=0;for(c=b.length;h<c;h++)if(d=b[h].className,a.getFirstChild(b[h])){"checkbox-all"===d?a.infoFilter.value(0):"checkbox-quest"===d?a.infoFilter.value(2):"checkbox-item"===d&&a.infoFilter.value(3);break}},infoFilter:function(b){for(var c=
a.slice(a.qs("wrap-box-text").getElementsByTagName("span")),d=0,f=c.length;d<f;d++)a.addClass(c[d],"hidden");if(0===b)for(d=0,f=c.length;d<f;d++)a.removeClass(c[d],"hidden");else if(2===b)for(d=0,f=c.length;d<f;d++)/primary-title/i.test(c[d].className)&&a.removeClass(c[d],"hidden");else if(3===b)for(d=0,f=c.length;d<f;d++)/regular-title|exp-title/i.test(c[d].className)&&a.removeClass(c[d],"hidden")},scaleMap:{map:6,mark:24,centerMark:{x:65,y:35},centerMap:{x:410,y:-220},close:!1},kongPoints:0},!0);
a.accessor.call(a,{global:a.objFragment,accessorName:"_worldObject",namespace:t.namespace});a.fragment=a.objFragment.length=0;a.items.value={magic:{manaStrongPotion:function(b){this.name="manapotion";this.displayName=m.lang.fn("items","manaStrongPotion","displayName");this.root={parent:"magic",initial:"manaStrongPotion"};this.quantity=b&&b.quantity||1;this.cure=350;this.cooldown=105;this.cooldownTick=0;this.className="mana-strong-potion";this.enchantment=!1;this.type="potion";this.usage="healing";
this.size="small";this.bagLocation="";this.detail=m.lang.fn("items","manaStrongPotion","detail");this.unique=!1;this.label=a.uniqueId()},manaMediumPotion:function(b){this.name="manapotion";this.displayName=m.lang.fn("items","manaMediumPotion","displayName");this.root={parent:"magic",initial:"manaMediumPotion"};this.quantity=b&&b.quantity||1;this.cure=200;this.cooldown=90;this.cooldownTick=0;this.className="mana-medium-potion";this.enchantment=!1;this.type="potion";this.usage="healing";this.size="small";
this.bagLocation="";this.detail=m.lang.fn("items","manaMediumPotion","detail");this.unique=!1;this.label=a.uniqueId()},manaPotion:function(b){this.name="manapotion";this.displayName=m.lang.fn("items","manaPotion","displayName");this.root={parent:"magic",initial:"manaPotion"};this.quantity=b&&b.quantity||1;this.cure=100;this.cooldown=60;this.cooldownTick=0;this.className="mana-potion";this.enchantment=!1;this.type="potion";this.usage="healing";this.size="small";this.bagLocation="";this.detail=m.lang.fn("items",
"manaPotion","detail");this.unique=!1;this.label=a.uniqueId()},healthStrongPotion:function(b){this.name="healthpotion";this.displayName=m.lang.fn("items","healthStrongPotion","displayName");this.root={parent:"magic",initial:"healthStrongPotion"};this.quantity=b&&b.quantity||1;this.cure=750;this.cooldown=105;this.cooldownTick=0;this.className="health-strong-potion";this.enchantment=!1;this.type="potion";this.usage="healing";this.size="small";this.bagLocation="";this.detail=m.lang.fn("items","healthStrongPotion",
"detail");this.unique=!1;this.label=a.uniqueId()},healthMediumPotion:function(b){this.name="healthpotion";this.displayName=m.lang.fn("items","healthMediumPotion","displayName");this.root={parent:"magic",initial:"healthMediumPotion"};this.quantity=b&&b.quantity||1;this.cure=450;this.cooldown=75;this.cooldownTick=0;this.className="health-medium-potion";this.enchantment=!1;this.type="potion";this.usage="healing";this.size="small";this.bagLocation="";this.detail=m.lang.fn("items","healthMediumPotion",
"detail");this.unique=!1;this.label=a.uniqueId()},healthPotion:function(b){this.name="healthpotion";this.displayName=m.lang.fn("items","healthPotion","displayName");this.root={parent:"magic",initial:"healthPotion"};this.quantity=b&&b.quantity||1;this.cure=300;this.cooldown=60;this.cooldownTick=0;this.className="health-potion";this.enchantment=!1;this.type="potion";this.usage="healing";this.size="small";this.bagLocation="";this.detail=m.lang.fn("items","healthPotion","detail");this.unique=!1;this.label=
a.uniqueId()},explosionRedBoom:function(b){this.name="explosionRedBoom";this.displayName=m.lang.fn("items","explosionRedBoom","displayName");this.root={parent:"magic",initial:"explosionRedBoom"};this.quantity=b&&b.quantity||1;this.damageMax=110;this.damageMin=54;this.className="explosion-red";this.type="equipmentThrowBoom";this.enchantment=!1;this.itemfor="archer";this.bagLocation="";this.detail=m.lang.fn("items","explosionRedBoom","detail");this.unique=!1;this.label=a.uniqueId()},explosionBlueBoom:function(b){this.name=
"explosionBlueBoom";this.displayName=m.lang.fn("items","explosionBlueBoom","displayName");this.root={parent:"magic",initial:"explosionBlueBoom"};this.quantity=b&&b.quantity||1;this.damageMax=110;this.damageMin=54;this.stunMax=25;this.stunMin=20;this.reduceMovement=1;this.className="explosion-blue";this.type="equipmentThrowBoom";this.enchantment=!1;this.itemfor="archer";this.bagLocation="";this.detail=m.lang.fn("items","explosionBlueBoom","detail");this.unique=!1;this.label=a.uniqueId()},blueJewel:function(b){this.name=
"bluejewel";this.displayName=m.lang.fn("items","blueJewel","displayName");this.root={parent:"magic",initial:"blueJewel"};this.quantity=b&&b.quantity||1;this.className="blue-jewel";this.enchantment=!1;this.type="Mistik";this.usage="upgrade";this.bagLocation="";this.effect={attack:{target:["character"],value:15}};this.registered=[];this.detail=m.lang.fn("items","blueJewel","detail");this.unique=!0;this.label=a.uniqueId()},redJewel:function(b){this.name="redjewel";this.displayName=m.lang.fn("items",
"redJewel","displayName");this.root={parent:"magic",initial:"redJewel"};this.quantity=b&&b.quantity||1;this.className="red-jewel";this.enchantment=!1;this.type="mystic";this.usage="upgrade";this.bagLocation="";this.effect={avoid:{target:["character"],value:15}};this.registered=[];this.detail=m.lang.fn("items","redJewel","detail");this.unique=!0;this.label=a.uniqueId()},greenJewel:function(b){this.name="greenJewel";this.displayName=m.lang.fn("items","greenJewel","displayName");this.root={parent:"magic",
initial:"greenJewel"};this.quantity=b&&b.quantity||1;this.className="green-jewel";this.enchantment=!1;this.type="mystic";this.usage="upgrade";this.bagLocation="";this.itemfor="leader";this.effect={defense:{target:["character","pion"],value:15},attack:{target:["character","pion"],value:20}};this.registered=[];this.detail=m.lang.fn("items","greenJewel","detail");this.unique=!0;this.label=a.uniqueId()},ornamentPurple:function(b){this.name="ornamentPurple";this.displayName=m.lang.fn("items","ornamentPurple",
"displayName");this.root={parent:"magic",initial:"ornamentPurple"};this.quantity=b&&b.quantity||1;this.className="ornament-purple";this.enchantment=!1;this.type="mystic";this.usage="upgrade";this.bagLocation="";this.effect={stun:{target:["character"],value:15}};this.registered=[];this.detail=m.lang.fn("items","ornamentPurple","detail");this.unique=!0;this.label=a.uniqueId()},ornamentGreen:function(b){this.name="ornamentGreen";this.displayName=m.lang.fn("items","ornamentGreen","displayName");this.root=
{parent:"magic",initial:"ornamentGreen"};this.quantity=b&&b.quantity||1;this.className="ornament-green";this.enchantment=!1;this.type="mystic";this.usage="upgrade";this.bagLocation="";this.effect={block:{target:["character"],value:15}};this.registered=[];this.detail=m.lang.fn("items","ornamentGreen","detail");this.unique=!0;this.label=a.uniqueId()},greenLightNecklace:function(b){this.name="greenlightnecklace";this.displayName=m.lang.fn("items","greenLightNecklace","displayName");this.root={parent:"magic",
initial:"greenLightNecklace"};this.quantity=b&&b.quantity||1;this.className="green-light-necklace";this.enchantment=!1;this.type="mystic";this.usage="upgrade";this.bagLocation="";this.effect={criticalChance:{target:["character"],value:15}};this.registered=[];this.detail=m.lang.fn("items","greenLightNecklace","detail");this.unique=!0;this.label=a.uniqueId()},redGemStone:function(b){this.name="redgemstone";this.displayName=m.lang.fn("items","redGemStone","displayName");this.root={parent:"magic",initial:"redGemStone"};
this.quantity=b&&b.quantity||1;this.className="red-gem-stone";this.type="mystic";this.usage="upgrade";this.itemfor="leader";this.enchantment=!1;this.bagLocation="";this.effect={criticalChance:{target:["character","pion"],value:15},defense:{target:["character","pion"],value:20}};this.registered=[];this.detail=m.lang.fn("items","redGemStone","detail");this.unique=!0;this.label=a.uniqueId()},goldGemStone:function(b){this.name="goldgemstone";this.displayName=m.lang.fn("items","goldGemStone","displayName");
this.root={parent:"magic",initial:"goldGemStone"};this.quantity=b&&b.quantity||1;this.className="gold-gem-stone";this.enchantment=!1;this.type="mystic";this.usage="upgrade";this.bagLocation="";this.effect={critical:{target:["character"],value:34}};this.registered=[];this.detail=m.lang.fn("items","goldGemStone","detail");this.unique=!0;this.label=a.uniqueId()},golemSummoner:function(b){this.name="golemSummoner";this.displayName=m.lang.fn("items","golemSummoner","displayName");this.root={parent:"magic",
initial:"golemSummoner"};this.quantity=b&&b.quantity||1;this.className="golemSummoner";this.mp=232;this.state=!0;this.disable=!1;this.life=200;this.spawnTick=45;this.selectedSkillFrame="skill";this.initialParams={aiParams:"golem",spawn:{x:0,y:0},spawnTotal:1,aIParent:"",forceGravity:!1,maximumPawns:4};this.enchantment=!1;this.itemfor="leader";this.type="mystic";this.bagLocation="";this.detail=m.lang.fn("items","golemSummoner","detail");this.unique=!0;this.label=a.uniqueId()},sekletonSummoner:function(b){this.name=
"sekletonSummoner";this.displayName=m.lang.fn("items","sekletonSummoner","displayName");this.root={parent:"magic",initial:"sekletonSummoner"};this.quantity=b&&b.quantity||1;this.className="sekletonSummoner";this.mp=232;this.state=!0;this.disable=!1;this.life=200;this.spawnTick=25;this.selectedSkillFrame="skill";this.initialParams={aiParams:"sekletonSpear",spawn:{x:0,y:0},spawnTotal:1,aIParent:"",forceGravity:!1,maximumPawns:4};this.enchantment=!1;this.itemfor="leader";this.type="mystic";this.bagLocation=
"";this.detail=m.lang.fn("items","sekletonSummoner","detail");this.unique=!0;this.label=a.uniqueId()}},skills:{intimidation:function(){this.name="intimidation";this.className="roar-of-protection";this.displayName=m.lang.fn("skill","intimidation","displayName");this.type="active";this.tickUpdate=this.tick=1800;this.mp=150;this.blockMin=this.blockMax=this.defenseRateMin=this.defenseRateMax=25;this.state=!0;this.disable=!1;this.label=a.uniqueId();this.target="";this.detail=m.lang.fn("skill","intimidation",
"detail");this.active=this.firstLoad=!0;this.slotLocation="";this.level=1},rollingAttack:function(){this.name="rollingAttack";this.className="rolling-attack";this.displayName=m.lang.fn("skill","rollingAttack","displayName");this.type="active";this.tickUpdate=this.tick=240;this.damageMax=332;this.damageMin=280;this.damageType="vitallity";this.mp=200;this.state=!0;this.disable=!1;this.label=a.uniqueId();this.target="";this.detail=m.lang.fn("skill","rollingAttack","detail");this.active=this.firstLoad=
!0;this.slotLocation="";this.level=1},upperAttack:function(){this.name="upperAttack";this.className="upper-attack";this.displayName=m.lang.fn("skill","upperAttack","displayName");this.type="active";this.tickUpdate=this.tick=150;this.mp=172;this.damageMax=372;this.damageMin=240;this.damageType="vitallity";this.state=!0;this.disable=!1;this.label=a.uniqueId();this.target="";this.detail=m.lang.fn("skill","upperAttack","detail");this.active=this.firstLoad=!0;this.slotLocation="";this.level=1},sliceAttack:function(){this.name=
"sliceAttack";this.className="slice-attack";this.displayName=m.lang.fn("skill","sliceAttack","displayName");this.type="active";this.mp=this.tickUpdate=this.tick=150;this.damageMax=1212;this.damageMin=940;this.damageType="vitallity";this.state=!0;this.disable=!1;this.label=a.uniqueId();this.target="";this.detail=m.lang.fn("skill","sliceAttack","detail");this.active=this.firstLoad=!0;this.slotLocation="";this.level=1},throwBoom:function(){this.name="throwBoom";this.className="throw-boom";this.displayName=
m.lang.fn("skill","throwBoom","displayName");this.type="active";this.tickUpdate=this.tick=240;this.stringRequired="boom";this.damageMin=this.damageMax=0;this.triggerName="explosionNormalBoom";this.damageType="vitallity";this.mp=235;this.state=!0;this.disable=!1;this.label=a.uniqueId();this.target="";this.detail=m.lang.fn("skill","throwBoom","detail");this.active=this.firstLoad=!0;this.slotLocation="";this.level=1},piercingShoot:function(){this.name="piercingShoot";this.className="piercing-shoot";
this.displayName=m.lang.fn("skill","piercingShoot","displayName");this.type="active";this.tickUpdate=this.tick=150;this.damageMax=355;this.damageMin=538;this.mp=144;this.state=!0;this.disable=!1;this.label=a.uniqueId();this.target="";this.detail=m.lang.fn("skill","piercingShoot","detail");this.active=this.firstLoad=!0;this.slotLocation="";this.level=1},piercingSpear:function(){this.name="piercingSpear";this.className="piercing-spear";this.displayName=m.lang.fn("skill","piercingSpear","displayName");
this.type="active";this.tickUpdate=this.tick=600;this.mp=211;this.state=!0;this.disable=!1;this.label=a.uniqueId();this.target="";this.life=18;this.selectedFrame=this.uniqueFrame="piercingSpear";this.damageType="vitallity";this.speed=30;this.damageMax=1100;this.damageMin=750;this.criticalMax=70;this.criticalMin=45;this.criticalChanceMax=25;this.criticalChanceMin=15;this.detail=m.lang.fn("skill","piercingSpear","detail");this.active=this.firstLoad=!0;this.slotLocation="";this.level=1},piercingSpeed:function(){this.name=
"piercingSpeed";this.className="piercing-spear";this.displayName=m.lang.fn("skill","piercingSpeed","displayName");this.type="active";this.tickUpdate=this.tick=400;this.mp=121;this.state=!0;this.disable=!1;this.label=a.uniqueId();this.target="";this.life=30;this.uniqueFrame="piercingSpeed";this.selectedFrame="attackB";this.damageType="vitallity";this.speed=25;this.damageMax=1120;this.damageMin=865;this.detail=m.lang.fn("skill","piercingSpeed","detail");this.active=this.firstLoad=!0;this.slotLocation=
"";this.level=1},createBlue:function(){this.name="createBlue";this.className="create-blue";this.displayName=m.lang.fn("skill","createBlue","displayName");this.type="active";this.tickUpdate=this.tick=3E4;this.enemyTolerance=!0;this.particleParams={cyrcle:"blue-cycle.png",ring:"blue-ring.png",sizeCyrcle:75};this.attackRange=!1;this.mp=45;this.state=!0;this.disable=!1;this.label=a.uniqueId();this.target="";this.detail=m.lang.fn("skill","createBlue","detail");this.active=this.firstLoad=!0;this.slotLocation=
"";this.level=1},createRed:function(){this.name="createRed";this.className="create-red";this.displayName=m.lang.fn("skill","createRed","displayName");this.type="active";this.tickUpdate=this.tick=3E4;this.enemyTolerance=!0;this.particleParams={cyrcle:"red-ring-cyrcle.png",ring:"tower-red-ring.png",sizeCyrcle:120};this.attackRange=!1;this.mp=45;this.state=!0;this.disable=!1;this.label=a.uniqueId();this.target="";this.detail=m.lang.fn("skill","createRed","detail");this.active=this.firstLoad=!0;this.slotLocation=
"";this.level=1},arrowRain:function(){this.name="arrowRain";this.className="arrow-rain";this.displayName=m.lang.fn("skill","arrowRain","displayName");this.type="active";this.tickUpdate=this.tick=900;this.enemyTolerance=!0;this.attackRange=!1;this.damageMax=132;this.damageMin=76;this.damageType="magic";this.mp=315;this.state=!0;this.disable=!1;this.label=a.uniqueId();this.target="";this.detail=m.lang.fn("skill","arrowRain","detail");this.active=this.firstLoad=!0;this.slotLocation="";this.level=1},
teleportation:function(){this.className=this.name="teleportation";this.displayName=m.lang.fn("skill","teleportation","displayName");this.type="active";this.tickUpdate=this.tick=250;this.enemyTolerance=!0;this.attackRange=!1;this.mp=145;this.state=!0;this.disable=!1;this.label=a.uniqueId();this.target="";this.detail=m.lang.fn("skill","teleportation","detail");this.active=this.firstLoad=!0;this.slotLocation="";this.level=1},teleport:function(){this.className=this.name="teleport";this.displayName=m.lang.fn("skill",
"teleport","displayName");this.type="active";this.tickUpdate=this.tick=250;this.opacityStart=.07;this.frameStart="teleport";this.frameSkillStart="die";this.opacityEnd=.05;this.frameSkillEnd=this.frameEnd="summon";this.mp=145;this.state=!0;this.disable=!1;this.label=a.uniqueId();this.target="";this.detail=m.lang.fn("skill","teleport","detail");this.active=this.firstLoad=!0;this.slotLocation="";this.level=1},bloodDrain:function(){this.name="bloodDrain";this.className="roar-of-protection";this.displayName=
m.lang.fn("skill","bloodDrain","displayName");this.type="active";this.tickUpdate=this.tick=1200;this.damageMax=570;this.damageMin=520;this.healthConvertion=100;this.mp=115;this.state=!0;this.disable=!1;this.label=a.uniqueId();this.target="";this.detail=m.lang.fn("skill","bloodDrain","detail");this.active=this.firstLoad=!0;this.slotLocation="";this.level=1},healing:function(){this.name="healing";this.className="";this.displayName=m.lang.fn("skill","healing","displayName");this.type="active";this.tickUpdate=
this.tick=600;this.healthIncreaseMax=321;this.healthIncreaseMin=264;this.mp=220;this.state=!0;this.disable=!1;this.label=a.uniqueId();this.target="";this.detail=m.lang.fn("skill","healing","detail");this.active=this.firstLoad=!0;this.slotLocation="";this.level=1},massHealing:function(){this.name="massHealing";this.className="";this.displayName=m.lang.fn("skill","massHealing","displayName");this.type="active";this.tickUpdate=this.tick=600;this.healthIncreaseMax=251;this.healthIncreaseMin=184;this.mp=
279;this.state=!0;this.disable=!1;this.label=a.uniqueId();this.target="";this.detail=m.lang.fn("skill","massHealing","detail");this.active=this.firstLoad=!0;this.slotLocation="";this.level=1},growHowl:function(){this.name="growHowl";this.className="";this.displayName=m.lang.fn("skill","growHowl","displayName");this.type="active";this.tick=1E3;this.tickUpdate=600;this.damageIncreaseMax=60;this.damageIncreaseMin=40;this.mp=253;this.state=!0;this.disable=!1;this.label=a.uniqueId();this.target="";this.detail=
m.lang.fn("skill","growHowl","detail");this.active=this.firstLoad=!0;this.slotLocation="";this.level=1},bodyCharge:function(){this.name="bodyCharge";this.className="";this.displayName=m.lang.fn("skill","bodyCharge","displayName");this.type="active";this.tickUpdate=this.tick=400;this.mp=244;this.damageMax=672;this.damageMin=440;this.damageType="vitallity";this.state=!0;this.disable=!1;this.label=a.uniqueId();this.target="";this.detail=m.lang.fn("skill","bodyCharge","detail");this.active=this.firstLoad=
!0;this.slotLocation="";this.level=1},bindingRoot:function(){this.name="bindingRoot";this.className="";this.displayName=m.lang.fn("skill","bindingRoot","displayName");this.type="active";this.tickUpdate=this.tick=990;this.mp=188;this.reduceMovement=.75;this.state=!0;this.disable=!1;this.label=a.uniqueId();this.target="";this.detail=m.lang.fn("skill","bindingRoot","detail");this.active=this.firstLoad=!0;this.slotLocation="";this.level=1},defenseSteal:function(){this.name="defenseSteal";this.className=
"";this.displayName=m.lang.fn("skill","bindingRoot","displayName");this.type="active";this.tickUpdate=this.tick=600;this.defenseRateMax=25;this.defenseRateMin=20;this.icon="defense-steal-small.png";this.life=20;this.mp=124;this.state=!0;this.disable=!1;this.label=a.uniqueId();this.target="";this.detail=m.lang.fn("skill","bindingRoot","detail");this.active=this.firstLoad=!0;this.slotLocation="";this.level=1},abilitiesSteal:function(){this.name="abilitiesSteal";this.className="";this.displayName=m.lang.fn("skill",
"abilitiesSteal","displayName");this.type="active";this.tickUpdate=this.tick=600;this.avoidMax=15;this.avoidMin=8;this.blockMax=15;this.blockMin=8;this.icon="abilities-steal-small.png";this.life=20;this.mp=45;this.state=!0;this.disable=!1;this.label=a.uniqueId();this.target="";this.detail=m.lang.fn("skill","abilitiesSteal","detail");this.active=this.firstLoad=!0;this.slotLocation="";this.level=1},earthShake:function(){this.name="earthShake";this.className="";this.displayName=m.lang.fn("skill","earthShake",
"displayName");this.type="active";this.tickUpdate=this.tick=200;this.mp=211;this.state=!0;this.disable=!1;this.label=a.uniqueId();this.target="";this.damageMax=420;this.damageMin=350;this.damageType="magic";this.detail=m.lang.fn("skill","earthShake","detail");this.active=this.firstLoad=!0;this.slotLocation="";this.level=1},sekletonSummoner:function(){this.name="sekletonSummoner";this.className="";this.displayName=m.lang.fn("skill","sekletonSummoner","displayName");this.type="active";this.tickUpdate=
this.tick=1E3;this.mp=232;this.state=!0;this.disable=!1;this.life=200;this.spawnTick=25;this.selectedSkillFrame="idle";this.initialParams={aiParams:"sekletonSpear",spawn:{x:0,y:0},spawnTotal:1,aIParent:"",forceGravity:!1,maximumPawns:4};this.label=a.uniqueId();this.target="";this.detail=m.lang.fn("skill","sekletonSummoner","detail");this.active=this.firstLoad=!0;this.slotLocation="";this.level=1},golemSummoner:function(){this.name="golemSummoner";this.className="";this.displayName=m.lang.fn("skill",
"golemSummoner","displayName");this.type="active";this.tickUpdate=this.tick=1E3;this.mp=232;this.state=!0;this.disable=!1;this.life=200;this.spawnTick=45;this.selectedSkillFrame="skill";this.initialParams={aiParams:"golem",spawn:{x:0,y:0},spawnTotal:1,aIParent:"",forceGravity:!1,maximumPawns:4};this.label=a.uniqueId();this.target="";this.detail=m.lang.fn("skill","golemSummoner","detail");this.active=this.firstLoad=!0;this.slotLocation="";this.level=1},beresekYeti:function(){this.name="beresekYeti";
this.className="";this.displayName=m.lang.fn("skill","beresekYeti","displayName");this.type="active";this.tick=1200;this.tickUpdate=600;this.damageIncreaseMax=25;this.damageIncreaseMin=15;this.speedIncrease=5.5;this.mp=221;this.state=!0;this.disable=!1;this.label=a.uniqueId();this.target="";this.detail=m.lang.fn("skill","beresekYeti","detail");this.active=this.firstLoad=!0;this.slotLocation="";this.level=1},earthQuake:function(){this.name="earthQuake";this.className="";this.displayName=m.lang.fn("skill",
"earthQuake","displayName");this.type="active";this.tickUpdate=this.tick=600;this.mp=143;this.target="";this.damageMax=450;this.damageMin=323;this.damageType="magic";this.detail="";this.state=!0;this.detail=m.lang.fn("skill","earthQuake","detail");this.label=a.uniqueId();this.active=this.firstLoad=!0;this.slotLocation="";this.level=1},mindControl:function(){this.name="mindControl";this.className="";this.displayName=m.lang.fn("skill","mindControl","displayName");this.type="active";this.tickUpdate=
this.tick=1E3;this.mp=231;this.state=!0;this.disable=!1;this.life=200;this.label=a.uniqueId();this.target="";this.detail=m.lang.fn("skill","mindControl","detail");this.active=this.firstLoad=!0;this.slotLocation="";this.level=1},powerDefenese:function(){this.name="powerDefenese";this.className="";this.displayName=m.lang.fn("skill","powerDefenese","displayName");this.type="active";this.tick=1200;this.tickUpdate=600;this.defenseRateMax=15;this.defenseRateMin=10;this.blockMax=15;this.blockMin=10;this.criticalChanceMin=
this.criticalChanceMax=this.criticalMin=this.criticalMax=0;this.icon="power-defense-small.png";this.mp=118;this.state=!0;this.disable=!1;this.label=a.uniqueId();this.target="";this.detail=m.lang.fn("skill","powerDefenese","detail");this.active=this.firstLoad=!0;this.slotLocation="";this.level=1},powerDefeneseII:function(){this.name="powerDefeneseII";this.className="";this.displayName=m.lang.fn("skill","powerDefeneseII","displayName");this.type="active";this.tick=1200;this.tickUpdate=600;this.defenseRateMax=
20;this.defenseRateMin=15;this.blockMax=20;this.blockMin=15;this.criticalMax=113;this.criticalMin=77;this.criticalChanceMax=15;this.criticalChanceMin=10;this.icon="power-defense-ii-small.png";this.mp=201;this.state=!0;this.disable=!1;this.label=a.uniqueId();this.target="";this.detail=m.lang.fn("skill","powerDefeneseII","detail");this.active=this.firstLoad=!0;this.slotLocation="";this.level=1},powerDefeneseIII:function(){this.name="powerDefeneseIII";this.className="";this.displayName=m.lang.fn("skill",
"powerDefeneseIII","displayName");this.type="active";this.tick=1200;this.tickUpdate=600;this.defenseRateMax=20;this.defenseRateMin=15;this.blockMax=25;this.blockMin=15;this.criticalMax=245;this.criticalMin=152;this.criticalChanceMax=25;this.criticalChanceMin=15;this.icon="power-defense-iii-small.png";this.mp=258;this.state=!0;this.disable=!1;this.label=a.uniqueId();this.target="";this.detail=m.lang.fn("skill","powerDefeneseIII","detail");this.active=this.firstLoad=!0;this.slotLocation="";this.level=
1},powerAgility:function(){this.name="powerAgility";this.className="";this.displayName=m.lang.fn("skill","powerAgility","displayName");this.type="active";this.tick=1200;this.tickUpdate=600;this.defenseRateMax=20;this.defenseRateMin=15;this.avoidMax=20;this.avoidMin=10;this.criticalChanceMin=this.criticalChanceMax=this.criticalMin=this.criticalMax=0;this.icon="power-agility-small.png";this.mp=118;this.state=!0;this.disable=!1;this.label=a.uniqueId();this.target="";this.detail=m.lang.fn("skill","powerAgility",
"detail");this.active=this.firstLoad=!0;this.slotLocation="";this.level=1},powerAgilityII:function(){this.name="powerAgilityII";this.className="";this.displayName=m.lang.fn("skill","powerAgilityII","displayName");this.type="active";this.tick=1200;this.tickUpdate=600;this.defenseRateMax=25;this.defenseRateMin=20;this.avoidMax=15;this.avoidMin=10;this.criticalMax=101;this.criticalMin=65;this.criticalChanceMax=15;this.criticalChanceMin=10;this.icon="power-agility-ii-small.png";this.mp=201;this.state=
!0;this.disable=!1;this.label=a.uniqueId();this.target="";this.detail=m.lang.fn("skill","powerAgilityII","detail");this.active=this.firstLoad=!0;this.slotLocation="";this.level=1},powerAgilityIII:function(){this.name="powerAgilityIII";this.className="";this.displayName=m.lang.fn("skill","powerAgilityIII","displayName");this.type="active";this.tick=1200;this.tickUpdate=600;this.defenseRateMax=25;this.defenseRateMin=20;this.avoidMax=15;this.avoidMin=10;this.criticalMax=225;this.criticalMin=192;this.criticalChanceMax=
25;this.criticalChanceMin=15;this.icon="power-agility-iii-small.png";this.mp=258;this.state=!0;this.disable=!1;this.label=a.uniqueId();this.target="";this.detail=m.lang.fn("skill","powerAgilityIII","detail");this.active=this.firstLoad=!0;this.slotLocation="";this.level=1}},buffSkills:{powerAgilityIII:function(a){this.name="powerAgilityIII";this.interval=0;this.tick=this.intervalUpdate=600;this.chance=a&&a.chance||100},powerAgilityII:function(a){this.name="powerAgilityII";this.interval=0;this.tick=
this.intervalUpdate=600;this.chance=a&&a.chance||100},powerAgility:function(a){this.name="powerAgility";this.interval=0;this.tick=this.intervalUpdate=600;this.chance=a&&a.chance||100},powerDefeneseIII:function(a){this.name="powerDefeneseIII";this.interval=0;this.tick=this.intervalUpdate=600;this.chance=a&&a.chance||100},powerDefeneseII:function(a){this.name="powerDefeneseII";this.interval=0;this.tick=this.intervalUpdate=600;this.chance=a&&a.chance||100},powerDefenese:function(a){this.name="powerDefenese";
this.interval=0;this.tick=this.intervalUpdate=600;this.chance=a&&a.chance||100},mindControl:function(a){this.name="mindControl";this.intervalUpdate=this.interval=30;this.tick=600;this.chance=a&&a.chance||100},bereseker:function(a){this.name="bereseker";this.interval=0;this.tick=this.intervalUpdate=600;this.chance=a&&a.chance||100},defenseSteal:function(a){this.name="defenseSteal";this.interval=0;this.tick=this.intervalUpdate=600;this.chance=a&&a.chance||100},abilitiesSteal:function(a){this.name="abilitiesSteal";
this.interval=0;this.tick=this.intervalUpdate=600;this.chance=a&&a.chance||100},healing:function(a){this.name="healing";this.intervalUpdate=this.interval=50;this.tick=600;this.icon="healing-small.png";this.chance=a&&a.chance||100},massHealing:function(a){this.name="massHealing";this.intervalUpdate=this.interval=50;this.tick=600;this.icon="healingSmall.png";this.chance=a&&a.chance||100},bindingRoot:function(a){this.name="bindingRoot";this.interval=0;this.tick=this.intervalUpdate=750;this.chance=a&&
a.chance||100},stunEffect:function(a){this.name="stunEffect";this.interval=0;this.intervalUpdate=1;this.tick=90;this.chance=a&&a.chance||100},burningEffect:function(a){this.name="burningEffect";this.intervalUpdate=this.interval=30;this.tick=600;this.chance=a&&a.chance||100},growHowl:function(a){this.name="growHowl";this.interval=0;this.tick=this.intervalUpdate=600;this.damageIncreaseMax=a&&a.damageIncreaseMax||25;this.damageIncreaseMin=a&&a.damageIncreaseMin||15;this.chance=a&&a.chance||100},intimidation:function(a){this.name=
"intimidation";this.intervalUpdate=this.interval=30;this.tick=1E3;this.damageMax=a&&a.damageMax||25;this.damageMin=a&&a.damageMin||5;this.chance=a&&a.chance||100},bloodDrain:function(a){this.name="bloodDrain";this.intervalUpdate=this.interval=30;this.tick=900;this.chance=a&&a.chance||100}}};a.staticWallOutter.value=function(){return a["staticWallOutter"+a.activeMap.value].value};a.infoFilter.value=function(b){for(var c=a.slice(a.qs("wrap-box-text").getElementsByTagName("span")),d=0,f=c.length;d<f;d++)a.addClass(c[d],
"hidden");if(0===b)for(d=0,f=c.length;d<f;d++)a.removeClass(c[d],"hidden");else if(2===b)for(d=0,f=c.length;d<f;d++)/primary-title/i.test(c[d].className)&&a.removeClass(c[d],"hidden");else if(3===b)for(d=0,f=c.length;d<f;d++)/regular-title|exp-title/i.test(c[d].className)&&a.removeClass(c[d],"hidden")};a.globalCharacterState.value=a[a.oval.value.stateStorage];a.guiSupportAvailable.value=["chara-support-b"];a.characterSkills.value.set("initial",{label:"",state:!1,target:""});a.characterParameters.value=
{name:"oval",mainCharacter:!0,range:100,attackRangeMax:45,attackRangeMin:31,rigBody:"",health:48E4,maxHealth:5E5,maxHealthCure:49E4,mp:1500,maxMp:1500,maxMpCure:1500,attackMax:725,attackMin:415,defenseMax:74,defenseMin:25,magicDefenseMax:35,magicDefenseMin:25,buffSkill:{},setting:{mpPercentage:100,healthPercentage:100,effect:!0},activeSkill:[],modifierAbilities:{block:70},abilitySkill:{intimidation:!0,rollingAttack:!0,upperAttack:!0,sliceAttack:!0},exp:0,expTemp:0,skillPoint:0,gold:5E4,level:1,attackType:"melee",
object:a.oval.value};a.staticWorld.value=a.engine.world;document.getElementById("fps");localStorage.getItem("load")||(a.itemShop.value.set("global",m.shop),a.character(),a.intervalList.orerObjManual={always:!0,tick:10,tickUpdate:10,fn:function(){a.orderObjectFn.value()}},a.intervalList.updateObjManual={always:!0,tick:10,tickUpdate:60,fn:function(){a.monsterControl.triggerMonsterFn("update");a.caracterSkillToogleFn.value()}})}};t.GUI=function(a){this.fn=new a.utils;var c={path:"assets/2d/"};for(f in c)a[f]=
c[f];var f=arguments;for(var b=f.length;b--;)"function"===typeof f[b]&&(f[b].apply(null,[this,a]),f[b].apply(null,[this,c]),this.controllers(),this.bagAndSkill(),this.mouseCreate(document.body))};t.GUI.prototype={controllers:function(){var a=this,c=a.qs("jump-right-nav"),f=a.qs("attack-right-nav"),b=a.slice(a.qs("menu-map").getElementsByTagName("li")),d=a.slice(a.qs("menu-map-mobile").getElementsByTagName("li"));b=b.concat(d);var k=a.qs("gui-tower-def"),h=a.qs("menu-ui-left"),g=a.qs("menu-ui-right"),
l=a.qs("close-dialog"),m=a.qs("gui-player"),n={outterObj:a.qs("outter"),innerObj:a.qs("inner"),move:!1,pointRad:{},angle:0,offset:{top:0,left:0}},q={getControlRad:function(a){var b=a.outterObj.getBoundingClientRect();a.pointRad.x=b.left+b.width/2;a.pointRad.y=b.top+b.height/2;a.offset.left=b.left;a.offset.top=b.top;a.outterWidth=a.outterObj.offsetWidth;a.innerWidth=a.innerObj.offsetWidth},getPointRad:function(a){return{x:Math.cos(a),y:Math.sin(a)}},getAngle:function(a,b){if(0===a&&0===b)return n.angle;
var c=Math.atan(b/a);0>a&&0<=b?c+=Math.PI:0>a&&0>b?c+=Math.PI:0<=a&&0>b&&(c+=2*Math.PI);return n.angle=c},isInside:function(a,b){return a<=b/2},setBtnPosition:function(b,c,d){var f=d.innerWidth/2;a.css(d.innerObj,{top:d.offset.top-f-d.innerWidth+5+d.outterWidth-c*d.outterWidth/2+"px",left:d.offset.left-f-30+d.outterWidth+b*d.outterWidth/2+"px",position:"fixed"})},setIdle:function(b,c,d){var f=a.browserWidth()/2;a.mousePosition.value.pos.mousedown.x<f&&(f=a.characterMobileControl.value,d&&(a.objTranslate.value.moveUp=
!1,a.objTranslate.value.moveDown=!1,f.charObj.moveUp=!1,f.charObj.moveDown=!1),b!==f.status&&(d=a.oval.value.label,a.isMobile()&&("up"!==b&&(a.objTranslate.value.moveUp=!1),"down"!==b&&(a.objTranslate.value.moveDown=!1),"left"!==b&&(a.objTranslate.value.moveLeft=!1),"right"!==b&&(a.objTranslate.value.moveRight=!1),"left"!==b&&(f.charObj.moveLeft=!1),"right"!==b&&(f.charObj.moveRight=!1),"up"!==b&&(f.charObj.moveUp=!1),"down"!==b&&(f.charObj.moveDown=!1),"right"===b&&(f.charObj.dirSwitch.right=!0),
"left"===b&&(f.charObj.dirSwitch.left=!0),f.firstTouch=!1,/idle|die/i.test(b)&&/idle/i.test(b)&&a.globalCharacterState.value.set(d,"idle"),f.status=c)))},control:function(b){var c=a.characterMobileControl.value;c.mobileCtr||(c.charObj.dirSwitch.delayDir=1,c.firstTouch=!0);"left"===b?c.charObj.moveLeft||(a.objTranslate.value.moveLeft=!0,c.charObj.moveLeft=!0):"right"===b?c.charObj.moveRight||(a.objTranslate.value.moveRight=!0,c.charObj.moveRight=!0):"up"===b?c.charObj.moveUp||(a.objTranslate.value.moveUp=
!0,c.charObj.moveUp=!0):"down"!==b||c.charObj.moveDown||(a.objTranslate.value.moveDown=!0,c.charObj.moveDown=!0)},centerMap:function(a){6===a.mark?(a.centerMap.x=-10,a.centerMap.y=55,a.centerMark.x=0,a.centerMark.y=25):8===a.mark?(a.centerMap.x=40,a.centerMap.y=0,a.centerMark.x=25,a.centerMark.y=35):10===a.mark&&(a.centerMap.x=85,a.centerMap.y=-62,a.centerMark.x=40,a.centerMark.y=45)},inMobleControl:function(b){if(!a.isMobile())return!1;var c=document.body.getBoundingClientRect();var d=c.right/4;
var f=c.bottom;var g=c.bottom/2;0<b.x&&b.x<d&&b.y>g&&b.y<f&&(g=n.outterWidth?n.outterWidth:102,n.outterObj.style.marginLeft=b.x-g/2+"px",n.outterObj.style.marginTop=b.y-c.bottom-g/2+5+"px",a.removeClass(n.innerObj,"center"),a.removeClass(n.outterObj,"hidden"),a.addClass(a.qs("controller-appear"),"hidden"),n.move=!0)},initControl:function(b){q.getControlRad(b);var c=a.mousePosition.value.pos.mousemove.x,d=a.mousePosition.value.pos.mousemove.y,f=a.distanceAndAngleBetweenTwoPoints(b.pointRad.x,b.pointRad.y,
c,d),g=b.outterWidth/2;g=q.getAngle((c-b.offset.left+g-b.outterWidth)/b.outterWidth*2,(-(d-b.offset.top+g)+b.outterWidth)/b.outterWidth*2);var h=180/Math.PI*g;q.isInside(f.distance,b.outterWidth)?a.css(b.innerObj,{top:d+"px",left:c+"px",position:"fixed"}):(f=q.getPointRad(g),q.setBtnPosition(f.x,f.y,b));return{radian:g,degree:h,pos:{x:c,y:d}}},removeMarkerMonster:function(b){b=a.globalEngine.value.world.bodies;for(var c=0;c<b.length;c++)/controlRight/i.test(b[c].label)&&a.globalWorld.value.remove(a.globalEngine.value.world,
b[c])}};a.attachListener(a.qs("credit-close"),"click",function(b){a.addClass(a.nthParent(this,2),"hidden")});d=0;for(var r=a.slice(a.qsAll("loading-header li"));d<r.length;d++)a.attachListener(r[d],"click",function(b,c){a.playAudio("tab-selected");2===b?a.removeClass(a.qs("credit-alert"),"hidden"):1===b?a.fullscreenToogle(c):0===b&&(this.toggleButton(!0),/off/i.test(c.className)?(c.className="speaker-on",a.objTranslate.value.volume=!0,a.globalObjectGUI.value.audioBackground.setVolume("on")):(c.className=
"speaker-off",a.globalObjectGUI.value.audioBackground.setVolume("off"),a.objTranslate.value.volume=!1))}.bind(this,d,r[d]));a.scrollSlide();a.attachListener(h,"click",function(b){a.playAudio("tab-selected");a.audioBackground.fn("start");a.addClass(a.qs("loading-ui"),"hidden");a.removeClass(k,"hidden")});a.attachListener(g,"click",function(b){/expand/i.test(this.className)?(a.css(a.qs("menu-save"),{width:"0px",transition:"width 450ms ease-in-out"}),a.css(this,{transform:"0px,0px,0px",transition:"transform 450ms ease-in-out"}),
a.removeClass(this,"expand")):(a.css(a.qs("menu-save"),{width:"250px",transition:"width 450ms ease-in-out"}),a.css(this,{transform:"170px,0px,0px",transition:"transform 450ms ease-in-out"}),a.addClass(this,"expand"))});a.attachListener(l,"click",function(b){a.addClass(a.nthParent(this,2),"hidden")});d=a.qs("info-text").getBoundingClientRect();h=a.qs("init-box").getBoundingClientRect();g=document.body.getBoundingClientRect();a.qs("info-text").style.height=(g.bottom-d.top)/1.5+"px";a.qs("init-box").style.maxHeight=
(g.bottom-h.top)/2+"px";h=a.slice(a.qs("nav-info-text").getElementsByTagName("div"));d=0;for(g=h.length;d<g;d++)/checkbox/i.test(h[d].className)&&a.attachListener(h[d],"click",function(b,c){b.appendChild(a.qs("check"));a.infoFilter.value(c)}.bind(this,h[d],d));a.attachListener(a.qs("mini-map-mobile"),"click",function(b){if(/hidden/i.test(a.qs("menu-map-mobile").className)){if(a.removeClass(a.qs("menu-map-mobile"),"hidden"),a.removeClass(a.qs("box-map"),"hidden"),b=a.scaleMap.value)a.qs("progress-exp").style.marginTop=
"180px",a.qs("progress-exp").style.marginRight="0",b.close=!1}else a.addClass(a.qs("menu-map-mobile"),"hidden")});a.attachListener(a.qs("mini-map"),"click",function(b){b=a.scaleMap.value;this.style.display="none";a.removeClass(a.qs("box-map"),"hidden");a.qs("menu-map").style.display="block";a.isMobile()||(a.qs("info-menu").style.display="block");a.qs("progress-exp").style.marginTop="180px";a.qs("progress-exp").style.marginRight="0";b.close=!1});d=0;for(g=b.length;d<g;d++)a.attachListener(b[d],"click",
function(b){var c=a.scaleMap.value;0===b||5===b?(c.close=!0,5===b?(a.addClass(a.qs("menu-map-mobile"),"hidden"),a.removeClass(a.qs("mini-map-mobile"),"hidden")):(a.qs("menu-map").style.display="none",a.qs("mini-map").style.display="block",a.qs("info-menu").style.display="none"),a.addClass(a.qs("box-map"),"hidden"),a.qs("progress-exp").style.marginTop="-5px",a.qs("progress-exp").style.marginRight="55px"):(2===b||3===b)&&6<c.mark?(c.map-=.5,c.mark-=2,q.centerMap(c)):(1===b||4===b)&&10>c.mark&&(c.map+=
.5,c.mark+=2,q.centerMap(c))}.bind(this,d));a.attachListener(f,"click",function(b){a.characterMobileControl.value.charObj.findTargetToAttack()});a.attachListener(c,a.CursorStartEvent,function(b){a.oval.value.forceGravity&&(a.characterMobileControl.value.charObj.jump=!0)});a.attachListener(document,a.CursorStartEvent,function(b){/hidden/i.test(m.className)&&q.inMobleControl(a.mousePosition.value.pos.mousemove)});a.attachListener(document.body,a.CursorMoveEvent,function(b){if("die"!==a.globalCharacterState.value.storage[0].status){if(n.move&&
/hidden/i.test(m.className)){q.getControlRad(n);b=a.characterMobileControl.value.charObj;var c=q.initControl(n),d=c.degree,f=c.radian;c=Math.abs(Math.cos(f)*b.moveReplaceX);f=Math.abs(Math.sin(f)*b.moveReplaceY);self.objTranslate.isCenter.state||(b.objTranslate.staticObjMoveX=c,b.objTranslate.staticObjMoveY=f);90<=d&&180>=d?(q.setIdle("left","left"),q.control("left"),q.control("up"),b.changeDir("left")):0<=d&&90>d?(q.setIdle("right","right",!0),q.control("right"),q.control("up"),b.changeDir("right")):
180<=d&&270>=d?(q.setIdle("down","down"),q.control("left"),q.control("down"),b.changeDir("left")):270<=d&&360>=d&&(q.setIdle("right","right",!0),q.control("right"),q.control("down"),b.changeDir("right"))}}else q.setIdle("die")});a.attachListener(document.body,a.CursorEndEvent,function(b){"die"===a.globalCharacterState.value.storage[0].status?q.setIdle("die"):!a.characterMobileControl.value.charObj.jump&&q.setIdle("idle");n.innerObj.setAttribute("style","");a.addClass(n.outterObj,"hidden");window.scope.virtualControl&&
a.removeClass(a.qs("controller-appear"),"hidden");n.move=!1})},bagAndSkill:function(){setTimeout(function(){var a=this;a.bagLoot.getElementsByTagName("div");var c=a.slice(a.qs("passive-magic").getElementsByTagName("li")),f=a.slice(a.qs("body-box").getElementsByTagName("div")),b=a.slice(a.bagLoot.getElementsByTagName("li")).concat([a.slotButtonHp,a.slotButtonMp]).concat(c).concat(f),d=[a.slotSkillA,a.slotSkillB,a.slotSkillC,a.id("slot-skill-i"),a.id("slot-skill-j"),a.id("slot-skill-k"),a.id("slot-skill-l"),
a.id("slot-skill-m"),a.id("slot-skill-n"),a.id("slot-skill-o"),a.id("slot-skill-p"),a.id("slot-skill-q")],k=a.slice(a.slotPassiveSkill.getElementsByTagName("li")),h=d.concat(k),g=a.slice(a.qs("list-skills").getElementsByTagName("li")),l=a.qs("container-skill"),p=a.slice(a.skillBox.getElementsByTagName("li")).concat(d).concat(k).concat(g),n=window.localStorage,q=a.qs("switch-right-nav"),r=a.qsAll("nav-right"),t=a.qs("gui-player");a.qs("skill-point");var u=a.qs("soul-point"),K=a.qs("upgrade-msg"),C=
a.qs("save-msg"),A=a.qs("load-msg"),D=a.qs("load-alert"),E=a.qs("load-alert").getElementsByTagName("button"),W=a.qs("upgrade-header"),J=a.qs("upgrade-alert"),ya=a.qs("upgrade-alert").getElementsByTagName("button")[0],G=a.qs("upgrade-msg").getElementsByTagName("button"),P=a.qs("save-msg").getElementsByTagName("button"),B=a.qs("load-msg").getElementsByTagName("button"),S=a.qs("upgrade-msg").getElementsByTagName("p")[1],L=a.qs("static-detail"),Q=a.slice(a.qs("control-container-detail").getElementsByTagName("div")),
M=a.qs("main-config").getElementsByTagName("li"),N=a.qs("save-detail-cnt"),Z=a.qs("menu-save").getElementsByTagName("ul")[0],ca=a.qs("save-alert"),da=a.qs("save-alert").getElementsByTagName("button")[0],X=a.qs("drop-alert"),ea=X.getElementsByTagName("button")[0],sa=X.getElementsByTagName("button")[1],Y=a.slice(a.qs("button-small").getElementsByTagName("div")),ia=a.slice(a.qs("hidden-menu").getElementsByTagName("li")),ja=a.qs("box-level"),aa=a.qs("monster-params"),la=aa.getElementsByTagName("button")[0],
ma=a.qs("mining-button"),U=a.qs("mining-box"),na=U.getElementsByTagName("button")[0],ba=a.qs("shop-box"),fa=ba.getElementsByTagName("button")[0],ka=a.qs("shop"),ha=a.qs("buy-box"),ua=a.qs("buy-box").getElementsByTagName("button")[0],qa=a.qs("orientation-alert"),ra=qa.getElementsByTagName("button")[0],Ha=ia[0],Ba=Y[0],Ca=Y[1],za=Y[2],Da=Y[3],Aa=Y[4],Ka=Y[5],La=Y[6],Ia=Y[7],xa=a.slice(a.qs("menu-bag-bottom").getElementsByTagName("li")).slice(2,5),va=a.slotButtonMp,ta=a.slotButtonHp,T=a.isMobile();if(T){c=
a.slice(a.qs("items-equipment-mb").getElementsByTagName("li"));potions=a.slice(a.qs("items-hidden-potion-mb").getElementsByTagName("li"));itemsBag=a.slice(a.qs("items-bag-mb").getElementsByTagName("li"));b=itemsBag.concat(c).concat(f).concat(potions);xa=a.slice(a.qs("control-itembg-mb").getElementsByTagName("div"));L=a.qs("wrap-item-info-mb");t=a.qs("gui-player-mb");va=potions[0];ta=potions[1];a.qs("skill-point-mb");u=a.qs("soul-point-mb");slotSkillActiveMb=a.slice(a.qs("items-slot-skill-mb").getElementsByTagName("li"));
g=a.slice(a.qs("items-skill-mb").getElementsByTagName("li"));h=d.concat(k).concat(slotSkillActiveMb);p=a.slice(a.skillBox.getElementsByTagName("li")).concat(d).concat(k).concat(g).concat(slotSkillActiveMb);N=a.qs("save-detail-cnt-mb");La=a.qs("auto-skill-nav");Ia=a.qs("auto-switch-nav");k=a.slice(a.qsAll("sc-confirm"));a.addClass(a.qs("upgrader-box"),"mobile");a.qs("cnt-bag-mb").insertBefore(a.qs("upgrader-box"),a.qs("cnt-bag-mb").firstChild);var R=0;for(Y=k.length;R<Y;R++)a.addClass(k[R],"mobile");
k=document.getElementsByTagName("html")[0].getBoundingClientRect().height-55;a.css(a.qs("monster-content"),{height:k+"px"})}var w={formula:{operators:{"+":function(a,b){return a+b},"-":function(a,b){return a-b}},removeNotExistObjectinItem:function(b){var c=a.globalEngine.value.world.bodies,d=0,f=b.item.registered.length;a:for(;d<f;d++){for(var g=0,h=c.length;g<h;g++)if(b.item.registered[d]===c[g].label)continue a;b.item.registered.splice(d,1)}},isObjectRegistered:function(a,b,c,d){for(var f=0,g=a.registered.length;f<
g;f++)if("check"===c&&a.registered[f]===b){if("attach"===d)return!1;break}else if("delete"===c&&a.registered[f]===b){a.registered.splice(f,1);break}return!0},require:function(b,c,d){if(this.isObjectRegistered(d.item,c,"check",d.status)){b.originalParams||(b.originalParams={},a.extend(b.originalParams,b,!0));b.modifierAbilities||(b.modifierAbilities={});if("detached"===d.status)this.isObjectRegistered(d.item,c,"delete");else{b=!0;for(var f=d.item.registered,g=0,h=f.length;g<h;g++)if(f[g]===c){b=!1;
break}b&&d.item.registered.push(c)}return!0}return!1},stunOrCriticalChange:function(b,c,d,f){this.require(b,c,d)&&(c="attached"===d.status?"+":"-","attached"===d.status?b.modifierAbilities[f]?b.modifierAbilities[f]=this.operators[c](b.modifierAbilities[f],d.prop.value):(c={},c[f]=d.prop.value,a.extend(b.modifierAbilities,c,!0)):b.modifierAbilities[f]=this.operators[c](b.modifierAbilities[f],d.prop.value))},defenseChange:function(a,b,c){if(this.require(a,b,c)){b=a.originalParams.defenseMin;var d="attached"===
c.status?"+":"-";a.defenseMax=this.operators[d](a.defenseMax,a.originalParams.defenseMax*c.prop.value/100);a.defenseMin=this.operators[d](a.defenseMin,b*c.prop.value/100)}},magicDefenseChange:function(a,b,c){if(this.require(a,b,c)){b=a.originalParams.magicDefenseMin;var d="attached"===c.status?"+":"-";a.magicDefenseMax=this.operators[d](a.magicDefenseMax,a.originalParams.magicDefenseMax*c.prop.value/100);a.magicDefenseMin=this.operators[d](a.magicDefenseMin,b*c.prop.value/100)}},attackChange:function(a,
b,c){if(this.require(a,b,c)){b=a.originalParams.attackRangeMin;var d=a.originalParams.attackMax,f=a.originalParams.attackMin,g="attached"===c.status?"+":"-";a.attackRangeMax=this.operators[g](a.attackRangeMax,a.originalParams.attackRangeMax*c.prop.value/100);a.attackRangeMin=this.operators[g](a.attackRangeMin,b*c.prop.value/100);a.attackMax=this.operators[g](a.attackMax,d*c.prop.value/100);a.attackMin=this.operators[g](a.attackMin,f*c.prop.value/100)}},initControl:function(a,b,c){switch(c.init){case "attack":this.attackChange(a,
b,c);break;case "defense":this.defenseChange(a,b,c);break;case "magicDefense":this.magicDefenseChange(a,b,c);break;case "stun":this.stunOrCriticalChange(a,b,c,"stun");break;case "critical":this.stunOrCriticalChange(a,b,c,"critical");break;case "criticalChance":this.stunOrCriticalChange(a,b,c,"criticalChance");break;case "avoid":this.stunOrCriticalChange(a,b,c,"avoid");break;case "block":this.stunOrCriticalChange(a,b,c,"block")}}},autoUpdateEffectItemLeader:function(){for(var b=a.registerMagicBoxItem.value.storage,
c=a.globalAnimation.value.characterControl.bossObject.pions,d=0,f=b.length;d<f;d++){var g=b[d].status;if("leader"===g.itemfor)for(var h=0,k=c.length;h<k;h++){for(var l=!1,m=c[h],n=0,p=g.registered;n<p.length;n++)p[n]===m.label&&(l=!0);if(!l)for(var q in g.effect)this.formula.initControl(m.statParameters,m.label,{init:q,prop:g.effect[q],label:g.label,item:g,status:"attached"})}}},magicFormula:function(b){for(var c=this.formula,d=b.prop,f=a.characterParameters.value,g=a.oval.value.pions,h=0,k=d.target.length;h<
k;h++)if("character"===d.target[h])c.initControl(f,f.object.label,b);else if("pion"===d.target[h]&&g.length)for(var F=0;F<g.length;F++)c.initControl(g[F].rigBody.monsterParameters,g[F].rigBody.label,b);"attached"===b.status&&a.registerMagicBoxItem.value.set(b.item.label,b.item)},getSkillByProperty:function(b,c){var d=a.characterSkills.value.get(a.oval.value.label),f;for(f in d)for(var g in d[f])if(d[f][g]===b&&c===g)return d[f]},checkAndRegisterItem:function(b,c,d){for(var f=a.characterInventoryBag.value.get(a.oval.value.label),
g=a.registerMagicBoxItem.value,h=0,k=f.length;h<k;h++){var F;if(!(F="detached"===c))a:{F=0;for(var l=g.storage.length;F<l;F++)if(f[h]&&g.storage[F].name===f[h].label){F=!1;break a}F=!0}if(F&&f[h]&&f[h].label===b&&f[h].unique){f[h].bagLocation=d;for(var m in f[h].effect)this.magicFormula({init:m,prop:f[h].effect[m],label:f[h].label,item:f[h],status:c});break}}},magicBox:function(b){for(var d=a.registerMagicBoxItem.value,f=function(b){for(var c=a.characterInventoryBag.value.get(a.oval.value.label),
d=0,f=c.length;d<f;d++)if(c[d].label===b)return!0;return!1},g=0,h=c.length;g<h;g++){var k=c[g].getElementsByTagName("div");k.length&&(k=k[0].getAttribute("label"),f(k)&&this.checkAndRegisterItem(k,"attached",b))}g=0;h=d.storage.length;a:for(;g<h;g++){var F=d.storage[g];if(F&&f(F.name)){for(var l=0,m=c.length;l<m;l++)if(k=c[l].getElementsByTagName("div"),k.length&&F.name===k[0].getAttribute("label"))continue a;this.checkAndRegisterItem(F.name,"detached",b);F&&a.registerMagicBoxItem.value.remove(F.name)}}},
upgrade:function(b,c,d){var f=this;a.attachListener(b,"click",function(){a.playAudio("tab-selected");a.removeClass(K,"hidden");var b=f.getSkillByProperty(c,"className");a.text(S,b.detail);a.text(W,b.displayName);K.setAttribute("label",b.label);K.setAttribute("prev-label",d)})},enchantFormula:function(b){for(var c={healthPotion:{tierA:{root:"magic",item:"healthPotion",type:"small",material:["health potion"]},tierB:{root:"magic",item:"healthMediumPotion",type:"small",material:["health medium potion"]},
tierC:{root:"magic",item:"healthStrongPotion",type:"small",material:["health strong potion"]}},manaPotion:{tierA:{root:"magic",item:"manaPotion",type:"small",material:["mana potion"]},tierB:{root:"magic",item:"manaMediumPotion",type:"small",material:["mana medium potion"]},tierC:{root:"magic",item:"manaStrongPotion",type:"small",material:["mana strong potion"]}},nortusShield:{tierA:{root:"dropMonster",item:"nortusShield",type:"small",material:["nortus shield"]}},telsadian:{tierA:{root:"dropMonster",
item:"telsadian",type:"small",material:["telsadian fragment"]}},redGemStone:{tierA:{root:"magic",item:"redGemStone",type:"small",material:["red gem stone"]}},taintedJewel:{tierA:{root:"magic",item:"taintedJewel",type:"small",material:["tainted material"]}}},d=a.characterInventoryBag.value.get(a.oval.value.label),g=[],h=b.sacrifice&&b.sacrifice||1,k=0,l=f.length;k<l;k++){var F=f[k].getElementsByTagName("div");if(F.length){F=F[0].getAttribute("label");for(var m=0,n=d.length;m<n;m++)for(var p=0,q=b.enchant.length;p<
q;p++)F===d[m].label&&!d[m].enchant&&b.enchant[p]===d[m].type&&d[m].quantity>=h&&g.push(d[m])}}F=b.formula;var r;a:for(r in F)if(c[r])for(h=c[r][F[r]],m=0,n=h.material,k=[],l=l=0;m<n.length;m++){for(p=0;p<g.length;p++)g[p].usage===n[m]&&(k.push(g[p]),l++);if(l===b.enchant.length){c=[];c.push(b.quantity);g=0;for(r=k.length;g<r;g++)c.push(k[g].quantity);l=b.sacrifice?b.sacrifice:c.sort(function(a,b){return a-b})[0];g=0;for(r=k.length;g<r;g++)k[g].quantity-=l;b.quantity=b.sacrifice?0:l<b.quantity?b.quantity-
l:0;b=new a.items.value[h.root][h.item]({quantity:b.sacrifice?1:l});b.bagLocation="slot-upgrd-f";b.enchantment=!0;c.length=0;d.push(b);this.createItem(b);a.characterUpdateQuest.value(h.item);this.fetchLoot();break a}}this.fetchLoot()},upgrader:function(){var b=a.qs("upgrader-box"),c=this;/hidden/i.test(b.className)?a.removeClass(b,"hidden"):a.addClass(b,"hidden");b=a.qs("head-box").cloneNode(!0);a.qs("head-box").parentNode.replaceChild(b,a.qs("head-box"));a.attachListener(b,"click",function(){a.playAudio("tab-selected");
a.addClass(this.parentNode,"hidden");for(var b=0;b<f.length;b++)f[b].innerHTML="",c.fetchLoot({preventBagLocation:!0})});b=a.qs("footer-box").cloneNode(!0);a.qs("footer-box").parentNode.replaceChild(b,a.qs("footer-box"));a.attachListener(a.qs("footer-box"),"click",function(){a.playAudio("tab-selected");if(!a.id("slot-upgrd-f").getElementsByTagName("div").length)for(var b=a.characterInventoryBag.value.get(a.oval.value.label),d=0,g=f.length;d<g;d++){var h=f[d].getElementsByTagName("div");if(h.length){h=
h[0].getAttribute("label");for(var k=0,l=b.length;k<l;k++)if(h===b[k].label&&b[k].enchant){c.enchantFormula(b[k]);break}}}})},fetchQuest:function(){var b=a.characterQuest.value.storage,c=T?"main-quest-mb":"main-quest",d=T?"child-quest-mb":"quest-detail",f=function(b){for(var d=a.slice(document.querySelectorAll("."+c+" > li")),f=0,g=d.length;f<g;f++)a.removeClass(d[f],"active");a.addClass(b,"active")},g=function(b){var c=!0,f=function(b){b=a.slice(b.getElementsByTagName("div"));for(var c=0;c<b.length;c++)/click/i.test(b[c].className)&&
h.active&&a[h.mapMark]&&a[h.mapMark].value.quest.update.length&&a.removeClass(b[c],"hidden")};a.qs(d).innerHTML="";for(var g in b){var h=b[g];k=document.createElement("li");if(h.active||h.isFinish)a.addChildQuest.value(h,k),a.qs(d).appendChild(k),c=""===h.mapMark?"dot-quest":"",h.isFinish&&(a.getFirstChild(k).className="quest-tree gold linethrough "+c),c=!1,f(k)}if(c)for(g in b){h=b[g];var k=document.createElement("li");a.addChildQuest.value(h,k);a.qs(d).appendChild(k);f(k);break}};a.qs(d).innerHTML=
a.qs(c).innerHTML="";for(var h in b){var k=b[h].status;if(k){var l=document.createElement("li");a.text(l,k.title);f(l);a.attachListener(l,"click",function(b,c){a.playAudio("tab-selected");f(b);g(c)}.bind(this,l,k.questTree));a.qs(c).insertBefore(l,a.qs(c).firstChild)}}b.length&&g(b[b.length-1].status.questTree)},fetchSkillOnload:function(){for(var b=0,c=p.length;b<c;b++)p[b].innerHTML="";if(b=a.characterSkills.value.get(a.oval.value.label))for(c=0;c<b.length;c++)if(""!==b[c].slotLocation){var d=document.createElement("div");
d.className="item clone "+b[c].className;d.setAttribute("label",b[c].label);d.setAttribute("type",b[c].type);var f=document.createElement("div");f.className="time-span time-span-"+b[c].label;d.appendChild(f);f=document.createElement("div");f.className="disable-skill";d.appendChild(f);a.id(b[c].slotLocation).innerHTML="";a.id(b[c].slotLocation).appendChild(d)}},fetchSkill:function(){var b=a.characterSkills.value.get(a.oval.value.label),c=T?slotSkillActiveMb:a.qs("browser-skill").getElementsByTagName("li"),
f=a.characterParameters.value;a.text(u,f.gold);for(var h=0,k=a.slice(l.getElementsByTagName("li"));h<k.length;h++)k[h].innerHTML="";h=0;for(var m=d.length;h<m;h++){var n=a.getFirstChild(d[h]);if(n)for(var q=0,r=b.length;q<r;q++){var t=b[q];if(n.getAttribute("label")===t.label){var v=document.createElement("div");for(k=0;k<p.length;k++)if(!p[k].getElementsByTagName("div").length&&/slot-skill/i.test(p[k].className)){v.className="item "+t.className;v.setAttribute("label",t.label);v.setAttribute("type",
t.type);p[k].appendChild(v);break}}}}b=a.characterSkills.value.get(a.oval.value.label);for(h=0;h<g.length;h++){g[h].innerHTML="";if(b[h]){var w=document.createElement("div");w.className="item "+b[h].className;w.setAttribute("type","active");g[h].appendChild(w);k=w.cloneNode(!0);k.setAttribute("label",b[h].label);a.addClass(k,"clone");q=document.createElement("div");q.className="time-span time-span-"+b[h].label;r=document.createElement("div");r.className="disable-skill";k.appendChild(q);k.appendChild(r);
c[h].innerHTML="";c[h].appendChild(k);q=0;for(r=b.length;q<r;q++)if(t=b[q],w.className.split(" ")[1]===t.className){w.innerHTML="";w.parentNode.setAttribute("drag","true");if(b[q].level>f.level||b[q].next&&!b[q].active||/wizard/i.test(b[q].caracterClass)&&!b[q].active)k=document.createElement("div"),divInner=document.createElement("div"),k.className="cover-up",divInner.className="cover-level",a.text(divInner,t.level),k.appendChild(divInner),w.innerHTML="",w.parentNode.setAttribute("drag","false"),
w.appendChild(k);w.setAttribute("label",t.label)}}g[h].style.opacity=w?1:0}},fetchLoot:function(c){var d=c?c.preventBagLocation:!1;if(c?c.updateSlot:1)this.attachMainPotions(),this.lootNeedClear();c=a.slotButtonHp.getElementsByTagName("div");for(var f=a.slotButtonMp.getElementsByTagName("div"),g=a.characterInventoryBag.value.get(a.oval.value.label),h=0;h<g.length;h++)for(var k=0;k<b.length;k++)if(b[k]&&g[h]){var l=a.slice(b[k].getElementsByTagName("div")),F=l.length&&g[h].label===l[0].getAttribute("label");
F&&(1<=g[h].quantity?a.text(l[1],g[h].quantity):0===g[h].quantity&&(a.nthParent(l[0],1).innerHTML="",g.splice(h,1)));g[h].indexBagLocation=k;if(F||c.length&&g[h].label===c[0].getAttribute("label")||f.length&&g[h].label===f[0].getAttribute("label"))break;k===b.length-1&&g[h].quantity&&this.createItem(g[h],d)}},markPotions:function(){var b=a.characterInventoryBag.value.get(a.oval.value.label);b.forEach(function(a){a.slotPotion&&delete a.slotPotion});for(var c=a.slotButtonHp.getElementsByTagName("div"),
d=a.slotButtonMp.getElementsByTagName("div"),f=0,g=!1,h=!1;f<b.length;f++)c.length&&!g&&b[f].label===c[0].getAttribute("label")?g=b[f].slotPotion=!0:d.length&&!h&&b[f].label===d[0].getAttribute("label")&&(h=b[f].slotPotion=!0)},attachMainPotions:function(b){var c=a.characterInventoryBag.value.get(a.oval.value.label),d=a.getFirstChild(a.slotButtonMp),f=a.getFirstChild(a.slotButtonHp);d=b?!1:d;b=b?!1:f;for(f=0;f<c.length;f++)/manapotion/i.test(c[f].name)&&c[f].slotPotion&&!d?(a.slotButtonMp.innerHTML=
"",this.createItem(c[f],"",a.slotButtonMp),T&&(ta.innerHTML="",this.createItem(c[f],"",ta)),d=!0):/healthpotion/i.test(c[f].name)&&c[f].slotPotion&&!b&&(a.slotButtonHp.innerHTML="",this.createItem(c[f],"",a.slotButtonHp),T&&(va.innerHTML="",this.createItem(c[f],"",va)),b=!0);for(f=0;f<c.length;f++)/manapotion/i.test(c[f].name)&&!d?(a.slotButtonMp.innerHTML="",this.createItem(c[f],"",a.slotButtonMp),T&&(ta.innerHTML="",this.createItem(c[f],"",ta)),d=!0):/healthpotion/i.test(c[f].name)&&!b&&(a.slotButtonHp.innerHTML=
"",this.createItem(c[f],"",a.slotButtonHp),T&&(va.innerHTML="",this.createItem(c[f],"",va)),b=!0);var g=a.slotButtonHp.getElementsByTagName("div"),h=a.slotButtonMp.getElementsByTagName("div");b=d=!1;for(f=0;f<c.length;f++){var k=c[f];g.length&&k.label===g[0].getAttribute("label")&&(d=!0);h.length&&k.label===h[0].getAttribute("label")&&(b=!0)}d||(T&&(va.innerHTML=""),a.slotButtonHp.innerHTML="");b||(T&&(ta.innerHTML=""),a.slotButtonMp.innerHTML="")},lootNeedClear:function(){for(var c=a.characterInventoryBag.value.get(a.oval.value.label),
d=a.slotButtonHp.getElementsByTagName("div"),f=a.slotButtonMp.getElementsByTagName("div"),g=0;g<b.length;g++){var h=a.slice(b[g].getElementsByTagName("div"));if(h.length){h=h[0].getAttribute("label");var k=b[g],l=!1;"slot-hp"!==k.id&&"slot-mp"!==k.id&&(d.length&&h===d[0].getAttribute("label")?k.innerHTML="":f.length&&h===f[0].getAttribute("label")&&(k.innerHTML=""));var m=0;a:for(;m<c.length;m++)if(h===c[m].label){l=!0;break a}l||(k.innerHTML="")}}this.fetchSkillOnload()},skillDetail:function(b){for(var c=
a.characterSkills.value.get(a.oval.value.label),d=a.items.value.skills,f=T?a.qs("innerwrap-info-skill-mb"):a.detailSkill,g=0;g<c.length;g++)if(c[g]&&c[g].label===b){if("undead"!==c[g].name){f.innerHTML="";var h;a:for(h in c[g])if(/displayName|mp|detail|next|upgradeClass|require/i.test(h)&&"className"!==h){var k=document.createElement("li"),l=document.createElement("span"),F=document.createElement("span"),n=d[c[g].upgradeProperty];if(n&&n.active&&/next|upgradeClass|require/i.test(h))continue a;if("require"===
h){var p="skill points : "+c[g][h].skillPoint+", Required Level  : "+c[g][h].level;a.text(l,h);a.text(F,p);k.appendChild(l);k.appendChild(F);p=document.createElement("li");l=document.createElement("abbr");a.text(l,"Unlock");p.className="upgrade-button";p.appendChild(l);w.upgrade(p,c[g].upgradeClass,b)}else if("upgradeClass"===h)l=document.createElement("div"),l.className="item "+c[g][h],k.className="box",k.appendChild(l);else{var q="mp"===h?m.lang.fn("gui","htmlGUI","mpNeed"):h;a.text(l,"displayName"===
q?"Name":q);a.text(F,c[g][h]);k.appendChild(l);k.appendChild(F)}f.appendChild(k);"require"===h&&n&&!n.active&&f.appendChild(p)}}break}},skillInfoDetail:function(b){var c=a.characterSkills.value.get(a.oval.value.label),d=a.detailInventory;if(/clone/i.test(b.className))return!1;for(var f=0,g=c.length;f<g;f++)if(c[f]&&c[f].label===b.getAttribute("label")){d.innerHTML="";for(g in c[f])/displayName|mp|detail/i.test(g)&&"className"!==g&&d.appendChild(this.createDetail(g,c[f][g]));T||(b=b.parentNode.getBoundingClientRect(),
a.css(a.qs("item-popup"),{top:b.top+"px",left:b.left+5+"px"}));break}},skillGUITriggered:function(){for(var b=function(b,c,d){for(var f=a.characterSkills.value.get(a.oval.value.label),g=a.characterParameters.value,h=0;h<f.length;h++)if(f[h].label===b&&f[h].state&&(/intimidation/i.test(f[h].name)||a.globalAnimation.value.monsterTarget)&&g.mp>f[h].mp){if(f[h].active&&g.level>=f[h].level&&!f[h].disable){f[h].firstLoad=!1;d=a.characterSkills.value.get("initial");d.label=b;d.state=!0;d.target=c[0];break}}else d||
f[h].label!==b||f[h].disable||a.globalAnimation.value.monsterTarget||!g.health||a.pushMsgText.value(m.lang.fn("gui","tapSkill","detail"),100)},c=0;c<d.length;c++)a.attachListener(d[c],"click",function(){var a=this.getElementsByTagName("div")||this.getElementsByTagName("li");if(a.length){var c=a[0].getAttribute("label");b(c,a)}});var f;a.attachListener(La,"click",function(){/on/i.test(this.className)?(a.removeClass(this,"auto-on"),a.addClass(this,"auto-off"),clearInterval(f)):(a.removeClass(this,"auto-off"),
a.addClass(this,"auto-on"),f=setInterval(function(){if(a.globalAnimation.value.characterControl.isAttacking)for(var c=0;c<d.length;c++){var f=d[c];f=f.getElementsByTagName("div")||f.getElementsByTagName("li");if(f.length){var g=f[0].getAttribute("label"),h=a.getLastChild(f[0]);/block/i.test(h.getAttribute("style"))||b(g,f,!0)}}},1E3))});var g=!0;a.attachListener(Ia,"click",function(b){b=a.characterMobileControl.value.charObj;a.addClass(this,"switch-on");a.removeClass(this,"switch-off");g&&b.switchCharacterAuto()?
(g=!1,setTimeout(function(){a.addClass(this,"switch-off");a.removeClass(this,"switch-on");g=!0}.bind(this),1E3)):(a.addClass(this,"switch-off"),a.removeClass(this,"switch-on"))})},createItem:function(c,d,f){var g=document.createElement("div");g.className="item "+c.className;g.setAttribute("label",c.label);var h=document.createElement("div");h.className=1<c.quantity?"item-number":"item-number hidden";a.text(h,c.quantity);g.appendChild(h);if(f)f.appendChild(g);else if(""===c.bagLocation||d)for(d=0;d<
b.length;d++){if(!b[d].getElementsByTagName("div").length){b[d].appendChild(g);c.indexBagLocation=R;break}}else a.id(c.bagLocation).appendChild(g)},createDetail:function(b,c,d){var f=function(a){return m.lang.fn("gui","charaGUI",a)};b="enchant"===b.toLowerCase()?"Required Material":b;if(c instanceof Object&&!(c instanceof Array)){if(/magic resistance/i.test(b)){var g="magicDefenseMin",h="magicDefenseMax";b=f("magicDef")}else/physical resistance/i.test(b)?(g="defenseMin",h="defenseMax",b=f("physicalDef")):
/range damage/i.test(b)?(g="attackRangeMin",h="attackRangeMax",b=f("rangeDmg")):/melee damage/i.test(b)?(g="attackMin",h="attackMax",b=f("meleeDmg")):"displayName"===b&&(b=f("name"));if(c.originalParams){f=c.originalParams[g];var k=Math.round(Math.round(c[g])-f),l=c.originalParams[h],n=Math.round(Math.round(c[h])-l)}else f=Math.round(c[g]),l=Math.round(c[h]);h=document.createElement("li");g=document.createElement("span");c=document.createElement("span");var p=document.createElement("abbr"),F=document.createElement("span"),
q=document.createElement("abbr");spanStrip=document.createElement("span");F.className=c.className="static bold";g.className="staticBlock";p.className=q.className=d.color?d.color:"light-blue";0>parseInt(k)?(d="-",k=Math.abs(k),n=Math.abs(n)):d="+";a.text(g,b);a.text(c,f);a.text(p," "+d+" "+k);a.text(F,l);a.text(q," "+d+" "+n);a.text(spanStrip," - ");parseInt(k)&&c.appendChild(p);parseInt(n)&&F.appendChild(q);parseInt(n)&&parseInt(n);h.appendChild(g);h.appendChild(c);h.appendChild(spanStrip);h.appendChild(F)}else h=
document.createElement("li"),g=document.createElement("span"),k=document.createElement("span"),n=c instanceof Array,k.className=n?"gold":"",c=n?c.join(", "):c,"Abilities "===b?(k.className=d.color?d.color:"light-blue",b=f("ability")):/name|displayName/i.test(b)?b=f("name"):"mp"===b?b=f("mpReq"):/attack range/i.test(b)?b=f("atkRange"):/health points/i.test(b)?b=f("hp"):/magic points/i.test(b)&&(b=f("hp")),a.text(g,b),a.text(k,c),h.appendChild(g),h.appendChild(k);return h},charDetail:function(b){var c=
b.params;T||(b.box.innerHTML="");b.box.appendChild(this.createDetail("Name ",c.name,b));b.box.appendChild(this.createDetail("Health Points ",c.health?c.health+" / "+c.maxHealth:c.maxHealth,b));b.box.appendChild(this.createDetail("Magic Points ",c.mp?c.maxMp?c.mp+" / "+c.maxMp:c.mp:c.maxMp,b));b.box.appendChild(this.createDetail("Attack Range ",c.range?c.range:c.attackRange,b));b.box.appendChild(this.createDetail("Melee Damage",c,b));b.box.appendChild(this.createDetail("Range Damage",c,b));b.box.appendChild(this.createDetail("Physical Resistance ",
c,b));b.box.appendChild(this.createDetail("Magic Resistance ",c,b));if(c.modifierAbilities){var d=[],f=function(a){return m.lang.fn("gui","charaGUI",a)},g;for(g in c.modifierAbilities)if(0<c.modifierAbilities[g])switch(g){case "stun":d.push(Math.round(c.modifierAbilities[g])+" % "+f("stun"));break;case "avoid":d.push(Math.round(c.modifierAbilities[g])+" % "+f("avoidance"));break;case "block":d.push(Math.round(c.modifierAbilities[g])+" % "+f("block"));break;case "critical":d.push(Math.round(c.modifierAbilities[g])+
" % "+f("critical"));break;case "criticalChance":d.push(Math.round(c.modifierAbilities[g])+" % "+f("criticalChance"))}d.length&&b.box.appendChild(this.createDetail("Abilities ",d.join(" ,  "),b))}c.monsterLevel&&b.box.appendChild(this.createDetail("Level ",c.monsterLevel,b));if(0<Object.keys(c.abilitySkill).length){d=document.createElement("li");f=document.createElement("span");a.text(f,m.lang.fn("gui","charaGUI","skillTalent")+" :");f.style.width="100%";d.appendChild(f);for(g in c.abilitySkill)c=
document.createElement("div"),c.className="m-level "+g,d.appendChild(c);b.box.appendChild(d)}},shopDetail:function(a){a.box.innerHTML="";for(var b=0,c=a.items;b<c.length;b++)if(c[b].label===a.label){for(var d in c[b])!/displayName|detail/i.test(d)&&"enchant"!==d||"className"===d||a.box.appendChild(this.createDetail(d,c[b][d]));return c[b]}},itemDetail:function(b){var c=a.characterInventoryBag.value.get(a.oval.value.label),d=T?L:a.detailInventory;d.innerHTML="";if(b)for(var f=0;f<c.length;f++)if(c[f]&&
c[f].label===b.getAttribute("label")){for(var g in c[f])!/displayName|name|detail/i.test(g)&&"enchant"!==g||"className"===g||c[f].displayName&&"name"===g||d.appendChild(this.createDetail(g,c[f][g]));T||(b=b.parentNode.getBoundingClientRect(),a.css(a.qs("item-popup"),{top:b.top+"px",left:b.left+"px"}));break}},guiToogle:function(){T&&/hidden/i.test(t.className)?(a.removeClass(t,"hidden"),this.GUImobile.firstLoad(),this.GUImobile.replaceSkills("detached"),a.playAudio("Inventory_Open_01")):/hidden/i.test(t.className)?
(a.removeClass(t,"hidden"),a.addClass(document.getElementsByTagName("header")[0],"hidden"),a.addClass(a.qs("nav-bottom-mobile"),"hidden"),a.playAudio("Inventory_Open_01")):(a.addClass(t,"hidden"),a.removeClass(document.getElementsByTagName("header")[0],"hidden"),a.removeClass(a.qs("nav-bottom-mobile"),"hidden"),a.playAudio("inventory-close"))},activeTab:function(b){var c=a.slice(a.qs("container-menu").getElementsByTagName("li"));a.playAudio("tab-selected");for(var d=0,f=c.length;d<f;d++){var g=a.getFirstChild(c[d]);
a.removeClass(g,"active-tab");g.className===b.className&&a.addClass(b,"active-tab")}},selectTab:function(b,c){var d=a.qs("gui-player"),f=[a.bagContainer,a.skillContainer,a.questContainer,a.controlContainer];this.fetchQuest();this.charDetail({params:a.characterParameters.value,box:L});/hidden/i.test(d.className)?a.removeClass(d,"hidden"):/hidden/i.test(b.className)||w.guiToogle();for(var g=0;g<f.length;g++)b===f[g]?(a.addClass(b,"active"),a.removeClass(b,"hidden")):(a.addClass(f[g],"hidden"),a.removeClass(f[g],
"active"));this.activeTab(c);a.removeClass(Ha,"expand");a.css(a.qs("hidden-menu"),{transform:"0px,0px,0px",transition:"transform 450ms ease-in-out"});/hidden/i.test(d.className)?(a.removeClass(document.getElementsByTagName("header")[0],"hidden"),a.removeClass(a.qs("nav-bottom-mobile"),"hidden"),window.scope.blockRender=!1):(a.addClass(document.getElementsByTagName("header")[0],"hidden"),a.addClass(a.qs("nav-bottom-mobile"),"hidden"));a.dragBar()},emptyBagLocation:function(b){for(var c=a.characterInventoryBag.value.get(a.oval.value.label),
d=0,f=c.length;d<f;d++)if(b===c[d].label){c[d].bagLocation="";break}},loadSaveGame:function(){var b=JSON.parse(n.getItem("saveGame"));for(c in b)b=document.createElement("li"),b.setAttribute("target",c),a.text(b,c),N.insertBefore(b,N.firstChild),cloneLi=b.cloneNode(!0),Z.insertBefore(cloneLi,Z.firstChild);var c=document.createElement("li");a.text(c,"SAVE NEW GAME");N.appendChild(c);c=N.getElementsByTagName("li");b=a.slice(c);for(c=0;c<b.length;c++)a.attachListener(b[c],"click",function(){a.playAudio("tab-selected");
var b=this.getAttribute("target");if(b){var c=A.getElementsByTagName("p")[0];a.text(c,"Save Game, "+b);a.removeClass(A,"hidden");A.setAttribute("target",b)}else/hidden/i.test(C.className)?a.removeClass(C,"hidden"):a.addClass(C,"hidden")});b=a.slice(Z.getElementsByTagName("li"));for(c=0;c<b.length;c++)a.attachListener(b[c],"click",function(){a.playAudio("tab-selected");var b=JSON.parse(n.getItem("saveGame"))[this.getAttribute("target")];n.setItem("load",a.JSONstringfy(b));location.reload()})},loadMenuSaveGame:function(){a.attachListener(E[1],
"click",function(){a.playAudio("tab-selected");a.addClass(D,"hidden")});a.attachListener(E[0],"click",function(){a.playAudio("tab-selected");w.saveNewGame(A.getAttribute("target"),!1,!0);a.addClass(D,"hidden")});a.attachListener(B[0],"click",function(){a.playAudio("tab-selected");var b=JSON.parse(n.getItem("saveGame"))[A.getAttribute("target")];n.setItem("load",a.JSONstringfy(b));location.reload()});a.attachListener(B[1],"click",function(){a.playAudio("tab-selected");a.removeClass(D,"hidden");a.addClass(A,
"hidden")});a.attachListener(B[2],"click",function(){a.playAudio("tab-selected");a.addClass(A,"hidden")});a.attachListener(da,"click",function(){a.playAudio("tab-selected");a.addClass(ca,"hidden")});a.attachListener(P[1],"click",function(){a.playAudio("tab-selected");a.addClass(C,"hidden")});a.attachListener(P[0],"click",function(){a.playAudio("tab-selected");var b=a.nthParent(this,2).getElementsByTagName("input")[0],c=a.encodeStr(b.value);c.length?w.saveNewGame(c,b):b.focus()})},saveNewGame:function(c,
d,f){var g=JSON.parse(n.getItem("saveGame"));if(g&&5>Object.keys(g).length||null===g||f){f=a.characterInventoryBag.value.get(a.oval.value.label);var k=a.characterSkills.value.get(a.oval.value.label);w.checkBagLocation(b,f,"bag");w.checkBagLocation(h,k,"skill");a.characterSkillDisable.value("enable");f=a.characterInventoryBag.value.get(a.oval.value.label);k=a.characterParameters.value;var l=a.characterQuest.value.storage,m=a.characterSkills.value.get(a.oval.value.label);activeMap=a.activeMap.value;
regMagicItem=a.registerMagicBoxItem.value.storage;itemShop=a.itemShop.value.get("global");forceGravity=a.oval.value.forceGravity;test=!0;pathPoint={userPoint:a.oval.value.position,map:activeMap};format={charPoints:pathPoint,charBag:f,charParams:k,charQuest:l,charForceGravity:forceGravity,regMagicItem:regMagicItem,charSkills:a.JSONstringfy(m),systemSkills:a.JSONstringfy(a.items.value.skills),itemShop:itemShop};a.addClass(C,"hidden");a.addClass(A,"hidden");f={};if(g){for(var p in g)if(p===c){g[p]=format;
test=!1;break}f[c]=format;test&&a.extend(g,f)}else g={},f[c]=format,a.extend(g,f);c=a.JSONstringfy(g);n.setItem("saveGame",c);N.innerHTML="";w.loadSaveGame()}else a.removeClass(ca,"hidden"),a.addClass(C,"hidden");d&&(d.value="")},installGlobalSaveGame:function(){var b=setInterval(function(){a.globalSaveLoad.value&&(a.globalSaveLoad.value=function(){w.charDetail({params:a.characterParameters.value,box:L});w.fetchLoot();w.fetchSkill();w.fetchSkillOnload()},a.globalSaveGame.value=w.saveNewGame,clearInterval(b))},
100)},checkLoadGame:function(){var b=n.getItem("load");if(b){var c=JSON.parse(b);var d=setInterval(function(){a.globalLoadGame.value&&(a.globalLoadGame.value(c.charPoints.map,c),n.removeItem("load"),clearInterval(d))},100)}else a.removeClass(a.qs("loading-ui"),"hidden"),a.addClass(a.qs("loading-assets"),"hidden")},checkBagLocation:function(c,d,f){c="default"==c?b:c;for(var g=0;g<d.length;g++)"bag"===f?d[g].bagLocation="":d[g].slotLocation="";for(var h=0;h<c.length;h++){var k=a.getFirstChild(c[h]);
if(k.getAttribute){var l=k.getAttribute("label");if(l)for(g=0;g<d.length;g++)if(l===d[g].label){"bag"===f?d[g].bagLocation=k.parentNode.id:d[g].slotLocation=k.parentNode.id;break}}}},GUImobile:{isFirstLoad:!1,heightInventory:0,transformInventory:0,itemWWHH:{inventory:0,skill:0},previousItem:"",firstLoad:function(){this.layoutMobile();this.hideItemCntOverflow("hidden");this.isFirstLoad||(this.tabsInventory(),this.tabsMainGUI(),this.tabsControl(),this.isFirstLoad=!0)},hideItemCntOverflow:function(b){for(var c=
a.qs("items-bag-mb").getBoundingClientRect(),d=0,f=itemsBag.length;d<f;d++)if("hidden"===b){var g=itemsBag[d].getBoundingClientRect();itemsBag[d].style.opacity=c.bottom<g.bottom||g.top+5<c.top?0:1}else itemsBag[d].style.opacity=1},replaceSkills:function(b){var c=a.slice(a.qs("items-slot-skill-mb").getElementsByTagName("li")),d=a.slice(a.qsAll("slot-mb")),f=function(a,b){for(var c=0,d=a.length;c<d;c++){var f=a[c].getElementsByTagName("div"),g=a[c].getAttribute("att");if(f.length)for(var h=0,k=b.length;h<
k;h++){var l=b[h].getAttribute("att");if(g===l){f[0].setAttribute("style","");b[h].appendChild(f[0]);break}}}};"attach"===b?f(d,c):f(c,d)},replacePotions:function(b){var c=va.getElementsByTagName("div"),d=ta.getElementsByTagName("div"),f=a.slotButtonHp.getElementsByTagName("div"),g=a.slotButtonMp.getElementsByTagName("div");"attach"===b?(c.length&&(a.slotButtonHp.appendChild(c[0]),w.markPotions()),d.length&&(a.slotButtonMp.appendChild(d[0]),w.markPotions())):(f.length&&va.appendChild(f[0]),g.length&&
ta.appendChild(g[0]))},infoItemToogle:function(b,c){"char"===b?(a.removeClass(a.qs("item-info-detail"),"active"),a.addClass(a.qs("chara-info-detail"),"active"),w.charDetail({params:a.characterParameters.value,box:L})):(a.removeClass(a.qs("chara-info-detail"),"active"),a.addClass(a.qs("item-info-detail"),"active"),w.itemDetail(c),this.previousItem=c)},layoutMobile:function(){var b=a.qs("items-bag-mb").offsetHeight;a.css(a.qs("items-bag-mb"),{width:b+"px"});var c=a.qs("items-bag-mb").offsetHeight/5;
a.css(a.qs("items-equipment-mb"),{width:c+"px"});a.css(a.qs("items-hidden-potion-mb"),{width:c+"px",height:b+"px","margin-left":-(c+30)+"px"});var d=a.qs("cnt-bag-mb").offsetWidth-b-c-35;a.css(a.qs("items-info-mb"),{width:d+"px"});b=a.qs("items-skill-mb").offsetHeight;d=b/5;a.css(a.qs("items-skill-mb"),{width:b-d+"px"});var f=a.qs("items-skill-mb").getElementsByTagName("li");b=f[0].offsetWidth;for(var g=0;g<f.length;g++)a.css(f[g],{height:b-2+"px"});f=a.qs("items-slot-skill-mb").getElementsByTagName("li");
var h=a.qs("items-slot-skill-mb").getElementsByTagName("ul")[0];a.css(a.qs("items-slot-skill-mb"),{width:2*(b-2)+4+"px"});for(g=0;g<f.length;g++)a.css(f[g],{width:b-2+"px",height:b-2+"px"});a.css(h,{"margin-top":d+"px"});d=a.qs("cnt-skill-mb").offsetWidth-a.qs("items-skill-mb").offsetWidth-a.qs("items-slot-skill-mb").offsetWidth-35;a.css(a.qs("items-info-skill-mb"),{width:d+"px"});d=a.qs("items-quest-mb").offsetHeight;a.css(a.qs("items-quest-mb"),{width:d+"px"});d=a.qs("cnt-quest-mb").offsetWidth-
a.qs("items-quest-mb").offsetWidth-15;a.css(a.qs("items-info-quest-mb"),{width:d+"px","margin-left":"15px"});d=a.qs("items-control-mb").offsetHeight;a.css(a.qs("items-control-mb"),{width:d-d/4+"px"});d=a.qs("cnt-control-mb").offsetWidth-a.qs("items-control-mb").offsetWidth-15;a.css(a.qs("items-info-control-mb"),{width:d+"px","margin-left":"15px"});this.heightInventory=5*a.id("slot-a-mb").offsetHeight;this.transformInventory=-(c+30);this.itemWWHH.inventory=c;this.itemWWHH.skill=b-2},tabsInventory:function(){a.attachListener(a.qs("chara-info-detail"),
"click",function(){a.playAudio("tab-selected");L.innerHTML="";this.infoItemToogle("char")}.bind(this));a.attachListener(a.qs("item-info-detail"),"click",function(){a.playAudio("tab-selected");L.innerHTML="";this.infoItemToogle("item",this.previousItem)}.bind(this))},tabsMainGUI:function(){for(var b=a.slice(a.qs("container-menu-mb").getElementsByTagName("li")),c=b.splice(0,4),d=a.slice(document.querySelectorAll(".tab-list-content-mb > li")),f=0;f<c.length;f++)a.attachListener([c[f],ia[f+1]],"click",
function(b,f){a.removeClass(t,"hidden");for(var g=0;g<c.length;g++)a.removeClass(c[g],"active-tab-mb"),a.removeClass(d[g],"active-detail-mb");a.addClass(b,"active-tab-mb");a.addClass(d[f],"active-detail-mb");this.layoutMobile();this.replaceSkills("attach");a.scrollSlideParams.fn();w.fetchQuest();a.dragBar();a.removeClass(Ha,"expand");a.css(a.qs("hidden-menu"),{transform:"0px,0px,0px",transition:"transform 450ms ease-in-out"});a.playAudio("tab-selected")}.bind(this,c[f],f));a.attachListener(b[0],"click",
function(){a.addClass(a.qs("gui-player-mb"),"hidden");this.replaceSkills("detached");a.playAudio("inventory-close");window.scope.blockRender=!1}.bind(this))},tabsControl:function(){for(var b=a.slice(a.qs("items-control-mb").getElementsByTagName("li")),c=0,d=b.length;c<d;c++)a.attachListener(b[c],"click",function(b,c){for(var d=0,f=b.length;d<f;d++)a.removeClass(b[d],"active");a.addClass(a.qs("tab-performance-mb"),"hidden");a.addClass(a.qs("tab-save-game-mb"),"hidden");a.addClass(a.qs("tab-volume-mb"),
"hidden");a.addClass(a.qs("tab-information-mb"),"hidden");a.addClass(a.qs("tab-kontribusi-mb"),"hidden");0===c?(a.removeClass(a.qs("tab-performance-mb"),"hidden"),a.addClass(b[c],"active")):1===c?(a.removeClass(a.qs("tab-volume-mb"),"hidden"),a.addClass(b[c],"active")):2===c?(a.removeClass(a.qs("tab-information-mb"),"hidden"),a.addClass(b[c],"active")):3===c?(a.removeClass(a.qs("tab-kontribusi-mb"),"hidden"),a.addClass(b[c],"active")):4===c?(a.removeClass(a.qs("tab-save-game-mb"),"hidden"),a.addClass(b[c],
"active")):a.removeClass(a.qs("exit-alert"),"hidden")}.bind(this,b,c))}},GUITowerDef:function(){var b=a.qs("gui-tower-def"),c=a.qs("info-remaining"),d=a.qs("quest-remaining"),f=a.qs("enemy-remaining"),g=a.qs("remaining-box"),h=a.qs("remaining-box").getElementsByTagName("button")[0],k=a.qs("remaining-content"),l="",p=a.qs("menu-profile"),q=a.qs("cnt-hero"),r=a.qs("cnt-map"),t="mapDungeonH",u=a.qs("cnt-villant"),v=a.qs("cnt-profile"),w=a.qs("cnt-profile-detail"),A=a.qs("cnt-profile-pop-up"),B=a.qs("cnt-skill-detail"),
C=a.qs("box-hero"),D=a.qs("ul-villant"),E=a.qs("box-profile"),G=a.qs("box-profile-detail"),H=a.qs("box-profile-pop-up"),I=a.qs("box-skill-detail "),J=function(a){return a.initArmored?a.initArmored:a.initArhcer?a.initArhcer:a.initMage?a.initMage:a.initSpear?a.initSpear:a.initStatic},K=function(b,c){b.querySelectorAll(".button-next").forEach(function(d){a.attachListener(d,"click",function(){a.playAudio("tab-selected");a.removeClass(b,"hide-previous");a.removeClass(b,"show-previous");a.removeClass(b,
"show-next");a.addClass(b,"hide-next");setTimeout(function(){a.addClass(b,"hidden");a.removeClass(b,"hide-next");a.removeClass(c,"hidden");setTimeout(function(){a.addClass(c,"show-next")},20)},350)})})},L=function(b,c){b.querySelectorAll(".button-previous").forEach(function(d){a.attachListener(d,"click",function(){a.playAudio("tab-selected");a.removeClass(b,"hide-next");a.removeClass(b,"show-next");a.removeClass(b,"show-previous");a.addClass(b,"hide-previous");setTimeout(function(){a.addClass(b,"hidden");
a.removeClass(b,"hide-previous");a.removeClass(c,"hidden");setTimeout(function(){a.addClass(c,"show-previous")},20)},350)})})},N=function(b,c,d){var f=a.qs("gui-tower-def ").getBoundingClientRect();b=b.getBoundingClientRect();a.removeClass(c,"hidden");a.addClass(c,"show-menu");var g=c.getBoundingClientRect();b.left+g.width<f.right?a.css(c,{"margin-left":b.left+b.width+"px"}):a.css(c,{"margin-left":b.left-g.width+"px"});if(g.left<f.left||g.right>f.right)g.right>f.right?a.css(c,{"margin-left":b.left-
g.width+"px"}):g.left<f.left&&a.css(c,{"margin-left":b.left+b.width+"px"});d&&d()},P=function(b,c){a.removeClass(b,"gui-hidden");a.removeClass(b,"hidden");a.addClass(b,"show-menu");c&&c()},M=function(b){var c=a.globalAnimation.value.monsterControl,d=0;k.innerHTML="";remainingText="enemy"===b?m.lang.fn("gui","htmlGUI","enemyText"):m.lang.fn("gui","htmlGUI","towText");var f=0;for(c=c.objSpawnMonster;f<c.length;f++)c[f].forEach(function(c){var f=document.createElement("li"),g=document.createElement("div"),
h=document.createElement("div"),l="undefined"!==typeof c.freeze?c.freeze:!1;g.className=c.avatarClass;h.className="spawn-overflow";f.appendChild(g);addOverflow=!0;c.currentRespawn&&c.currentRespawn>=c.respawnLimit&&0===c.monsters.length&&!l&&(addOverflow=!1);"enemy"!==b||/hero|tower/i.test(c.initialSpawn)?"tower"===b&&/tower/i.test(c.initialSpawn)&&(addOverflow&&d++,!addOverflow&&f.appendChild(h),k.appendChild(f),a.text(a.qs("num-tower"),d)):(addOverflow&&d++,!addOverflow&&f.appendChild(h),k.appendChild(f),
a.text(a.qs("num-enemy"),d))});a.text(a.qs("msg-remaining"),d+remainingText)};a.attachListener(h,"click",function(){a.playAudio("tab-selected");"reload"===this.getAttribute("init")?location.reload():a.addClass(g,"hidden");window.scope.blockRender=!1});a.attachListener(f,"click",function(){a.playAudio("tab-selected");a.addClass(f,"hidden");a.removeClass(g,"hidden");l=this.getAttribute("label");M(l);a.removeClass(a.qs("eliminate-box"),m.lang.fn("gui","bgPop","towersLeft"));a.addClass(a.qs("eliminate-box"),
m.lang.fn("gui","bgPop","enemiesLeft"));window.scope.blockRender=!0});a.attachListener(d,"click",function(){a.playAudio("tab-selected");a.addClass(d,"hidden");a.removeClass(g,"hidden");l=this.getAttribute("label");M(l);a.removeClass(a.qs("eliminate-box"),m.lang.fn("gui","bgPop","enemiesLeft"));a.addClass(a.qs("eliminate-box"),m.lang.fn("gui","bgPop","towersLeft"));window.scope.blockRender=!0});a.attachListener(c,"click",function(){a.playAudio("tab-selected");a.removeClass(f,"hidden");a.removeClass(d,
"hidden");a.removeClass(c,"show");M("enemy");M("tower");setTimeout(function(){a.addClass(f,"show");a.addClass(d,"show");a.addClass(c,"hidden");setTimeout(function(){a.removeClass(f,"show");a.removeClass(d,"show");a.removeClass(c,"hidden");a.addClass(c,"show");setTimeout(function(){a.addClass(d,"hidden");a.addClass(f,"hidden")},200)},5E3)},200)});var Q=!1,S;for(S in m.NPC){var R=m.NPC[S];if(!/spawn/i.test(S)){var W=document.createElement("li"),Y=document.createElement("div"),Z=document.createElement("div");
W.setAttribute("label",S);h=function(b){var c=Y.cloneNode(!0),d=Z.cloneNode(!0),f=W.cloneNode(!0);c.className=ba?ba:"girl-armored";f.appendChild(c);R[V].npcType&&(/character/i.test(R[V].npcType)?(c=b?b:"HERO",d.className="selected red"):/tower/i.test(R[V].npcType)?(c="TOWER",d.className="selected blue"):(c="LEADER",d.className="selected orange"),"LEADER"!==b||Q||(a.addClass(d,"hidden"),Q=!0),a.text(d,c),f.appendChild(d));return f};for(var V in R){var ba=R[V].avatarClass;R[V].label=S;"character"===
R[V].npcType&&C.appendChild(h("LEADER"));E.appendChild(h())}}}v.querySelectorAll("li").forEach(function(b,c,d){a.attachListener(b,"click",function(){var b=this,c=a.slice(G.querySelectorAll("li")),d=function(a){return m.lang.fn("gui","charaGUI",a)};a.playAudio("tab-selected");N(b,w,function(){a:for(k in m.NPC){var f=m.NPC[k],g=function(b,c,f){var g=document.createElement("div"),h=a.getFirstChild(b);a.getLastChild(b).remove();if("modifier"===c){a.addClass(b,"hidden");h.style.width="100%";for(var k in f)if(0<
f[k]){switch(k){case "stun":name=f[k]+"% "+d("stun");break;case "avoid":name=f[k]+"% "+d("avoidance");break;case "block":name=f[k]+"% "+d("block");break;case "critical":name=f[k]+"% "+d("critical");break;case "criticalChance":name=f[k]+"%  "+d("criticalChance");break;default:name=k}c=document.createElement("div");a.text(c,name);g.appendChild(c);a.removeClass(b,"hidden")}}else if("m-level"===c)f?a.removeClass(b,"hidden"):a.addClass(b,"hidden"),h.style.width="100%",b.style.border="none",c=document.createElement("div"),
c.className="m-level cyan",a.text(c,f),g.appendChild(c),a.attachListener(c,"click",function(){a.playAudio("tab-selected");var b=I.getElementsByTagName("li")[0];P(B,function(){a.text(a.getFirstChild(b),"Tingkat Kemampuan Musuh");a.text(a.getLastChild(b),"Musuh memiliki Tingak Kesulitan ( "+f+" ), diurutkan dari tingakatan terlemah hingga terkuat. E, D, C, B, A, S")})});else if("skill"===c)for(k in a.addClass(b,"hidden"),h.style.width="100%",f)c=document.createElement("div"),c.className="m-level "+
k,g.appendChild(c),a.removeClass(b,"hidden"),a.attachListener(c,"click",function(b){a.playAudio("tab-selected");var c=I.getElementsByTagName("li")[0];P(B,function(){a.text(a.getFirstChild(c),m.lang.fn("gui","charaGUI","skillTalent")+m.lang.fn("skill",b,"displayName"));a.text(a.getLastChild(c),m.lang.fn("skill",b,"detail"))})}.bind({},k));else a.text(g,c);b.appendChild(g)};if(!/spawn/i.test(k))for(var h in f)if(b.getAttribute("label")===f[h].label){var k=f[h];g(c[0],k.name);g(c[1],k.maxHealth);g(c[2],
k.mp);g(c[3],k.attackRangeMin+" - "+k.attackRangeMax);g(c[4],k.attackMin+" - "+k.attackMax);g(c[5],k.defenseMin+" - "+k.defenseMax);g(c[6],k.magicDefenseMin+" - "+k.magicDefenseMax);g(c[7],"modifier",k.modifierAbilities);g(c[8],"skill",k.abilitySkill,k.monsterLevel);g(c[9],"m-level",k.monsterLevel);break a}}})})});var X=!0;a.attachListener(p,"click",function(){a.playAudio("tab-selected");/show-menu/i.test(v.className)&&X?(a.removeClass(v,"show-menu"),a.removeClass(w,"show-menu"),a.removeClass(A,"show-menu"),
X=!1,a.removeClass(p,"menuclose"),setTimeout(function(){a.addClass(v,"hidden");a.addClass(w,"hidden");a.addClass(A,"hidden");X=!0},350),b.querySelectorAll(".cnt-tower-def").forEach(function(b){/cnt-profile/i.test(b.className)||a.removeClass(b,"gui-hidden")})):X&&(a.removeClass(v,"hidden"),a.removeClass(A,"show-menu"),X=!1,setTimeout(function(){a.addClass(v,"show-menu");a.addClass(A,"hidden");X=!0;a.addClass(p,"menuclose")},50),b.querySelectorAll(".cnt-tower-def").forEach(function(b){/cnt-profile/i.test(b.className)||
a.addClass(b,"gui-hidden")}))});q.querySelectorAll("li").forEach(function(b,c){a.attachListener(b,"click",function(){a.playAudio("tab-selected");var d=a.sibling(this,c?"previous":"next"),f=a.sibling(a.getFirstChild(b),"next");d=a.sibling(a.getFirstChild(d),"next");a.removeClass(f,"hidden");a.addClass(d,"hidden")})});K(q,r);L(r,q);r.querySelectorAll("li").forEach(function(b,c,d){a.attachListener(b,"click",function(){var b=a.getFirstChild(this);a.playAudio("tab-selected");d.forEach(function(b){a.removeClass(a.getFirstChild(b),
"red")});a.addClass(b,"red");t=this.getAttribute("label")})});K(r,u);L(u,r);var U=[],aa=function(b){U.length=0;for(var c in m.NPC)if(!/spawn/i.test(c)){var d=J(m.NPC[c]),f={},g;for(g in d.spawn)var h=d.spawn[g];if("monster-leader"===d.npcType){for(var k=0;k<h.length;k++)if(h[0].pions){var l=[];for(k in h[0].pions)l.push(J(m.NPC[k]));f.pions=l;break}U.push(f);f.leader=d}}U=a.randomArray(U);fnCreateVillant=function(b){var c=document.createElement("li"),d=document.createElement("ul"),f=function(b,c){var d=
document.createElement("li"),f=document.createElement("div"),g=document.createElement("div");f.className=b?b:"girl-armored";d.appendChild(f);"leader"===c?(g.className="selected orange",a.text(g,"LEADER"),d.appendChild(g)):d.className="child-villant";return d};d.className="box-villant list-inline";var g=f(b.leader.avatarClass,"leader");c.setAttribute("label",b.leader.label);d.appendChild(g);b.pions&&b.pions.forEach(function(a){d.appendChild(f(a.avatarClass,"pawns"))});return{parent:c,content:d}};D.innerHTML=
"";var n=0;c=function(a){for(var c=0;c<U.length;c++){var d=U[c],f=function(){n++;var a=fnCreateVillant(d);a.parent.appendChild(a.content);D.appendChild(a.parent)};if("hard"===b){if("hig"===a&&/s/i.test(d.leader.monsterLevel)&&(f(),1<n))break;if("midhig"===a&&/a/i.test(d.leader.monsterLevel)&&(f(),3<n))break;if("mid"===a&&/b/i.test(d.leader.monsterLevel)&&(f(),5<n))break;if("low"===a&&/c|e|d/i.test(d.leader.monsterLevel)&&(f(),7<n))break}else if("normal"===b){if("hig"===a&&/s/i.test(d.leader.monsterLevel)&&
(f(),0<n))break;if("midhig"===a&&/a/i.test(d.leader.monsterLevel)&&(f(),1<n))break;if("mid"===a&&/b/i.test(d.leader.monsterLevel)&&(f(),3<n))break;if("low"===a&&/c|d|e/i.test(d.leader.monsterLevel)&&(f(),6<n))break}else if("easy"===b){if("hig"===a&&/a/i.test(d.leader.monsterLevel)&&(f(),0<n))break;if("midhig"===a&&/b/i.test(d.leader.monsterLevel)&&(f(),2<n))break;if("mid"===a&&/c/i.test(d.leader.monsterLevel)&&(f(),3<n))break;if("low"===a&&/e|d/i.test(d.leader.monsterLevel)&&(f(),5<n))break}}};c("hig");
c("midhig");c("mid");c("low");var p="";u.querySelectorAll(" .ul-villant > li").forEach(function(b,c,d){a.attachListener(b,"click",function(){a.playAudio("tab-selected");p=this;N(this,A,function(){var b=u.getBoundingClientRect();a.css(A,{"margin-top":"0px",top:b.top+"px",height:b.height-6+"px"})})})});H.innerHTML="";U.forEach(function(b){var c=document.createElement("li"),d=document.createElement("div");d.className=b.leader?b.leader.avatarClass:"girl-armored";c.className="child-villant";c.appendChild(d);
H.appendChild(c);a.attachListener(c,"click",function(){a.playAudio("tab-selected");if(p){var c=fnCreateVillant(b);p.setAttribute("label",c.parent.getAttribute("label"));p.innerHTML="";p.appendChild(c.content)}})})};aa("easy");window.scope.gameLevel="easy";u.querySelectorAll(".button-random-mid").forEach(function(b){a.attachListener(b,"click",function(){a.playAudio("tab-selected");window.scope.gameLevel="normal";aa("normal")})});u.querySelectorAll(".button-random-hig").forEach(function(b){a.attachListener(b,
"click",function(){a.playAudio("tab-selected");window.scope.gameLevel="medium";aa("hard")})});u.querySelectorAll(".button-random-eas").forEach(function(b){a.attachListener(b,"click",function(){a.playAudio("tab-selected");window.scope.gameLevel="easy";aa("easy")})});u.querySelectorAll(".button-start").forEach(function(c){a.attachListener(c,"click",function(){var c=this;a.removeClass(c.parentNode,"show-menu");a.playAudio("tab-selected");a.delayFire(function(){a.addClass(c.parentNode,"hidden");a.addClass(b,
"hidden");var d=function(b){var c=J(b.npcProperty);"hero"===b.init&&(c.hero=!0);for(var d in c.spawn)if(b.clear)b.parent[d]=[];else{if("villant"===b.init)if(b.parent[d]){var f=c.spawn[d][0],g={monsters:[],name:f.name,objectSpawn:f.objectSpawn,spawnTotal:f.spawnTotal,reSpawnTick:f.reSpawnTick,reSpawnTickFixed:f.reSpawnTickFixed,respawnLimit:f.respawnLimit,monsterLevel:f.monsterLevel,install:!1,location:""};f.pions&&(g.pions=f.pions);b.parent[d].push(g)}else b.parent[d]=c.spawn[d],b.parent[d][0].monsterLevel=
c.monsterLevel,b.parent[d][0].name=c.name;else/tower|hero/i.test(b.init)&&(f=c.spawn[d][t],b.parent[d]=f?f:[]);b.parent[d].forEach(function(f){f.initialSpawn=d.split("Spawn").join("");f.avatarClass=c.avatarClass;var g=a.staticAllMap.value[t].content.staticSpawnLabel;/hero|tower/i.test(b.init)||(f.objectSpawn=g[a.random(g.length-1,0)]);f.location=t;"villant"===b.init&&(f.freeze=!0)})}},f=function(a,b){var c=m.frame.data;!m.frame[t]&&(m.frame[t]=[]);if("spawn"===b){var d=a.split("monsters").join("");
d=d.split("Spawn").join("")}else d=a.split("monster").join("");d=d.charAt(0).toLowerCase()+d.slice(1);m.frame[t].push(c[d])};C.querySelectorAll("li").forEach(function(a){a.getElementsByClassName("hidden")[0]?d({init:"",npcProperty:m.NPC[a.getAttribute("label")],parent:m.NPC,clear:!0}):d({init:"hero",npcProperty:m.NPC[a.getAttribute("label")],parent:m.NPC});f(a.getAttribute("label"))});b.querySelectorAll(".ul-villant > li").forEach(function(a){d({init:"villant",npcProperty:m.NPC[a.getAttribute("label")],
parent:m.NPC})});for(var g=["monsterTowerBlue","monsterTowerRed","monsterTowerRedb"];g.length;){var h=g.pop();f(h);d({init:"tower",npcProperty:m.NPC[h],parent:m.NPC})}U.forEach(function(a){var b=a.leader;a=a.pions;for(var c in b.spawn)m.NPC[c]||(m.NPC[c]=[]),f(c,"spawn");a&&a.forEach(function(a){for(var b in a.spawn)m.NPC[b]||(m.NPC[b]=[]),f(b,"spawn")})});a.globalLoadGame.value(t);a.globalAnimation.value.monsterControl.compile(m.NPC,t);a.addClass(a.qs("loading-ui"),"hidden")},1E3)})});b.querySelectorAll(".menu-close").forEach(function(b){a.attachListener(b,
"click",function(){a.playAudio("tab-selected");var b=this;a.removeClass(b.parentNode,"show-menu");setTimeout(function(){a.addClass(b.parentNode,"hidden")},350)})});T&&(a.qs("tab-performance-mb").appendChild(a.getFirstChild(a.qs("performance-detail"))),a.qs("tab-volume-mb").appendChild(a.getFirstChild(a.qs("sound-detail"))),a.qs("tab-information-mb").appendChild(a.getFirstChild(a.qs("information-detail"))),a.qs("tab-kontribusi-mb").appendChild(a.getFirstChild(a.qs("contribution-detail"))));n.getItem("goldHero")||
(a.updateGoldtoLocalStorageHero.value(3E4,{label:"heroArmor"}),a.updateGoldtoLocalStorageHero.value(3E4,{label:"heroArcher"}))},initShop:function(){var b=this,c=a.qs("shop-detail"),d=a.qs("shop-detail-item"),f={selected:{charaterParams:a.characterParameters.value,characterLoot:a.characterInventoryBag.value.get(a.oval.value.label),attach:!1,item:"",current:1,itemParams:"",initialTimeOut:"",initialTimeInverval:"",reset:function(){this.itemParams=this.item="";this.current=1}},objectItems:[],items:a.itemShop.value.get("global"),
displayBuyProperties:function(b,c){document.createElement("li");var d=document.createElement("div"),g=document.createElement("abbr"),h=a.qs("buy-item-content"),k=a.qs("buy-title"),l=a.qs("buy-text"),n=a.qs("price-display");c=f.selected;a.text(g," GOLD "+c.charaterParams.gold);a.text(k,b.displayName);a.text(l,b.shop.price+" x 1");d.className="item "+b.className;d.setAttribute("label",b.label);g.className="gold";k.appendChild(g);h.innerHTML="";h.appendChild(d);c.itemParams=b;a.text(n,b.shop.price*c.current);
if(!c.attach){c.attach=!0;d=a.qs("buy-button-plus");g=a.qs("buy-button-min");h=a.qs("buy-button-confirm");var p=function(b){var d=c.itemParams;d.shop&&c.current<d.shop.max&&d.shop.price*(c.current+1)<c.charaterParams.gold&&c.current++;a.text(l,d.shop.price+" x "+c.current);a.text(n,d.shop.price*c.current);a.css(b,{"background-size":"30%"})},q=function(b){var d=c.itemParams;1<c.current&&c.current--;a.text(l,d.shop.price+" x "+c.current);a.text(n,d.shop.price*c.current);a.css(b,{"background-size":"30%"})};
a.attachListener(h,"click",function(){var b=c.itemParams,d=b.shop.price*c.current,g=f.items[b.shop.itemName],h=!0;switch(b.itemfor){case "leader":h=a.globalAnimation.value.characterControl.bossObject.label===c.charaterParams.object.label;!h&&a.pushMsgText.value(m.lang.fn("gui","itemLeader","detail"),100);break;case "archer":h="archer"===c.charaterParams.classType,!h&&a.pushMsgText.value(m.lang.fn("gui","itemRanger","detail"),100)}h&&(d<=c.charaterParams.gold?(c.charaterParams.gold-=d,c.characterLoot.push(new a.items.value[b.shop.root][b.shop.itemName]({quantity:c.current})),
"~"!==g.available&&f.items[b.shop.itemName].available--,a.pushMsgText.value("+"+c.current+" "+b.displayName+m.lang.fn("gui","addItemToInvt","detail")+c.charaterParams.name,100),w.attachMainPotions({updateSlot:!0}),a.updateGoldtoLocalStorageHero.value(c.charaterParams.gold,c.charaterParams.object)):a.pushMsgText.value(m.lang.fn("gui","notEnoughGold","detail"),100));a.addClass(ba,"hidden");a.addClass(ha,"hidden");a.playAudio("tab-selected");c.reset();window.scope.blockRender=!1});a.attachListener([d,
g],a.CursorStartEvent,function(){var a=this,b=/buy-button-plus/i.test(a.className)?p:q;clearTimeout(c.initialTimeOut);clearInterval(c.initialTimeInverval);c.initialTimeOut=setTimeout(function(){c.initialTimeInverval=setInterval(function(){b(a)},10)},1E3);b(a)});a.attachListener([d,g],a.CursorEndEvent,function(){clearTimeout(c.initialTimeOut);clearInterval(c.initialTimeInverval);a.css(this,{"background-size":"35%"})})}},createItem:function(b){var c=document.createElement("li"),d=document.createElement("div"),
f=document.createElement("span"),g=new a.items.value[b.root][b.itemName],h=g.className;b.shopParams.itemName=b.itemName;a.extend(g,{shop:b.shopParams},!0);d.setAttribute("label",g.label);d.className="item "+h;f.className="price";a.text(f,b.price);c.appendChild(d);c.appendChild(f);this.objectItems.push(g);return c},generateItems:function(){for(var a in this.items){var b=this.items[a];b.available&&(b=this.createItem({price:b.price,root:b.root,itemName:a,shopParams:b}),this.attachEvent(b),c.appendChild(b))}},
attachEvent:function(c){var g="",h=c.getElementsByTagName("div")[0],k=function(){a.removeClass(d,"hidden");var h=a.getFirstChild(c),k=c.getBoundingClientRect(),l=a.mousePosition.value.pos.mousedown.x,m=a.getFirstChild(ba).getBoundingClientRect(),n=d.getBoundingClientRect(),p=m.left+m.width/2;d.setAttribute("style","");k.right>p?a.css(d,{left:(T?k.left:l)-(T?n.width:m.left+n.width+k.width/2)+"px","border-right":"2px solid rgba( 0, 0, 0, 0.33 )","text-align":"right",position:"fixed"}):a.css(d,{left:(T?
k.left:l)+k.width-m.left-(T?0:k.width/2)+"px","border-left":"2px solid rgba( 0, 0, 0, 0.33 )","text-align":"left",position:"fixed"});g=b.shopDetail({box:d,items:f.objectItems,label:h.getAttribute("label")})};a.attachListener(h,a.CursorStartEvent,k);a.attachListener(h,a.CursorMoveEvent,k);a.attachListener(h,a.CursorLeaveEvent,function(b){a.addClass(d,"hidden")});a.attachListener(h,a.CursorEndEvent,function(b){f.displayBuyProperties(g);a.removeClass(ha,"hidden")});a.attachListener(ba,a.CursorEndEvent,
function(b){a.addClass(d,"hidden")})}};a.attachListener(ka,"click",function(b){f.items=a.itemShop.value.get("global");f.selected.charaterParams=a.characterParameters.value;f.selected.characterLoot=a.characterInventoryBag.value.get(a.oval.value.label);c.innerHTML="";f.generateItems();a.removeClass(ba,"hidden");a.playAudio("tab-selected");window.scope.blockRender=!0});a.attachListener(fa,"click",function(b){a.addClass(ba,"hidden");a.playAudio("tab-selected");window.scope.blockRender=!1});a.attachListener(ua,
"click",function(b){a.addClass(ha,"hidden");a.playAudio("tab-selected");f.selected.reset()})},initMiningControl:function(){var b=a.slice(a.qs("mining-content").getElementsByTagName("li")),c=a.qs("ads-box"),d=a.qs("ads-title"),f=a.qs("ms-box"),g=!1;a.attachListener(ma,"click",function(){a.playAudio("tab-selected");/hidden/i.test(U.className)?a.removeClass(U,"hidden"):a.addClass(U,"hidden");window.scope.blockRender=!0});a.attachListener(na,"click",function(b){a.addClass(U,"hidden");a.playAudio("tab-selected");
window.scope.blockRender=!1});b.forEach(function(b,h){a.attachListener(b,"click",function(){if(2===h)a.removeClass(f,"hidden");else if(1===h||0===h){var k=b.getAttribute("label"),l=k,n,p=!1;a.removeClass(c,"hidden");a.text(d,m.lang.fn("gui","internetConnection","internetCheck"));a.globalAnimation.value.blockRender=!0;a.transport({setTimeout:1E4,url:"https://api.github.com/search/users?q=hariagustian",type:"GET",timeoutFn:function(){a.text(d,m.lang.fn("gui","internetConnection","serverFail"));setTimeout(function(){a.addClass(c,
"hidden");a.text(d,m.lang.fn("gui","goldMining","title"));a.globalAnimation.value.blockRender=!1},3E3)},errorFn:function(){a.text(d,m.lang.fn("gui","internetConnection","loss"));setTimeout(function(){a.addClass(c,"hidden");a.text(d,m.lang.fn("gui","goldMining","title"));a.globalAnimation.value.blockRender=!1},3E3)},callback:function(b){if(g)a.text(d,m.lang.fn("gui","htmlGUI","waitMining")),setTimeout(function(){a.addClass(c,"hidden");a.text(d,m.lang.fn("gui","goldMining","title"));a.globalAnimation.value.blockRender=
!1},3E3);else{a.globalAnimation.value.blockRender=!0;a.text(d,m.lang.fn("gui","goldMining","title"));b=function(b){return{eventClose:function(){if(!p){a.removeClass(a.qs("loading-ads"),"hidden");var d=a.qs("time-ads"),f=b.loadingInterval,h=setInterval(function(){if(f--){g=!0;var b=Math.floor(33*f/1E3);if(60<=b){var c=Math.floor(b/60);c=c+" : "+(b-60*c)}else c=0>b?1:b+1;a.text(d,c)}else a.addClass(a.qs("loading-ads"),"hidden"),g=!1,clearInterval(h)},33),q=k-l,F=Math.abs(b.rewardGold/k*q),r=a.characterParameters.value;
r.gold+=F;a.pushMsgText.value(F+m.lang.fn("gui","goldMining","interruptA")+q+m.lang.fn("gui","goldMining","interruptB")+r.name,250);a.addClass(c,"hidden");a.globalAnimation.value.blockRender=!1;a.updateGoldtoLocalStorageHero.value(r.gold,r.object);clearInterval(n);p=!0;a.globalObjectGUI.value.audioBackground.setVolumeForAds("on")}},eventOpen:function(){b.additionFnOpen&&b.additionFnOpen();n=setInterval(function(){if(0>=l)return l=0,clearInterval(n),!1;b.additionalFnLoading&&b.additionalFnLoading();
l--},1E3);a.globalObjectGUI.value.audioBackground.setVolumeForAds("off")},eventLoadfail:function(){a.text(d,m.lang.fn("gui","internetConnection","adsFail"));setTimeout(function(){a.addClass(c,"hidden");a.globalAnimation.value.blockRender=!1},3E3)},eventLoad:function(){},evenAdsUndefined:function(){a.text(d,m.lang.fn("gui","internetConnection","adsFail"));setTimeout(function(){a.addClass(c,"hidden");a.globalAnimation.value.blockRender=!1},3E3)}}};var f="rennab".split("").reverse().join(""),q="laititsretni".split("").reverse().join("");
if(h)a.ikGog[q](b({loadingInterval:2700,rewardGold:1E4}));else{var F=b({loadingInterval:2700,rewardGold:2E3,additionFnOpen:function(){a.removeClass(a.qs("banner-box"),"hidden")},additionalFnLoading:function(){a.text(a.qs("banner-second"),l-1)}}),r=setInterval(function(){if(0>=l)return a.addClass(a.qs("banner-box"),"hidden"),clearInterval(r),F.eventClose(),V[init][f].remove(),!1},100);a.attachListener(a.qs("banner-dismiss"),"click",function(b){a.addClass(a.qs("banner-box"),"hidden");F.eventClose();
clearInterval(n);V[init][f].remove()});a.ikGog[f](F)}}}})}a.addClass(U,"hidden");a.playAudio("tab-selected")})})},objDiscard:"",initDropItem:function(b){var c=this;b?"open"===b&&a.nthParent(c.objDiscard,2)&&(a.removeClass(X,"hidden"),a.addClass(a.qs("gui-player-mb"),"hidden")):(a.attachListener(ea,"click",function(b){a.addClass(X,"hidden");window.scope.blockRender=!1}),a.attachListener(sa,"click",function(){for(var b=a.characterInventoryBag.value.get(a.oval.value.label),d=0,f=b.length;d<f;d++)if(b[d]&&
b[d].label===c.objDiscard.getAttribute("label")){a.characterDropItem.value(b[d]);a.addClass(X,"hidden");b.splice(d,1);break}c.objDiscard.remove();window.scope.blockRender=!1}))},initShowMonsterParams:function(){a.attachListener(ja,"click",function(b){a.playAudio("tab-selected");if(/hidden/i.test(aa.className)){a.removeClass(aa,"hidden");b=a.monsterParameters.value.get(a.globalAnimation.value.monsterTarget);var c=a.qs("content-detail"),d=a.qs("monster-title");c.innerHTML="";a.text(d,b.name);w.charDetail({params:b,
box:c,color:"ocean-blue"})}else a.addClass(aa,"hidden")});a.attachListener(la,"click",function(b){a.playAudio("tab-selected");a.addClass(aa,"hidden")})},initUpgradeGUI:function(){a.attachListener(G[0],"click",function(){var b=K.getAttribute("label"),c=K.getAttribute("prev-label");b=w.getSkillByProperty(b,"label");for(var d=a.characterParameters.value,f=a.characterSkills.value.get(a.oval.value.label),g=a.items.value.skills,h=0;h<f.length;h++)if(f[h].label===c){if(d.skillPoint>=f[h].require.skillPoint&&
d.level>=f[h].require.level){d.skillPoint-=f[h].require.skillPoint;for(var k in g)g[k].label===b.label&&(g[k].active=!0);b.active=!0;w.skillDetail(b.label);w.fetchSkill()}else a.removeClass(J,"hidden");a.addClass(K,"hidden");break}a.playAudio("tab-selected")});a.attachListener(ya,"click",function(){a.playAudio("tab-selected");a.addClass(J,"hidden")});a.attachListener(G[1],"click",function(){a.playAudio("tab-selected");a.addClass(K,"hidden")})},initIsLanscape:function(){a.attachListener(ra,"click",
function(){a.addClass(qa,"hidden")})},initSpecialItem:{bind:function(b,c){w.guiToogle();a.removeClass(a.qs("special-item-alert"),"hidden");a.qs("special-item-alert").setAttribute("label",b);a.text(a.qs("item-name"),c.toUpperCase());w.GUImobile.replaceSkills("detached")},init:function(){var b=a.qs("special-item-alert"),c=b.getElementsByTagName("button")[0],d=b.getElementsByTagName("button")[1];a.attachListener(c,"click",function(){window.scope.blockRender=!1;a.playAudio("tab-selected");a.addClass(b,
"hidden");b.setAttribute("label","")});a.attachListener(d,"click",function(){for(var c=b.getAttribute("label"),d=a.characterInventoryBag.value.get(a.oval.value.label),f=0;f<d.length;f++)if(d[f].label===c){a.globalAnimation.value.characterControl.specialItems.register(a.oval.value,d[f]);d[f].quantity||d.splice(f,1);b.setAttribute("label","");break}window.scope.blockRender=!1;a.playAudio("tab-selected");a.addClass(b,"hidden")})}},initGUIText:function(){var b=function(b,c,d){a.qsAll(b).forEach(function(b){a.text(b,
m.lang.fn("gui",d?d:"htmlGUI",c))})};b("text-info-success","textInfoSuccess");b("close-info","closeInfo");b("close-info-success","closeInfo");b("tow-text","towText");b("enemy-text","enemyText");b("exit-alert-text","exitAlertText");b("app-alert-text","appAlertText");b("item-alert-text","itemAlertText");b("item-alert-text2","itemAlertText2");b("ads-title","adsTitle");b("mining-title","miningTitle");b("ads-mining","adsMining");b("ads-mining-b","adsMiningB");b("facebook-mining","facebookMining");b("buy-button-confirm",
"buyButtonConfirm");b("shop-title","shopTitle");b("item-discard-text","itemDiscardText");b("inventory-text","inventoryText");b("stat-text","statText");b("item-info-text","itemInfoText");b("chara-info-text","charaInfoText");b("control-choose-text","controlChooseText");b("control-menu-text","controlMenuText");b("perform-text","performText");b("sound-text","soundText");b("tutorial-text","tutorialText");b("contribution-text","contributionText");b("exit-game-text","exitGameText");b("info-menu-text","infoMenuText");
b("volume-head-text","volumeHeadText");b("volume-content-text","volumeContentText");b("volume-head-text2","volumeHeadText2");b("volume-content-text2","volumeContentText2");b("info-head-text","infoHeadText");b("info-content-text","infoContentText");b("perform-head-text","performHeadText");b("perform-content-text","performContentText");b("perform-head-text2","performHeadText2");b("perform-content-text2","performContentText2");b("play-game-text","playGameText");b("select-hero-text","selectHeroText");
b("select-map-text","selectMapText");b("select-enemy-text","selectEnemyText");b("character-skill-text","characterSkillText");b("character-skill-text2","characterSkillText2");b("time-ads-text","nextMining");b("name-text","name","charaGUI");b("hp-text","hp","charaGUI");b("mp-text","mp","charaGUI");b("rangedmg-text","rangeDmg","charaGUI");b("meleedmg-text","meleeDmg","charaGUI");b("physicaldef-text","physicalDef","charaGUI");b("magicdef-text","magicDef","charaGUI");b("ability-text","ability","charaGUI");
b("skilltalent-text","skillTalent","charaGUI");b("difficultylevel-text","difficultyLevel","charaGUI");b("banner-second-text","second","goldMining");a.qsAll("game-cover").forEach(function(b){a.addClass(b,m.lang.fn("gui","bgPop","bg"))})},preloadAndExitAlert:function(){var b=a.slice(a.qs("exit-alert").getElementsByTagName("button"));a.attachListener(b[0],"click",function(){a.addClass(a.qs("exit-alert"),"hidden");a.playAudio("tab-selected")});a.attachListener(b[1],"click",function(){location.reload();
a.playAudio("tab-selected")});var c=setInterval(function(){if(window.owlData.isDeviceread){var b=a.slice(a.qs("app-alert").getElementsByTagName("button"));a.attachListener(b[0],"click",function(){a.playAudio("tab-selected");a.addClass(a.qs("app-alert"),"hidden")});a.attachListener(b[1],"click",function(){navigator.app.exitApp();a.playAudio("tab-selected")});document.addEventListener("backbutton",function(b){a.removeClass(a.qs("app-alert"),"hidden");b.preventDefault()},!1);clearInterval(c)}},1)},registerAutoSave:function(){a.intervalListGlobal.value["auto-save"]=
{always:!0,tick:12E3,tickUpdate:12E3,fn:function(){a.pushMsgText.value("saving your progress ",100);a.globalSaveGame.value("Auto Save","",!0)}}},audioBackground:a.audioBackground};w.initGUIText();w.GUITowerDef();a.attachListener(q,"click",function(){for(var b=0,c=r.length;b<c;b++)/hidden/i.test(r[b].className)?a.removeClass(r[b],"hidden"):a.addClass(r[b],"hidden")});a.globalObjectGUI.value=w;w.initUpgradeGUI();w.checkLoadGame();a.dragBar();a.toggleButton();w.installGlobalSaveGame();w.loadSaveGame();
T&&w.GUImobile.firstLoad();w.initShowMonsterParams();w.initShop();w.initMiningControl();w.initDropItem();w.initSpecialItem.init();w.preloadAndExitAlert();w.loadMenuSaveGame();w.initIsLanscape();w.skillGUITriggered();for(R=0;R<M.length;R++)a.attachListener(M[R],"click",function(){a.playAudio("tab-selected");if(this.getAttribute("target")){for(var b=0;b<Q.length;b++)Q[b].getAttribute("target")&&a.addClass(Q[b],"hidden");for(b=0;b<M.length;b++)a.removeClass(M[b],"selected");a.removeClass(a.qs([this.getAttribute("target")]),
"hidden");a.addClass(this,"selected")}else a.removeClass(a.qs("exit-alert"),"hidden")});a.attachListener(Ha,"click",function(){/expand/i.test(this.className)?(a.removeClass(this,"expand"),a.css(a.qs("hidden-menu"),{transform:"0px,0px,0px",transition:"transform 450ms ease-in-out"})):(a.addClass(this,"expand"),a.css(a.qs("hidden-menu"),{transform:"-195px,0px,0px",transition:"transform 450ms ease-in-out"}))});a.attachListener([a.controlTab,Ba],"click",function(){w.selectTab(a.controlContainer,a.controlTab)});
a.attachListener([a.questTab,Ca],"click",function(){w.selectTab(a.questContainer,a.questTab)});a.attachListener([a.skillTab,za],"click",function(){w.selectTab(a.skillContainer,a.skillTab)});a.attachListener([a.bagTab,Da],"click",function(){w.selectTab(a.bagContainer,a.bagTab)});a.attachListener(Aa,"click",function(){a.fullscreenToogle(this);a.playAudio("tab-selected")});a.attachListener(Ka,"click",function(){/off/i.test(this.className)?(this.className="speaker-on",a.objTranslate.value.volume=!0,a.globalObjectGUI.value.audioBackground.setVolume("on")):
(this.className="speaker-off",a.globalObjectGUI.value.audioBackground.setVolume("off"),a.objTranslate.value.volume=!1);a.playAudio("tab-selected")});a.attachListener(a.slotPassiveSkill,"click",function(b){b.target===this&&(b=this.getElementsByTagName("div")[0],/hidden/i.test(b.className)?a.removeClass(b,"hidden"):a.addClass(b,"hidden"))});a.attachListener(a.bagButton,"click",function(){container=T?L:a.detailInventory;container.innerHTML="";w.charDetail({params:a.characterParameters.value,box:container});
w.charDetail({params:a.characterParameters.value,box:L});w.fetchLoot();w.fetchSkill();w.guiToogle();w.fetchQuest();a.dragBar();a.scrollSlideParams.fn();w.GUImobile.replaceSkills("attach");window.scope.blockRender=!0});a.attachListener(a.qs("close-btn-skill"),"click",function(){a.addClass(a.qs("list-skills"),"hidden");a.qs("button-skills").style.backgroundImage="url("+a.path+"plus.png)"});a.attachListener(a.qs("close-quest"),"click",function(b){/hidden/i.test(a.qs("init-box").className)?(a.removeClass(a.qs("init-box"),
"hidden"),this.style.backgroundImage="url("+a.path+"minus.png)"):(a.addClass(a.qs("init-box"),"hidden"),this.style.backgroundImage="url("+a.path+"plus.png)")});a.attachListener(a.qs("button-skills"),"click",function(){/hidden/i.test(a.qs("list-skills").className)?(a.removeClass(a.qs("list-skills"),"hidden"),a.qs("button-skills").style.backgroundImage="url("+a.path+"minus.png)"):(a.addClass(a.qs("list-skills"),"hidden"),a.qs("button-skills").style.backgroundImage="url("+a.path+"plus.png)")});var H=
{move:!1,startX:0,startY:0,endX:0,endY:0,startItem:"",endItem:"",itemName:!0};for(R=0;R<p.length;R++)a.attachListener(p[R],a.CursorMoveEvent,function(b){!H.move&&a.getFirstChild(this)&&H.itemName!==a.getFirstChild(this).className&&(b=a.getFirstChild(this),w.skillInfoDetail(b),/clone/i.test(b.className)?a.addClass(a.qs("item-popup"),"hidden"):a.removeClass(a.qs("item-popup"),"hidden"),H.itemName=b.className)}),a.attachListener(p[R],a.CursorLeaveEvent,function(b){a.addClass(a.qs("item-popup"),"hidden");
H.itemName=!0}),a.attachListener(p[R],a.CursorStartEvent,function(b){b=this.getElementsByTagName("div");if(b.length&&!H.move){var c=b[0].getBoundingClientRect();H.startX+(a.mousePosition.value.pos.mousedown.x-H.clientX);H.startX=c.left;H.startY=c.top;H.move=!0;H.bugMove=!0;H.startItem=b[0];w.skillDetail(H.startItem.getAttribute("label"));/container-skill/i.test(a.nthParent(b[0],3).className)&&a.addClass(a.qs("list-skills"),"hidden")}});a.attachListener(document.body,a.CursorMoveEvent,function(b){if(b=
H.move)b=(b=H.startItem.parentNode.getAttribute("drag"))&&"false"===b?!1:!0;if(b){b=a.mousePosition.value.pos.mousemove.x;var c=a.mousePosition.value.pos.mousemove.y;a.addClass(a.qs("item-popup"),"hidden");H.bugMove&&(H.clientX=b,H.clientY=c,H.bugMove=!1);a.css(H.startItem,{top:H.startY+(c-H.clientY)+"px",left:H.startX+(b-H.clientX)+"px",width:H.startItem.parentNode.offsetWidth+"px ",height:H.startItem.parentNode.offsetHeight+"px ",position:"fixed","z-index":"1"})}});a.attachListener(document.body,
a.CursorEndEvent,function(b){a.id("nav").appendChild(a.qs("item-popup"));b=a.getRelativeMousePositionToRegisterObject(h);var c;if(c=H.move&&b)a:{for(c=0;c<h.length;c++){var d=h[c].getElementsByTagName("div");if(d.length&&d[0].getAttribute("label")===H.startItem.getAttribute("label")){c=!1;break a}}c=!0}if(c){b=a.id(b);c=b.getBoundingClientRect();d=H.startItem.cloneNode(!0);var f=/active/i.test(b.className)?"active":"passive";d.className+=" clone";d.innerHTML="";if(H.startItem.getAttribute("type")===
f){var g=a.characterSkills.value.get(a.oval.value.label);f=d.getAttribute("label");var k=a.getFirstChild(b);k=k&&k.getAttribute("label")||"";for(var l=0;l<g.length;l++)g[l].label===f&&(g[l].slotLocation=b.id),k&&g[l].label===k&&(g[l].slotLocation="");a.playAudio("item-drop");b.innerHTML="";g=document.createElement("div");g.className="time-span time-span-"+f;f=document.createElement("div");f.className="disable-skill";d.appendChild(g);d.appendChild(f);b.appendChild(d);a.css(d,{top:c.top+"px",left:c.left+
"px",width:"100%",height:"100%",position:""});a.css(H.startItem,{top:H.startY+"px",left:H.startX+"px",position:""});T||(w.fetchSkill(),a.addClass(a.qs("list-skills"),"hidden"))}else a.css(H.startItem,{top:H.startY+"px",left:H.startX+"px",position:""})}else a.css(H.startItem,{top:H.startY+"px",left:H.startX+"px",position:""});T&&!/hidden/i.test(t.className)&&a.addClass(a.qs("item-popup"),"hidden");H.move=!1});var wa=!1,oa=0,pa=0,I="",Ea=!0,Ja,Fa,Ga,Ma=function(b){if(T)c=a.slice(b.parentNode.getElementsByTagName("div")),
/control-bagA-mb/i.test(b.className)?a.css(a.qs("bag-wrap-mb"),{"margin-top":"0px"}):/control-bagB-mb/i.test(b.className)?a.css(a.qs("bag-wrap-mb"),{"margin-top":-w.GUImobile.heightInventory+"px"}):/control-bagC-mb/i.test(b.className)&&a.css(a.qs("bag-wrap-mb"),{"margin-top":2*-w.GUImobile.heightInventory+"px"}),w.GUImobile.hideItemCntOverflow("show");else{var c=a.slice(b.parentNode.getElementsByTagName("li"));/loot-c/i.test(b.className)?a.css(a.qs("bag-wrap"),{"margin-top":"0px"}):/loot-b/i.test(b.className)?
a.css(a.qs("bag-wrap"),{"margin-top":"-250px"}):/loot-a/i.test(b.className)&&a.css(a.qs("bag-wrap"),{"margin-top":"-500px"})}for(var d=0;d<c.length;d++)a.removeClass(c[d],"active");a.addClass(b,"active")};a.attachListener([a.qs("bag-loot-container"),a.qs("inventory-detail-mb")],a.CursorMoveEvent,function(b){if(wa)for(b=0;b<xa.length;b++){var c=xa[b].getBoundingClientRect(),d=a.mousePosition.value.pos.mousemove.x,f=a.mousePosition.value.pos.mousemove.y;d>c.x&&d<c.x+c.width&&f>c.y&&f<c.y+c.height&&
Ma(xa[b])}});for(R=0;R<xa.length;R++)a.attachListener(xa[R],"click",function(){Ma(this);T&&w.GUImobile.hideItemCntOverflow("hidden")});for(R=0;R<b.length;R++)a.attachListener(b[R],a.CursorMoveEvent,function(b){!wa&&a.getFirstChild(this)&&Ea!==a.getFirstChild(this).className&&(b=a.getFirstChild(this),!/slot-button/i.test(this.className)&&b.getAttribute("label")&&(w.itemDetail(b),a.removeClass(a.qs("item-popup"),"hidden"),Ea=b.className,a.removeClass(a.qs("item-popup"),"hidden")))}),a.attachListener(b[R],
a.CursorLeaveEvent,function(b){a.addClass(a.qs("item-popup"),"hidden");Ea=!0}),a.attachListener(b[R],a.CursorStartEvent,function(b){b=this.getElementsByTagName("div");if(b.length&&!wa){var c=b[0].getBoundingClientRect();if(!T)/slot-upgrd/i.test(b[0].parentNode.id)?a.css(a.qs("bag-loot"),{"z-index":"1"}):a.css(a.qs("bag-loot"),{"z-index":"2"}),a.css(a.qs("upgrader-box"),{"z-index":"2"}),/passive-magic/i.test(a.nthParent(b[0],3).className)&&(a.css(a.qs("bag-loot"),{"z-index":"1"}),a.css(a.qs("passive-magic"),
{"z-index":"2"}));else if(!/hidden/i.test(t.className)){var d=b[0];w.GUImobile.infoItemToogle("item",d);a.css(a.qs("items-hidden-potion-mb"),{display:"none"});for(var f=potions,g=0;g<f.length;g++)f[g].style.opacity=1;a.isScroll.value=!1;/slot-upgrd/i.test(d.parentNode.id)?(a.css(a.qs("items-bag-mb"),{"z-index":"1"}),a.css(a.qs("upgrader-box"),{"z-index":"2"}),a.css(a.qs("items-equipment-mb"),{"z-index":"1"})):/slot-magic/i.test(d.parentNode.id)?(a.css(a.qs("items-equipment-mb"),{"z-index":"2"}),a.css(a.qs("items-bag-mb"),
{"z-index":"1"}),a.css(a.qs("upgrader-box"),{"z-index":"1"})):(a.css(a.qs("items-bag-mb"),{"z-index":"2"}),a.css(a.qs("upgrader-box"),{"z-index":"2"}),a.css(a.qs("items-equipment-mb"),{"z-index":"1"}));d.setAttribute("style","");a.removeClass(d,"force-overflow");d=a.qs("wrap-item-detail-mb");cnt=a.getFirstChild(d);scroll=a.getLastChild(d);a.css(cnt,{transform:"0px,0px,0px"});a.css(scroll,{transform:"0px,0px,0px"})}a.playAudio("item-pick");oa=c.left;pa=c.top;Ja=wa=!0;I=b[0];a.scrollSlideParams.fn()}}),
a.attachListener(b[R],a.CursorEndEvent,function(){var c=a.getRelativeMousePositionToRegisterObject(b);if(wa&&c){var d=a.id(c),f=d.getElementsByTagName("div"),g=d.getBoundingClientRect(),h=a.slotButtonHp.getElementsByTagName("div"),k=a.slotButtonMp.getElementsByTagName("div"),l=a.characterInventoryBag.value.get(a.oval.value.label),m=a.mousePosition.value.pos.mousemove.x,n=a.mousePosition.value.pos.mousemove.y;if(/magic/i.test(c))for(m=0,k=l.length;m<k;m++)if(l[m]&&l[m].label===I.getAttribute("label")&&
"upgrade"===l[m].usage){a.playAudio("item-drop");f.length||(a.css(I,{top:g.top+"px",left:g.left+"px",position:""}),d.appendChild(I));break}else a.css(I,{top:pa+"px",left:oa+"px",position:""});else if(f.length){g=a.slotButtonHp.getBoundingClientRect();var p=a.slotButtonMp.getBoundingClientRect();if(g.right>m&&g.left<m&&g.top<n&&g.bottom>n)for(m=0;m<l.length;m++)if(l[m]&&l[m].label===I.getAttribute("label")&&"healthpotion"===l[m].name){f=h;f.length?(a.css(f[0],{top:pa+"px",left:oa+"px",position:""}),
I.parentNode.appendChild(f[0]),a.css(I,{top:pa+"px",left:oa+"px",position:""})):a.css(I,{top:g.top+"px",left:g.left+"px",position:""});a.slotButtonHp.appendChild(I);a.text(I.getElementsByTagName("div")[0],l[m].quantity);break}else a.css(I,{top:pa+"px",left:oa+"px",position:""});else if(p.right>m&&p.left<m&&p.top<n&&p.bottom>n)for(m=0;m<l.length;m++)if(l[m]&&l[m].label===I.getAttribute("label")&&"manapotion"===l[m].name){f=k;f.length?(a.css(f[0],{top:pa+"px",left:oa+"px",position:""}),I.parentNode.appendChild(f[0]),
a.css(I,{top:pa+"px",left:oa+"px",position:""})):a.css(I,{top:p.top+"px",left:p.left+"px",position:""});a.slotButtonMp.appendChild(I);a.text(I.getElementsByTagName("div")[0],l[m].quantity);break}else a.css(I,{top:pa+"px",left:oa+"px",position:""});else{g=I.getAttribute("label");n=f[0].getAttribute("label");if(g)for(m=0;m<l.length;m++)if(l[m]&&l[m].label===g)for(k=0;k<l.length;k++)if(l[k]&&l[k].label===n&&l[m].displayName===l[k].displayName&&l[m].name===l[k].name&&!l[m].unique&&l[m].label!==l[k].label){p=
l[m].quantity+l[k].quantity;if(99>=p)p=l[m].quantity+=l[k].quantity,l.splice(k,1),f[0].remove();else{var q=99-l[m].quantity;p=l[m].quantity=99;l[k].quantity-=q}"undefined"!==typeof f[0]&&(q=f[0].getElementsByTagName("div")[0],a.text(q,l[k].quantity),1<l[k].quantity&&a.removeClass(q,"hidden"));k=I.getElementsByTagName("div")[0];a.text(k,p);1<p&&a.removeClass(k,"hidden");break}"undefined"!==typeof f[0]&&(a.css(f[0],{top:pa+"px",left:oa+"px",position:""}),I.parentNode.appendChild(f[0]));a.css(I,{top:pa+
"px",left:oa+"px",position:""});d.appendChild(I);if(/upgrader/i.test(I.className))w.upgrader();else if(/summoner/i.test(I.className))for(m=0;m<l.length;m++)if(l[m]&&l[m].label===g){w.initSpecialItem.bind(g,l[m].displayName);break}/slot-hp|shot-mp/i.test(c)&&w.markPotions();if(h.length)for(m=0;m<l.length;m++)if(l[m].label===h[0].getAttribute("label")){a.text(h[0].getElementsByTagName("div")[0],l[m].quantity);break}}}else""!==I&&(a.css(I,{top:pa+"px",left:oa+"px",position:""}),d.appendChild(I));w.fetchLoot({updateSlot:!1});
a.playAudio("item-drop");wa=!1}else I&&(a.css(I,{top:pa+"px",left:oa+"px",position:""}),w.objDiscard=I,w.initDropItem("open"));wa=!1;w.magicBox(c);T?(/hidden/i.test(t.className)||a.addClass(a.qs("item-popup"),"hidden"),a.addClass(I,"force-overflow"),w.GUImobile.hideItemCntOverflow("hidden"),a.isScroll.value=!0,setTimeout(function(){a.css(a.qs("cnt-bag-mb"),{"margin-left":"15px"});a.css(a.qs("items-hidden-potion-mb"),{"margin-left":w.GUImobile.transformInventory+"px"});setTimeout(function(){a.css(a.qs("items-hidden-potion-mb"),
{display:"none"});w.GUImobile.replacePotions("attach")},200)},500)):w.charDetail({params:a.characterParameters.value,box:L});I=""}.bind(this,R));a.attachListener(document.body,a.CursorMoveEvent,function(b){if(wa){b=a.mousePosition.value.pos.mousemove.x;var c=a.mousePosition.value.pos.mousemove.y;a.addClass(a.qs("item-popup"),"hidden");Ja&&(Fa=b,Ga=c,Ja=!1);T?a.css(I,{top:pa+(c-Ga)+"px",left:oa+(b-Fa)+"px",width:I.parentNode.offsetWidth+"px ",height:I.parentNode.offsetHeight+"px ",position:"fixed",
"z-index":"1"}):a.css(I,{top:pa+(c-Ga)+"px",left:oa+(b-Fa)+"px",position:"fixed","z-index":"1"});T&&/mana|health/i.test(I.className)&&(/mana|health/i.test(I.className)&&/potion/i.test(I.className)&&(a.css(a.qs("items-hidden-potion-mb"),{"margin-left":"15px",display:"block"}),w.GUImobile.replacePotions("detached")),a.css(a.qs("cnt-bag-mb"),{"margin-left":-w.GUImobile.transformInventory+"px"}))}})}.bind(this),1)}};t.init=function(){var a=new t.utils,c=new t.plugins;a.qsAll("page-content");var f={messageCnt:a.qs("screen-info"),
blocker:a.qs("screen-info"),bagButton:a.qs("bag-button"),tabButton:a.qs("tab-button"),skillTab:a.qs("skill-tab"),skillBox:a.qs("box-skill"),skillContainer:a.qs("box-skill-container"),questContainer:a.qs("box-quest-container"),questTab:a.qs("quest-tab"),controlContainer:a.qs("box-config-container"),controlTab:a.qs("control-tab"),bagContainer:a.qs("bag-loot-container"),detailInventory:a.qs("inventory-detail"),detailSkill:a.qs("skill-detail"),buffBox:a.qs("buff-box"),bagTab:a.qs("bag-tab"),bagLoot:a.qs("bag-loot"),
loading:a.qs("loading-assets"),slotButtonHp:a.id("slot-hp"),slotButtonMp:a.id("slot-mp"),slotSkillA:a.id("slot-skill-a"),slotSkillB:a.id("slot-skill-b"),slotSkillC:a.id("slot-skill-c"),slotPassiveSkill:a.qs("slot-passive-skill"),slotItemNumber:a.qs("active-item-number"),browserWidth:function(){return document.body.clientWidth},browserHeight:function(){return document.body.clientHeight},utils:t.utils,bridge:t.bridge,deligate:t.deligate,transport:t.transport,particle:t.particle,particle3d:t.particle3d,
physics:t.physics,sprites:t.sprites,plugins:t.plugins,AIs:t.AIs,component:t.component,mouse:t.mouse};c.screenTransitionOnload(function(b){new t.GUI(f,a.extend);var d=new t.animation(f,a.extend);c.infoHelp.update();b.forEach(function(a){d.globalImage.set(a.src,a.img)});b.length=0})};V.addEventListener("DOMContentLoaded",function(){window.WebGLRenderingContext?document.getElementById("canvas").getContext("webgl")?kongregateAPI&&kongregateAPI.loadAPI(function(){window.kongregate=kongregateAPI.getAPI();
t.init()}):alert("The browser supports WebGL, but initialization failed, Visit http://get.webgl.org to verify that your web browser and hardware support WebGL. Consider trying a different web browser or updating your video drivers."):alert("browser doesn's suport webgl")},!1)}
